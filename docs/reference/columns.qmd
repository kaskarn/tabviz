---
title: "Columns"
---

```{r}
#| include: false
library(webforest)
```

Column functions for defining table columns in forest plots.

## Basic Columns

### col_text {#col_text}

Text column for displaying character data.

```r
col_text(field, header = NULL, width = NULL, position = "left")
```

| Argument | Description |
|----------|-------------|
| `field` | Column name in data |
| `header` | Display header (defaults to field name) |
| `width` | Column width in pixels |
| `position` | `"left"` or `"right"` of forest plot |

### col_numeric {#col_numeric}

Numeric column with automatic formatting.

```r
col_numeric(field, header = NULL, width = NULL, position = "left")
```

| Argument | Description |
|----------|-------------|
| `field` | Column name in data |
| `header` | Display header |
| `width` | Column width in pixels |
| `position` | `"left"` or `"right"` |

### col_interval {#col_interval}

Confidence interval display showing point estimate with bounds.

```r
col_interval(header = "95% CI", width = 140, position = "right")
```

| Argument | Description |
|----------|-------------|
| `header` | Column header (default: "95% CI") |
| `width` | Column width in pixels (default: 140) |
| `position` | Position relative to plot (default: "right") |

**Note**: This column automatically uses the `point`, `lower`, and `upper` values specified in `forest_plot()`.

## Visualization Columns

### col_bar {#col_bar}

Horizontal bar chart for showing magnitude.

```r
col_bar(
  field,
  header = NULL,
  width = NULL,
  max_value = NULL,
  show_label = TRUE,
  color = NULL
)
```

| Argument | Description |
|----------|-------------|
| `field` | Column name containing numeric values |
| `header` | Column header |
| `width` | Column width in pixels |
| `max_value` | Maximum value for scaling (auto if NULL) |
| `show_label` | Show value label (default: TRUE) |
| `color` | Bar color |

### col_pvalue {#col_pvalue}

P-value column with optional significance stars.

```r
col_pvalue(field, header = "P-value", width = 80, stars = TRUE)
```

| Argument | Description |
|----------|-------------|
| `field` | Column name containing p-values |
| `header` | Column header (default: "P-value") |
| `width` | Column width (default: 80) |
| `stars` | Show significance stars (default: TRUE) |

**Significance levels**:

- `*` p < 0.05
- `**` p < 0.01
- `***` p < 0.001

### col_sparkline {#col_sparkline}

Inline sparkline chart for trend visualization.

```r
col_sparkline(field, header = NULL, width = 80, type = "line")
```

| Argument | Description |
|----------|-------------|
| `field` | Column name containing numeric vector |
| `header` | Column header |
| `width` | Column width (default: 80) |
| `type` | `"line"`, `"bar"`, or `"area"` |

**Note**: The field should contain list-columns with numeric vectors.

### col_n {#col_n}

Sample size column (alias for `col_numeric` with sensible defaults).

```r
col_n(field = "n", header = "N", width = 60)
```

### col_weight {#col_weight}

Weight column with bar visualization for meta-analysis.

```r
col_weight(field = "weight", header = "Weight", width = 100)
```

## Column Groups

### col_group {#col_group}

Group multiple columns under a shared header.

```r
col_group(header, ...)
```

| Argument | Description |
|----------|-------------|
| `header` | Group header text |
| `...` | Column specifications to group |

## Examples

### Mixed Column Types

```{r}
data <- data.frame(
  study = c("Trial A", "Trial B", "Trial C"),
  hr = c(0.72, 0.85, 0.68),
  lower = c(0.55, 0.70, 0.52),
  upper = c(0.95, 1.03, 0.89),
  n = c(245, 180, 320),
  weight = c(35, 28, 37),
  pval = c(0.018, 0.092, 0.003)
)

forest_plot(data,
  point = "hr", lower = "lower", upper = "upper",
  label = "study",
  columns = list(
    col_n("n"),
    col_weight("weight"),
    col_interval("HR (95% CI)"),
    col_pvalue("pval")
  ),
  null_value = 1, scale = "log"
)
```

### Column Groups

```{r}
#| eval: false
columns = list(
  col_n("n"),
  col_group("Treatment Effect",
    col_numeric("hr", "HR"),
    col_interval("95% CI")
  ),
  col_pvalue("pval")
)
```

## See Also

- [forest_plot()](forest_plot.qmd) for using columns
- [Columns Guide](../guide/columns.qmd) for detailed examples
