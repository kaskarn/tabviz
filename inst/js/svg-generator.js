(function(){"use strict";const mt=[1,5,2,2.5,4,3],q=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function ot(t,n){return n?Ft(t):Ht(t)}function Ft(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=q[0];for(const o of q)if(o<=t[0])n=o;else break;t[0]<q[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let e=q[q.length-1];for(let o=q.length-1;o>=0&&q[o]>=t[1];o--)e=q[o];return t[1]>q[q.length-1]&&(e=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,e]}function Ht(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const e=Math.pow(10,Math.floor(Math.log10(n)));let o=e,r=1/0;for(const d of mt)for(const l of[.1,1,10]){const i=d*e*l;if(i<=0)continue;const s=Math.floor(t[0]/i)*i,h=(Math.ceil(t[1]/i)*i-s)/n-1;h>=0&&h<r&&(r=h,o=i)}const a=Math.floor(t[0]/o)*o,c=Math.ceil(t[1]/o)*o;return[Math.round(a*1e10)/1e10,Math.round(c*1e10)/1e10]}function Z(t,n,e,o,r=!1){if(t&&e in t){const a=t[e];if(typeof a=="number"&&Number.isFinite(a)&&(!r||a>0))return a}return e===o&&n!=null&&Number.isFinite(n)&&(!r||n>0)?n:null}const Gt=20;function kt(t){const{rows:n,config:e,scale:o,nullValue:r,forestWidth:a,pointSize:c,effects:d=[]}=t,l=vt(n,e,o,r,d),i=Pt(l,e,o,a,c),s=$t(l,e,o,r);return{axisLimits:l,plotRegion:i,ticks:s}}function vt(t,n,e,o,r=[]){const a=n.rangeMin!=null,c=n.rangeMax!=null;if(a&&c)return[n.rangeMin,n.rangeMax];const d=[],l=e==="log";for(const x of t){const I=Z(x.metadata,x.point,"point","point",l);I!=null&&d.push(I);for(const F of r){const b=Z(x.metadata,x.point,F.pointCol,"point",l);b!=null&&d.push(b)}}if(d.length===0)return e==="log"?[.1,10]:[-1,1];let i=Math.min(...d),s=Math.max(...d);(n.includeNull??!0)&&(i=Math.min(i,o),s=Math.max(s,o));const f=i,h=s;let m;if(l){const x=Math.max(i,.001),I=Math.max(s,.001);m=Math.log(I)-Math.log(x)}else m=s-i;if(m===0||!Number.isFinite(m)){const x=d[0];if(l)return ot([x/2,x*2],!0);{const I=Math.max(1,Math.abs(x)*.1);return ot([x-I,x+I],!1)}}const[A,N]=ot([i,s],l),y=n.ciClipFactor??3;let W=A,w=N;const S=[],L=[];for(const x of t){const I=Z(x.metadata,x.lower,"lower","lower",l);I!=null&&S.push(I);const F=Z(x.metadata,x.upper,"upper","upper",l);F!=null&&L.push(F);for(const b of r){const E=Z(x.metadata,x.lower,b.lowerCol,"lower",l);E!=null&&S.push(E);const H=Z(x.metadata,x.upper,b.upperCol,"upper",l);H!=null&&L.push(H)}}let g,M;if(l)g=W/y,M=w*y;else{const x=w-W;g=W-x*y,M=w+x*y}let p=!1,T=!1;for(const x of S)x>=g?W=Math.min(W,x):p=!0;for(const x of L)x<=M?w=Math.max(w,x):T=!0;if(p&&(W=Math.min(W,g)),T&&(w=Math.max(w,M)),n.symmetric===!0&&!a&&!c)if(e==="log"){const x=Math.log(o),I=Math.max(Math.abs(Math.log(Math.max(f,.001))-x),Math.abs(Math.log(h)-x));W=Math.exp(x-I),w=Math.exp(x+I)}else{const x=Math.max(Math.abs(f-o),Math.abs(h-o));W=o-x,w=o+x}let _=a?n.rangeMin:W,D=c?n.rangeMax:w;return ot([_,D],e==="log")}function Pt(t,n,e,o,r){if(!(n.markerMargin??!0)||o<=0)return t;const c=o-2*Gt;if(c<=0)return t;if(e==="log"){const i=Math.log(Math.max(t[0],.001)),s=Math.log(Math.max(t[1],.001)),u=s-i,f=r/2*(u/c),h=Math.min(f,.5);return[Math.exp(i-h),Math.exp(s+h)]}const d=t[1]-t[0],l=r/2*(d/c);return[t[0]-l,t[1]+l]}function $t(t,n,e,o){const[r,a]=t,c=o>=r&&o<=a,d=(n.nullTick??!0)&&c;if(n.tickValues&&n.tickValues.length>0){let s=n.tickValues.filter(u=>u>=r&&u<=a);return d&&!s.includes(o)&&(s=[...s,o].sort((u,f)=>u-f)),s}const l=n.tickCount??5;let i=e==="log"?Rt(t,l):Ct(t,l);return d&&!i.includes(o)&&(i=[...i,o].sort((s,u)=>s-u)),i}function Ct(t,n){const[e,o]=t,r=o-e;if(r===0)return[e];const a=r/Math.max(n-1,1),c=Math.pow(10,Math.floor(Math.log10(a)));let d=c,l=1/0;for(const u of mt){const f=u*c,h=Math.floor(r/f)+1,m=Math.abs(h-n);m<l&&(l=m,d=f);const A=u*c/10;if(A>0){const N=Math.floor(r/A)+1,y=Math.abs(N-n);y<l&&(l=y,d=A)}}const i=Math.ceil(e/d)*d,s=[];for(let u=i;u<=o+d*.001;u+=d){const f=Math.round(u*1e10)/1e10;f>=e&&f<=o&&s.push(f)}return s.length<2&&(s.includes(e)||s.unshift(e),s.includes(o)||s.push(o)),s}function Rt(t,n){const[e,o]=t,a=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(l=>l>=e&&l<=o);if(a.length<=n)return a;const c=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],d=[];for(const l of c)a.includes(l)&&d.length<n&&d.push(l);if(d.length<n){const l=a.filter(s=>!d.includes(s)),i=Math.max(1,Math.floor(l.length/(n-d.length)));for(let s=0;s<l.length&&d.length<n;s+=i)d.push(l[s])}return d.sort((l,i)=>l-i)}function Bt(t){var o,r;const n=((o=t==null?void 0:t.shapes)==null?void 0:o.lineWidth)??1.5,e=((r=t==null?void 0:t.colors)==null?void 0:r.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:e,opacity:1}}function yt(t,n,e,o){const{width:r,height:a}=o,c=a/2;return t==="left"?`M ${n} ${e} L ${n+r} ${e-c} L ${n+r} ${e+c} Z`:`M ${n} ${e} L ${n-r} ${e-c} L ${n-r} ${e+c} Z`}const ft={RENDERING_BUFFER:4},K={FONT_SCALE:.8,PADDING:4,GAP:6},U={DEFAULT_LABEL_WIDTH:200,DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:20,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800,COLUMN_GAP:16},V={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},k={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5,AXIS_LABEL_PADDING:30},xt={GROUP_HEADER_HEIGHT_MULTIPLIER:1.3,OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},tt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74}},rt={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},Mt={SPACING:6};function Ut(t,n){return n<=1?0:-((n-1)*Mt.SPACING)/2+t*Mt.SPACING}function it(t,n){const e=t.split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),e.join(".")}function ut(t){const n=Math.abs(t),e=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const o=n/1e9;return e+dt(o)+"B"}if(n>=1e6){const o=n/1e6;return e+dt(o)+"M"}if(n>=1e3){const o=n/1e3;return e+dt(o)+"K"}return e+Math.round(n).toString()}function dt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const Xt={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function Ot(t){return t.split("").map(n=>Xt[n]??n).join("")}function at(t,n){var d,l,i,s,u;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:f,digits:h,multiply:m=!0,symbol:A=!0}=n.percent,N=m?t*100:t,y=h!=null?N.toPrecision(h):N.toFixed(f??1);return A?`${y}%`:y}if(((d=n==null?void 0:n.numeric)==null?void 0:d.abbreviate)&&Math.abs(t)>=1e3)return ut(t);const o=(l=n==null?void 0:n.numeric)==null?void 0:l.digits;if(o!=null){const f=t.toPrecision(o),h=(i=n==null?void 0:n.numeric)==null?void 0:i.thousandsSep;return h&&typeof h=="string"?it(f,h):f}const r=(s=n==null?void 0:n.numeric)==null?void 0:s.decimals,a=(u=n==null?void 0:n.numeric)==null?void 0:u.thousandsSep;let c;return r!==void 0?c=t.toFixed(r):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?c=Math.round(t).toString():c=t.toFixed(2),a&&typeof a=="string"&&(c=it(c,a)),c}function Tt(t,n){const{eventsField:e,nField:o,separator:r="/",showPct:a=!1,thousandsSep:c,abbreviate:d}=n.events,l=t.metadata[e],i=t.metadata[o];if(l==null||i===void 0||i===null)return n.naText??"";const s=Number(l),u=Number(i);let f,h;d&&(s>=1e3||u>=1e3)?(f=s>=1e3?ut(s):String(s),h=u>=1e3?ut(u):String(u)):(f=String(s),h=String(u),c&&typeof c=="string"&&(f=it(f,c),h=it(h,c)));let m=`${f}${r}${h}`;if(a&&u>0){const A=(s/u*100).toFixed(1);m+=` (${A}%)`}return m}function bt(t,n,e,o){var d,l,i;if(t==null||Number.isNaN(t))return"";const r=((d=o==null?void 0:o.interval)==null?void 0:d.decimals)??2,a=((l=o==null?void 0:o.interval)==null?void 0:l.sep)??" ",c=(i=o==null?void 0:o.interval)==null?void 0:i.impreciseThreshold;return n==null||e===void 0||e===null||Number.isNaN(n)||Number.isNaN(e)?t.toFixed(r):c!=null&&n>0&&e/n>c?"—":`${t.toFixed(r)}${a}(${n.toFixed(r)}, ${e.toFixed(r)})`}function Et(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const e=n==null?void 0:n.pvalue,o=(e==null?void 0:e.digits)??2,r=(e==null?void 0:e.expThreshold)??.001,a=(e==null?void 0:e.abbrevThreshold)??null,c=(e==null?void 0:e.format)??"auto",d=(e==null?void 0:e.stars)??!1,l=(e==null?void 0:e.thresholds)??[.05,.01,.001];let i="";if(d&&(t<l[2]?i="***":t<l[1]?i="**":t<l[0]&&(i="*")),a!==null&&t<a)return`<${a}${i}`;if(c==="scientific"||c==="auto"&&t<r){const u=Math.floor(Math.log10(t));return`${(t/Math.pow(10,u)).toPrecision(o)}×10${Ot(u.toString())}${i}`}let s;return t>=.1?s=t.toFixed(o):t>=.01?s=t.toFixed(o+1):s=t.toFixed(o+2),`${s}${i}`}function zt(t,n){var a,c,d,l;const{type:e,field:o,options:r}=n;switch(e){case"interval":{const i=(a=r==null?void 0:r.interval)!=null&&a.point?t.metadata[r.interval.point]:t.point,s=(c=r==null?void 0:r.interval)!=null&&c.lower?t.metadata[r.interval.lower]:t.lower,u=(d=r==null?void 0:r.interval)!=null&&d.upper?t.metadata[r.interval.upper]:t.upper;return bt(i,s,u,r)}case"custom":return r!=null&&r.events?Tt(t,r):String(t.metadata[o]??"");case"pvalue":return Et(t.metadata[o],r);case"numeric":return at(t.metadata[o],r);case"percent":return at(t.metadata[o],r);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const i=t.metadata[o];return i==null?"":`  ${String(i)}  `}case"bar":{if(((l=r==null?void 0:r.bar)==null?void 0:l.showLabel)===!1)return"";const i=t.metadata[o];return i==null?"":i>=100?i.toFixed(0):i>=10?i.toFixed(1):i.toFixed(2)}case"text":default:return String(t.metadata[o]??"")}}function j(t,n){const e="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻";let o=0;for(const r of t)e.includes(r)?o+=n*.3:"il1.,;:|!()[]{}' ".includes(r)?o+=n*.35:"×−".includes(r)?o+=n*.5:"mwMW@%".includes(r)?o+=n*.85:r>="0"&&r<="9"?o+=n*.6:o+=n*.55;return o}function Vt(t,n){var i,s;const e=new Map,o=Y(t.theme.typography.fontSizeBase),r=t.theme.typography.headerFontScale??1.05,a=o*r,c=t.data.rows,d=(t.theme.spacing.cellPaddingX??10)*2,l=(t.theme.spacing.groupPadding??8)*2;for(const u of n){if(u.width!=="auto"&&u.width!==null&&u.width!==void 0)continue;let f=0;u.header&&(f=Math.max(f,j(u.header,a)));for(const A of c){if(((i=A.style)==null?void 0:i.type)==="header"||((s=A.style)==null?void 0:s.type)==="spacer")continue;const N=zt(A,u);N&&(f=Math.max(f,j(N,o)))}const h=tt.VISUAL_MIN[u.type]??tt.MIN,m=Math.ceil(f+d+ft.RENDERING_BUFFER);e.set(u.id,Math.min(tt.MAX,Math.max(h,m)))}return jt(t.columns,e,a,l,ft.RENDERING_BUFFER),e}function jt(t,n,e,o,r){function a(l){return l.isGroup?l.columns.flatMap(a):[l]}function c(l){const i=n.get(l.id);return i!==void 0?i:typeof l.width=="number"?l.width:tt.MIN}function d(l){if(l.isGroup){for(const i of l.columns)d(i);if(l.header){const i=j(l.header,e)+o+r,s=a(l),u=s.reduce((f,h)=>f+c(h),0);if(i>u&&s.length>0){const f=Math.ceil((i-u)/s.length);for(const h of s)n.set(h.id,c(h)+f)}}}}for(const l of t)d(l)}function It(t){var l,i;const n=Y(t.theme.typography.fontSizeBase),e=(t.theme.spacing.cellPaddingX??10)*2;let o=0;const r=new Map,a=Array.isArray(t.data.groups)?t.data.groups:[];for(const s of a)r.set(s.id,s.depth);const c=s=>s?(r.get(s)??0)+1:0;t.data.labelHeader&&(o=Math.max(o,j(t.data.labelHeader,n)));for(const s of t.data.rows)if(s.label){const u=c(s.groupId),f=((l=s.style)==null?void 0:l.indent)??0,m=(u+f)*k.INDENT_PER_LEVEL;let A=j(s.label,n)+m;if((i=s.style)!=null&&i.badge){const N=String(s.style.badge),y=n*K.FONT_SCALE,w=j(N,y)+K.PADDING*2;A+=K.GAP+w}o=Math.max(o,A)}for(const s of a)if(s.label){const u=s.depth*k.INDENT_PER_LEVEL,f=j(s.label,n),m=`(${countAllDescendantRows(s.id)})`,A=n*.75,N=j(m,A),y=u+rt.CHEVRON_WIDTH+rt.GAP+f+rt.GAP+N+rt.SAFETY_MARGIN;o=Math.max(o,y)}const d=Math.ceil(o+e+ft.RENDERING_BUFFER);return Math.min(tt.LABEL_MAX,Math.max(tt.MIN,d))}function ht(t,n){const e=n.get(t.id);return e!==void 0?e:typeof t.width=="number"?t.width:U.DEFAULT_COLUMN_WIDTH}function Yt(t,n){var X,G,v,P,z;const e=t.theme,o=e.spacing.rowHeight,r=e.spacing.padding,a=Array.isArray(t.columns)?t.columns:[],c=lt(a,"left"),d=lt(a,"right"),i=pt(c)||pt(d)?e.spacing.headerHeight*xt.GROUP_HEADER_HEIGHT_MULTIPLIER:e.spacing.headerHeight,s=!!((X=t.labels)!=null&&X.title),u=!!((G=t.labels)!=null&&G.subtitle),f=!!((v=t.labels)!=null&&v.caption),h=!!((P=t.labels)!=null&&P.footnote),m=s?V.TITLE_HEIGHT:0,A=u?V.SUBTITLE_HEIGHT:0,N=m+A+(s||u?r:0),y=f?V.CAPTION_HEIGHT:0,W=h?V.FOOTNOTE_HEIGHT:0,w=y+W+(f||h?r:0),S=At(t),L=!!t.data.overall;let g=0;for(const C of S){const B=C.type==="data"&&((z=C.row.style)==null?void 0:z.type)==="spacer";g+=B?o/2:o}L&&(g+=o*xt.OVERALL_ROW_HEIGHT_MULTIPLIER);const M=st(a,"left"),p=st(a,"right"),T=[...M,...p];let $,_;if(n.columnWidths){$=new Map;for(const[C,B]of Object.entries(n.columnWidths))C!=="__label__"&&$.set(C,B);_=n.columnWidths.__label__??It(t)}else $=Vt(t,T),_=It(t);const D=_+M.reduce((C,B)=>C+ht(B,$),0),x=p.reduce((C,B)=>C+ht(B,$),0),I=n.width??U.DEFAULT_WIDTH,F=t.data.includeForest,b=D+x;let E;if(!F)E=0;else if(typeof n.forestWidth=="number")E=n.forestWidth;else if(typeof t.layout.plotWidth=="number")E=t.layout.plotWidth;else{const C=I-b-U.COLUMN_GAP*2-r*2;E=Math.max(C,U.MIN_FOREST_WIDTH)}const H=r*2+b+E+U.COLUMN_GAP*2,R=Math.max(n.width??I,H),J=N+r+i+g+U.AXIS_HEIGHT+U.AXIS_LABEL_HEIGHT+w+U.BOTTOM_MARGIN;return{totalWidth:R,totalHeight:n.height??J,tableWidth:D+x,forestWidth:E,headerHeight:i,rowHeight:o,plotHeight:g,axisHeight:U.AXIS_HEIGHT,nullValue:t.data.nullValue,summaryYPosition:g-o,showOverallSummary:L,headerTextHeight:N,footerTextHeight:w,titleY:r+V.TITLE_HEIGHT-8,subtitleY:r+m+V.SUBTITLE_HEIGHT-4,mainY:N+r,footerY:N+r+i+g+U.AXIS_HEIGHT+U.AXIS_LABEL_HEIGHT+r,autoWidths:$,labelWidth:_}}function At(t){var u;const n=t.data.rows,e=Array.isArray(t.data.groups)?t.data.groups:[];if(e.length===0)return n.map(f=>({type:"data",row:f,depth:0}));const o=new Map;for(const f of e)o.set(f.id,f);const r=new Map;for(const f of n){const h=f.groupId??null;r.has(h)||r.set(h,[]),r.get(h).push(f)}const a=new Set;for(const f of r.keys()){if(!f)continue;let h=f;for(;h;)a.add(h),h=(u=o.get(h))==null?void 0:u.parentId}function c(f){return e.filter(h=>(h.parentId??null)===f&&a.has(h.id))}function d(f){if(!f)return 0;const h=o.get(f);return h?h.depth+1:0}function l(f){var m;let h=((m=r.get(f))==null?void 0:m.length)??0;for(const A of c(f))h+=l(A.id);return h}const i=[];function s(f){if(f){const m=o.get(f);if(!m)return;const A=l(f);i.push({type:"group_header",groupId:m.id,label:m.label,depth:m.depth,rowCount:A})}for(const m of c(f))s(m.id);const h=r.get(f)??[];for(const m of h)i.push({type:"data",row:m,depth:d(m.groupId)})}return s(null),i}function Nt(t){const n=[];for(const e of t)e.isGroup?n.push(...Nt(e.columns)):n.push(e);return n}function st(t,n){const e=[];for(const o of t)o.position===n&&(o.isGroup?e.push(...Nt(o.columns)):e.push(o));return e}function lt(t,n){return t.filter(e=>e.position===n)}function pt(t){return t.some(n=>n.isGroup)}function Y(t){return t.endsWith("rem")?parseFloat(t)*V.REM_BASE:t.endsWith("px")?parseFloat(t):V.DEFAULT_FONT_SIZE}function ct(t,n,e){return e==="right"?{textX:t+n-k.TEXT_PADDING,anchor:"end"}:e==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+k.TEXT_PADDING,anchor:"start"}}function O(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function gt(t,n,e,o=0){const r=n-o*2;if(j(t,e)<=r)return t;const c="…",d=e*.55;let l=0,i=t.length;for(;l<i;){const s=Math.ceil((l+i)/2),u=t.slice(0,s);j(u,e)+d<=r?l=s:i=s-1}return l===0?c:t.slice(0,l)+c}function Jt(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function St(t,n){const[e,o]=t,[r,a]=n,c=(a-r)/(o-e),d=l=>r+(l-e)*c;return d.domain=()=>t,d.range=()=>n,d.ticks=l=>{const i=(o-e)/(l-1),s=[];for(let u=0;u<l;u++)s.push(e+i*u);return s},d}function _t(t,n){const[e,o]=t.map(s=>Math.max(s,.001)),[r,a]=n,c=Math.log10(e),d=Math.log10(o),l=(a-r)/(d-c),i=s=>{const u=Math.log10(Math.max(s,.001));return r+(u-c)*l};return i.domain=()=>[e,o],i.range=()=>n,i.ticks=s=>{const u=[],f=Math.floor(Math.log10(e)),h=Math.ceil(Math.log10(o));for(let m=f;m<=h;m++){const A=Math.pow(10,m);for(const N of[1,2,5]){const y=A*N;y>=e&&y<=o&&u.push(y)}}return u.length>0?u:[e,o]},i}function qt(t,n,e){const o=t.data.scale==="log",r=k.AXIS_LABEL_PADDING,a=r,c=Math.max(n-r,a+50);if(e!=null&&e.xDomain){const u=e.xDomain,f=e.clipBounds??u,h=$t(f,t.theme.axis,t.data.scale,t.data.nullValue);return o?{scale:_t([Math.max(u[0],.01),Math.max(u[1],.02)],[a,c]),clipBounds:f,ticks:h}:{scale:St(u,[a,c]),clipBounds:f,ticks:h}}const d=kt({rows:t.data.rows,config:t.theme.axis,scale:t.data.scale,nullValue:t.data.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:t.data.effects}),{plotRegion:l,axisLimits:i,ticks:s}=d;return o?{scale:_t([Math.max(l[0],.01),Math.max(l[1],.02)],[a,c]),clipBounds:i,ticks:s}:{scale:St(l,[a,c]),clipBounds:i,ticks:s}}function Zt(t,n,e){var a,c;const o=[],r=e.spacing.padding;if((a=t.labels)!=null&&a.title){const d=Y(e.typography.fontSizeLg);o.push(`<text x="${r}" y="${n.titleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${e.typography.fontWeightBold}"
      fill="${e.colors.foreground}">${O(t.labels.title)}</text>`)}if((c=t.labels)!=null&&c.subtitle){const d=Y(e.typography.fontSizeBase);o.push(`<text x="${r}" y="${n.subtitleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${d}px"
      fill="${e.colors.secondary}">${O(t.labels.subtitle)}</text>`)}return o.join(`
`)}function Kt(t,n,e){var c,d;const o=[],r=e.spacing.padding;let a=n.footerY;if((c=t.labels)!=null&&c.caption){const l=Y(e.typography.fontSizeSm);o.push(`<text x="${r}" y="${a}"
      font-family="${e.typography.fontFamily}"
      font-size="${l}px"
      fill="${e.colors.secondary}">${O(t.labels.caption)}</text>`),a+=V.CAPTION_HEIGHT}if((d=t.labels)!=null&&d.footnote){const l=Y(e.typography.fontSizeSm);o.push(`<text x="${r}" y="${a}"
      font-family="${e.typography.fontFamily}"
      font-size="${l}px"
      font-style="italic"
      fill="${e.colors.muted}">${O(t.labels.footnote)}</text>`)}return o.join(`
`)}function wt(t,n,e,o,r,a,c,d,l){const i=[],s=Y(a.typography.fontSizeBase),u=a.typography.headerFontScale??1.05,f=s*u,h=a.typography.fontWeightMedium,m=a.typography.fontWeightBold,A=pt(t),N=d??U.DEFAULT_LABEL_WIDTH,y=S=>{if(l){const L=l.get(S.id);if(L!==void 0)return L}return typeof S.width=="number"?S.width:U.DEFAULT_COLUMN_WIDTH},W=S=>S.isGroup?S.columns.reduce((L,g)=>L+W(g),0):y(S),w=(S,L)=>S+L/2+f*V.TEXT_BASELINE_ADJUSTMENT;if(A){const S=r/2,L=r/2;let g=e;c&&(i.push(`<text x="${g+k.TEXT_PADDING}" y="${w(o,r)}"
        font-family="${a.typography.fontFamily}"
        font-size="${f}px"
        font-weight="${h}"
        fill="${a.colors.foreground}">${O(c)}</text>`),g+=N);const M=[];for(const p of t)if(p.isGroup){const T=W(p),$=g+T/2;i.push(`<text x="${$}" y="${w(o,S)}"
          font-family="${a.typography.fontFamily}"
          font-size="${f}px"
          font-weight="${m}"
          text-anchor="middle"
          fill="${a.colors.foreground}">${O(p.header)}</text>`),M.push({x1:g,x2:g+T}),g+=T}else{const T=y(p),$=p.headerAlign??p.align,{textX:_,anchor:D}=ct(g,T,$),x=gt(p.header,T,f,k.TEXT_PADDING);i.push(`<text x="${_}" y="${w(o,r)}"
          font-family="${a.typography.fontFamily}"
          font-size="${f}px"
          font-weight="${h}"
          text-anchor="${D}"
          fill="${a.colors.foreground}">${O(x)}</text>`),g+=T}for(const p of M)i.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${o+S}" y2="${o+S}"
        stroke="${a.colors.border}" stroke-width="1" opacity="0.5"/>`);g=e+(c?N:0);for(const p of t)if(p.isGroup){for(const T of p.columns)if(!T.isGroup){const $=y(T),_=T.headerAlign??T.align,{textX:D,anchor:x}=ct(g,$,_);i.push(`<text x="${D}" y="${w(o+S,L)}"
              font-family="${a.typography.fontFamily}"
              font-size="${f}px"
              font-weight="${h}"
              text-anchor="${x}"
              fill="${a.colors.foreground}">${O(T.header)}</text>`),g+=$}}else{const T=y(p);g+=T}}else{let S=e;c&&(i.push(`<text x="${S+k.TEXT_PADDING}" y="${w(o,r)}"
        font-family="${a.typography.fontFamily}"
        font-size="${f}px"
        font-weight="${h}"
        fill="${a.colors.foreground}">${O(c)}</text>`),S+=N);for(const L of n){const g=y(L),M=L.headerAlign??L.align,{textX:p,anchor:T}=ct(S,g,M),$=gt(L.header,g,f,k.TEXT_PADDING);i.push(`<text x="${p}" y="${w(o,r)}"
        font-family="${a.typography.fontFamily}"
        font-size="${f}px"
        font-weight="${h}"
        text-anchor="${T}"
        fill="${a.colors.foreground}">${O($)}</text>`),S+=g}}return i.join(`
`)}function Qt(t,n,e,o,r,a,c){const d=[],l=n+1,i=c.groupHeaders;let s,u,f,h,m;if(l===1?(s=Y((i==null?void 0:i.level1FontSize)??c.typography.fontSizeBase),u=(i==null?void 0:i.level1FontWeight)??c.typography.fontWeightBold,f=(i==null?void 0:i.level1Italic)??!1,h=(i==null?void 0:i.level1Background)??null,m=(i==null?void 0:i.level1BorderBottom)??!1):l===2?(s=Y((i==null?void 0:i.level2FontSize)??c.typography.fontSizeBase),u=(i==null?void 0:i.level2FontWeight)??c.typography.fontWeightMedium,f=(i==null?void 0:i.level2Italic)??!0,h=(i==null?void 0:i.level2Background)??null,m=(i==null?void 0:i.level2BorderBottom)??!1):(s=Y((i==null?void 0:i.level3FontSize)??c.typography.fontSizeBase),u=(i==null?void 0:i.level3FontWeight)??c.typography.fontWeightNormal,f=(i==null?void 0:i.level3Italic)??!1,h=(i==null?void 0:i.level3Background)??null,m=(i==null?void 0:i.level3BorderBottom)??!1),!h){const W=c.colors.primary,w=l===1?.15:l===2?.1:.06,S=W.replace("#",""),L=parseInt(S.substring(0,2),16),g=parseInt(S.substring(2,4),16),M=parseInt(S.substring(4,6),16);h=`rgba(${L}, ${g}, ${M}, ${w})`}const A=o+r/2+s*V.TEXT_BASELINE_ADJUSTMENT,N=n*((i==null?void 0:i.indentPerLevel)??k.INDENT_PER_LEVEL);d.push(`<rect x="${e}" y="${o}"
    width="${a}" height="${r}"
    fill="${h}"/>`),m&&d.push(`<line x1="${e}" x2="${e+a}" y1="${o+r}" y2="${o+r}"
      stroke="${c.colors.border}" stroke-width="1" opacity="0.5"/>`);const y=f?' font-style="italic"':"";return d.push(`<text x="${e+k.TEXT_PADDING+N}" y="${A}"
    font-family="${c.typography.fontFamily}"
    font-size="${s}px"
    font-weight="${u}"${y}
    fill="${c.colors.foreground}">${O(t)}</text>`),d.join(`
`)}function Dt(t,n){const e=new Map;for(const o of n)if(o.type==="bar"){let r=0;for(const a of t){const c=a.metadata[o.field];typeof c=="number"&&c>r&&(r=c)}e.set(o.field,r>0?r:1)}return e}function Wt(t,n,e,o,r,a,c,d=U.DEFAULT_LABEL_WIDTH,l=0,i,s){var N,y,W,w,S,L,g,M,p,T,$,_,D,x,I,F;const u=[],f=Y(a.typography.fontSizeBase),h=o+r/2+f*V.TEXT_BASELINE_ADJUSTMENT;let m=e;const A=b=>{if(s){const E=s.get(b.id);if(E!==void 0)return E}return typeof b.width=="number"?b.width:U.DEFAULT_COLUMN_WIDTH};if(c){const b=l*k.INDENT_PER_LEVEL+(((N=t.style)==null?void 0:N.indent)??0)*k.INDENT_PER_LEVEL,E=(y=t.style)!=null&&y.bold||(W=t.style)!=null&&W.emphasis?a.typography.fontWeightBold:a.typography.fontWeightNormal,H=(w=t.style)!=null&&w.italic?"italic":"normal";let R=a.colors.foreground;(S=t.style)!=null&&S.color?R=t.style.color:(L=t.style)!=null&&L.muted?R=a.colors.muted:(g=t.style)!=null&&g.accent&&(R=a.colors.accent);const J=d-b-k.TEXT_PADDING*2,X=gt(t.label,J,f,0);if(u.push(`<text x="${m+k.TEXT_PADDING+b}" y="${h}"
      font-family="${a.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${E}"
      font-style="${H}"
      fill="${R}">${O(X)}</text>`),(M=t.style)!=null&&M.badge){const G=String(t.style.badge),v=f*K.FONT_SCALE,P=v+K.PADDING*2,z=j(t.label,f),C=m+k.TEXT_PADDING+b+z+K.GAP,nt=j(G,v)+K.PADDING*2,et=o+(r-P)/2;u.push(`<rect x="${C}" y="${et}" width="${nt}" height="${P}"
        rx="3" fill="${a.colors.primary}" opacity="0.15"/>`),u.push(`<text x="${C+nt/2}" y="${et+P/2+v*.35}"
        text-anchor="middle"
        font-family="${a.typography.fontFamily}"
        font-size="${v}px"
        font-weight="500"
        fill="${a.colors.primary}">${O(G)}</text>`)}m+=d}for(const b of n){const E=A(b),H=tn(t,b),{textX:R,anchor:J}=ct(m,E,b.align);if(b.type==="bar"&&typeof t.metadata[b.field]=="number"){const X=t.metadata[b.field],G=i==null?void 0:i.get(b.field),v=((T=(p=b.options)==null?void 0:p.bar)==null?void 0:T.maxValue)??G??100,P=((_=($=b.options)==null?void 0:$.bar)==null?void 0:_.color)??a.colors.primary,z=a.shapes.pointSize*2,B=E-k.TEXT_PADDING*2-50,nt=Math.min(X/v*B,B);u.push(`<rect x="${m+k.TEXT_PADDING}" y="${o+r/2-z/2}"
        width="${Math.max(0,nt)}" height="${z}"
        fill="${P}" opacity="0.7" rx="2"/>`);const et=m+E-k.TEXT_PADDING;u.push(`<text x="${et}" y="${h}"
        font-family="${a.typography.fontFamily}"
        font-size="${f}px"
        text-anchor="end"
        fill="${a.colors.foreground}">${at(X)}</text>`)}else if(b.type==="sparkline"&&Array.isArray(t.metadata[b.field])){let X=t.metadata[b.field];Array.isArray(X[0])&&(X=X[0]);const G=((x=(D=b.options)==null?void 0:D.sparkline)==null?void 0:x.height)??16,v=((F=(I=b.options)==null?void 0:I.sparkline)==null?void 0:F.color)??a.colors.primary,P=k.TEXT_PADDING*2,z=nn(X,m+k.TEXT_PADDING,o+r/2-G/2,E-P,G);u.push(`<path d="${z}" fill="none" stroke="${v}" stroke-width="1.5"/>`)}else u.push(`<text x="${R}" y="${h}"
        font-family="${a.typography.fontFamily}"
        font-size="${f}px"
        text-anchor="${J}"
        fill="${a.colors.foreground}">${O(H)}</text>`);m+=E}return u.join(`
`)}function tn(t,n){var o,r,a,c,d,l,i,s,u,f,h,m,A,N,y,W,w,S,L;if(n.type==="interval"){const g=(r=(o=n.options)==null?void 0:o.interval)!=null&&r.point?t.metadata[n.options.interval.point]:t.point,M=(c=(a=n.options)==null?void 0:a.interval)!=null&&c.lower?t.metadata[n.options.interval.lower]:t.lower,p=(l=(d=n.options)==null?void 0:d.interval)!=null&&l.upper?t.metadata[n.options.interval.upper]:t.upper;return bt(g,M,p,n.options)}if(n.type==="numeric"){const g=t.metadata[n.field];return typeof g=="number"?at(g,n.options):((i=n.options)==null?void 0:i.naText)??""}if(n.type==="custom"&&((s=n.options)!=null&&s.events))return Tt(t,n.options);if(n.type==="pvalue"){const g=t.metadata[n.field];return typeof g!="number"?((u=n.options)==null?void 0:u.naText)??"":Et(g,n.options)}if(n.type==="icon"){const g=t.metadata[n.field];if(g==null)return"";const M=String(g),p=(h=(f=n.options)==null?void 0:f.icon)==null?void 0:h.mapping;return p&&M in p?p[M]:M}if(n.type==="badge"){const g=t.metadata[n.field];return g!=null?String(g):""}if(n.type==="stars"){const g=t.metadata[n.field];if(typeof g!="number")return"";const M=((A=(m=n.options)==null?void 0:m.stars)==null?void 0:A.maxStars)??5,p=Math.max(0,Math.min(M,g)),T=Math.floor(p),$=M-T;return"★".repeat(T)+"☆".repeat($)}if(n.type==="img")return((y=(N=n.options)==null?void 0:N.img)==null?void 0:y.fallback)??"[IMG]";if(n.type==="reference"){const g=t.metadata[n.field];if(g==null)return"";const M=String(g),p=((w=(W=n.options)==null?void 0:W.reference)==null?void 0:w.maxChars)??30;return M.length<=p?M:M.substring(0,p)+"..."}if(n.type==="range"){const g=(S=n.options)==null?void 0:S.range;if(!g)return"";const M=t.metadata[g.minField],p=t.metadata[g.maxField],T=g.separator??" – ",$=g.decimals,_=D=>typeof D!="number"?"":$==null?Number.isInteger(D)?String(D):D.toFixed(1):D.toFixed($);return M===null&&p===null?"":M===null?_(p):p===null?_(M):`${_(M)}${T}${_(p)}`}const e=t.metadata[n.field];return e!=null?String(e):((L=n.options)==null?void 0:L.naText)??""}function nn(t,n,e,o,r){const a=t.filter(s=>Number.isFinite(s));if(a.length===0)return"";if(a.length===1){const s=n+o/2,u=e+r/2;return`M${s.toFixed(1)},${u.toFixed(1)}`}const c=Math.min(...a),l=Math.max(...a)-c||1;return`M${a.map((s,u)=>{const f=n+u/(a.length-1)*o,h=e+r-(s-c)/l*r;return`${f.toFixed(1)},${h.toFixed(1)}`}).join("L")}`}function en(t,n,e,o,r,a=[],c,d=0,l=1/0,i,s=!1){var M;let u;if(a.length===0){const p=!s||t.point!=null&&t.point>0?t.point:null,T=!s||t.lower!=null&&t.lower>0?t.lower:null,$=!s||t.upper!=null&&t.upper>0?t.upper:null;u=[{point:p,lower:T,upper:$,color:null,shape:null,opacity:null}]}else u=a.map(p=>({point:Z(t.metadata,t.point,p.pointCol,"point",s),lower:Z(t.metadata,t.lower,p.lowerCol,"lower",s),upper:Z(t.metadata,t.upper,p.upperCol,"upper",s),color:p.color??null,shape:p.shape??null,opacity:p.opacity??null}));const f=u.filter(p=>p.point!=null&&!Number.isNaN(p.point)&&p.lower!=null&&!Number.isNaN(p.lower)&&p.upper!=null&&!Number.isNaN(p.upper));if(f.length===0)return"";const h=o.shapes.pointSize,m=o.shapes.lineWidth,A=o.colors.intervalLine,N=((M=t.style)==null?void 0:M.type)==="summary",W=o.shapes.summaryHeight/2;function w(p){var $;if(p&&(($=t.markerStyle)==null?void 0:$.size)!=null)return h*t.markerStyle.size;const T=c?t.metadata[c]:void 0;if(T){const _=.5+Math.sqrt(T/100)*1.5;return Math.min(Math.max(h*_,3),h*2.5)}return h}function S(p,T){const $=T===0,_=t.markerStyle,D=o.shapes.markerColors,x=o.shapes.markerShapes,I=["square","circle","diamond","triangle"];let F;$&&(_!=null&&_.color)?F=_.color:p.color?F=p.color:D&&D.length>0?F=D[T%D.length]:F=o.colors.interval??o.colors.primary??"#2563eb";let b;$&&(_!=null&&_.shape)?b=_.shape:p.shape?b=p.shape:x&&x.length>0?b=x[T%x.length]:b=I[T%I.length];let E;return $&&(_==null?void 0:_.opacity)!=null?E=_.opacity:p.opacity!=null?E=p.opacity:E=1,{color:F,shape:b,opacity:E}}function L(p,T,$,_){const{color:D,shape:x,opacity:I}=_,F=I<1?` fill-opacity="${I}"`:"";switch(x){case"circle":return`<circle cx="${p}" cy="${T}" r="${$}" fill="${D}"${F}/>`;case"diamond":return`<polygon points="${[`${p},${T-$}`,`${p+$},${T}`,`${p},${T+$}`,`${p-$},${T}`].join(" ")}" fill="${D}"${F}/>`;case"triangle":return`<polygon points="${[`${p},${T-$}`,`${p+$},${T+$}`,`${p-$},${T+$}`].join(" ")}" fill="${D}"${F}/>`;default:return`<rect x="${p-$}" y="${T-$}" width="${$*2}" height="${$*2}" fill="${D}"${F}/>`}}const g=[];return f.forEach((p,T)=>{const $=n+Ut(T,f.length),_=e(p.lower),D=e(p.upper),x=e(p.point),I=S(p,T),F=w(T===0),b=A;if(N){const E=I.opacity<1?` fill-opacity="${I.opacity}"`:"",H=[`${_},${$}`,`${x},${$-W}`,`${D},${$}`,`${x},${$+W}`].join(" ");g.push(`
        <g class="interval effect-${T} summary">
          <polygon points="${H}"
            fill="${I.color}"${E} stroke="${o.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const E=k.AXIS_LABEL_PADDING,H=d+E,R=d+l-E,J=i?p.lower<i[0]:_<H,X=i?p.upper>i[1]:D>R;let G,v;if(i){const et=Math.max(i[0],Math.min(i[1],p.lower)),fn=Math.max(i[0],Math.min(i[1],p.upper));G=e(et),v=e(fn)}else G=Math.max(H,Math.min(R,_)),v=Math.max(H,Math.min(R,D));const P=Bt(o),z=P.height/2;let C="";J?C=`<path d="${yt("left",H,$,P)}" fill="${P.color}"/>`:C=`<line x1="${G}" x2="${G}" y1="${$-z}" y2="${$+z}" stroke="${b}" stroke-width="${m}"/>`;let B="";X?B=`<path d="${yt("right",R,$,P)}" fill="${P.color}"/>`:B=`<line x1="${v}" x2="${v}" y1="${$-z}" y2="${$+z}" stroke="${b}" stroke-width="${m}"/>`;const nt=i?e(Math.max(i[0],Math.min(i[1],p.point))):Math.max(H,Math.min(R,x));g.push(`
        <g class="interval effect-${T}">
          <line x1="${G}" x2="${v}" y1="${$}" y2="${$}"
            stroke="${b}" stroke-width="${m}"/>
          ${C}
          ${B}
          ${L(nt,$,F,I)}
        </g>`)}}),g.join("")}function on(t,n,e,o,r,a,c,d){const i=d.shapes.summaryHeight/2,[s,u]=r.domain().map(L=>r(L)),f=Math.min(s,u),h=Math.max(s,u),m=r(n),A=r(t),N=r(e),y=a+Math.max(f,Math.min(h,m)),W=a+Math.max(f,Math.min(h,A)),w=a+Math.max(f,Math.min(h,N));return`<polygon points="${[`${y},${o}`,`${W},${o-i}`,`${w},${o}`,`${W},${o+i}`].join(" ")}"
    fill="${d.colors.summaryFill}"
    stroke="${d.colors.summaryBorder}"
    stroke-width="1"/>`}function rn(t,n,e,o,r,a=1,c){const d=[],l=typeof e.axis.tickCount=="number"?e.axis.tickCount:k.DEFAULT_TICK_COUNT,i=an(t,l,e,a,n.forestWidth,c),s=Y(e.typography.fontSizeSm),u=35,f=m=>m<u?"start":m>n.forestWidth-u?"end":"middle",h=m=>m<u?2:m>n.forestWidth-u?-2:0;d.push(`<line x1="${r}" x2="${r+n.forestWidth}"
    y1="0" y2="0" stroke="${e.colors.border}" stroke-width="1"/>`);for(const m of i){const A=t(m),N=r+A,y=f(A),W=h(A);d.push(`<line x1="${N}" x2="${N}" y1="0" y2="4"
      stroke="${e.colors.border}" stroke-width="1"/>`),d.push(`<text x="${N+W}" y="16" text-anchor="${y}"
      font-family="${e.typography.fontFamily}"
      font-size="${s}px"
      fill="${e.colors.secondary}">${Jt(m)}</text>`)}return o&&d.push(`<text x="${r+n.forestWidth/2}" y="28"
      text-anchor="middle"
      font-family="${e.typography.fontFamily}"
      font-size="${s}px"
      font-weight="500"
      fill="${e.colors.secondary}">${O(o)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${d.join(`
`)}</g>`}function an(t,n,e,o,r,a){if(Array.isArray(e.axis.tickValues)&&e.axis.tickValues.length>0){const[M,p]=t.domain();let T=e.axis.tickValues.filter(D=>D>=M&&D<=p);const $=e.axis.nullTick!==!1,_=o>=M&&o<=p;return $&&_&&!T.includes(o)&&(T=[...T,o].sort((D,x)=>D-x)),T}const[c,d]=t.domain(),l=e.axis.nullTick!==!1,i=o>=c&&o<=d,s=50,u=Math.max(2,Math.floor(r/s)),f=Math.min(n,Math.min(7,u)),h=a&&a.length>0?a.filter(M=>M>=c&&M<=d):t.ticks(f);if(h.length===0)return l&&i?[o]:[];const m=t(o),A=h.filter(M=>M<o).reverse(),N=h.filter(M=>M>o),y=h.some(M=>M===o),W=[];let w=m;for(const M of A){const p=t(M);w-p>=s&&(W.unshift(M),w=p)}const S=[];let L=m;for(const M of N){const p=t(M);p-L>=s&&(S.push(M),L=p)}const g=[...W];if((y||l&&i)&&g.push(o),g.push(...S),g.length<2){const M=new Set(g);M.has(c)||g.unshift(c),g.length<2&&!M.has(d)&&g.push(d)}return g}function Lt(t,n,e,o,r,a,c=1,d=.6){let i=`<line x1="${t}" x2="${t}" y1="${n}" y2="${e}"
    stroke="${r}" stroke-width="${c}" stroke-opacity="${d}" stroke-dasharray="${o==="dashed"?"6,4":o==="dotted"?"2,2":"none"}"/>`;return a&&(i+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-size="10px" fill="${r}">${O(a)}</text>`),i}class Q extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function sn(t){if(!t||typeof t!="object")throw new Q("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new Q("Invalid spec: missing or invalid 'data' property");const e=n.data;if(!Array.isArray(e.rows))throw new Q("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new Q("Invalid spec: missing or invalid 'theme' property");const o=n.theme;if(!o.colors||typeof o.colors!="object")throw new Q("Invalid spec: missing or invalid 'theme.colors'");if(!o.typography||typeof o.typography!="object")throw new Q("Invalid spec: missing or invalid 'theme.typography'");if(!o.spacing||typeof o.spacing!="object")throw new Q("Invalid spec: missing or invalid 'theme.spacing'")}function ln(t,n={}){var x;sn(t);const e=t.theme,o=t.data.scale==="log",r=Yt(t,n),a=e.spacing.padding,c=Array.isArray(t.columns)?t.columns:[],d=lt(c,"left"),l=lt(c,"right"),i=st(c,"left"),s=st(c,"right"),u=r.labelWidth+i.reduce((I,F)=>I+ht(F,r.autoWidths),0),f=a+u+U.COLUMN_GAP,{scale:h,clipBounds:m,ticks:A}=qt(t,r.forestWidth,n),N=f+r.forestWidth+U.COLUMN_GAP,y=[];y.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${r.totalWidth}" height="${r.totalHeight}"
  viewBox="0 0 ${r.totalWidth} ${r.totalHeight}">`);const W=n.backgroundColor??e.colors.background;y.push(`<rect width="100%" height="100%" fill="${W}"/>`),y.push(Zt(t,r,e)),y.push(`<line x1="${a}" x2="${r.totalWidth-a}"
    y1="${r.mainY}" y2="${r.mainY}"
    stroke="${e.colors.border}" stroke-width="2"/>`);const w=r.mainY;y.push(wt(d,i,a,w,r.headerHeight,e,t.data.labelHeader??"Study",r.labelWidth,r.autoWidths)),s.length>0&&y.push(wt(l,s,N,w,r.headerHeight,e,void 0,void 0,r.autoWidths)),y.push(`<line x1="${a}" x2="${r.totalWidth-a}"
    y1="${w+r.headerHeight}" y2="${w+r.headerHeight}"
    stroke="${e.colors.border}" stroke-width="2"/>`);const S=At(t);(Array.isArray(t.data.groups)?t.data.groups:[]).length>0;const g=[],M=[];let p=0;for(const I of S){const b=I.type==="data"&&((x=I.row.style)==null?void 0:x.type)==="spacer"?r.rowHeight/2:r.rowHeight;g.push(p),M.push(b),p+=b}if(t.data.includeForest&&r.forestWidth>0){const I=r.mainY+r.headerHeight,F=f+h(t.data.nullValue);y.push(Lt(F,I,I+r.plotHeight,"dashed",e.colors.muted));const b=Array.isArray(t.annotations)?t.annotations:[];for(const E of b)if(E.type==="reference_line"){const H=f+h(E.x);y.push(Lt(H,I,I+r.plotHeight,E.style,E.color??e.colors.accent,E.label,E.width??1,E.opacity??.6))}if(S.forEach((E,H)=>{if(E.type==="data"){const R=I+g[H]+M[H]/2;y.push(en(E.row,R,J=>f+h(J),e,t.data.nullValue,t.data.effects,t.data.weightCol,f,r.forestWidth,m,o))}}),t.data.overall&&r.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const E=I+r.summaryYPosition;y.push(on(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,E,h,f,r.forestWidth,e))}y.push(rn(h,r,e,t.data.axisLabel,f,t.data.nullValue,A))}const T=r.mainY+r.headerHeight,$=t.data.rows,_=Dt($,i),D=Dt($,s);return S.forEach((I,F)=>{var H,R,J,X;const b=T+g[F],E=M[F];if(I.type==="group_header")y.push(Qt(I.label,I.depth,a,b,E,r.totalWidth-a*2,e));else{const G=I.row,v=I.depth,P=((H=G.style)==null?void 0:H.type)==="spacer",z=(R=G.style)==null?void 0:R.bg;if(!P&&!z&&e.layout.banding){const B=F%2===1?e.colors.altBg:e.colors.rowBg;B!==e.colors.background&&y.push(`<rect x="${a}" y="${b}"
            width="${r.totalWidth-a*2}" height="${E}"
            fill="${B}"/>`)}y.push(Wt(G,i,a,b,E,e,!0,r.labelWidth,v,_,r.autoWidths)),s.length>0&&y.push(Wt(G,s,N,b,E,e,!1,0,v,D,r.autoWidths))}if(I.type==="data"){const G=I.row,v=((J=G.style)==null?void 0:J.type)==="summary",P=((X=G.style)==null?void 0:X.type)==="spacer";v&&y.push(`<line x1="${a}" x2="${r.totalWidth-a}"
          y1="${b}" y2="${b}"
          stroke="${e.colors.border}" stroke-width="2"/>`),P||y.push(`<line x1="${a}" x2="${r.totalWidth-a}"
          y1="${b+E}" y2="${b+E}"
          stroke="${e.colors.border}" stroke-width="1"/>`)}else y.push(`<line x1="${a}" x2="${r.totalWidth-a}"
        y1="${b+E}" y2="${b+E}"
        stroke="${e.colors.border}" stroke-width="1"/>`)}),y.push(Kt(t,r,e)),y.push("</svg>"),y.join(`
`)}function cn(t,n){const e=JSON.parse(t);return ln(e,n)}globalThis.generateSVG=cn})();
