(function(){"use strict";function ft(t,e){if(e){const s=[.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100];let u=s[0];for(const a of s)if(a<=t[0])u=a;else break;let l=s[s.length-1];for(let a=s.length-1;a>=0&&s[a]>=t[1];a--)l=s[a];return[u,l]}const n=t[1]-t[0];if(n===0)return t;const o=Math.pow(10,Math.floor(Math.log10(n))),i=n/o;let r;i<=1?r=o*.1:i<=2?r=o*.2:i<=5?r=o*.5:r=o;const c=Math.floor(t[0]/r)*r,f=Math.ceil(t[1]/r)*r;return[c,f]}const tt=.15,ht=.06,dt=.05,ot=.04;function pt(t){return t<=0?0:ot+t*ot}const w={DEFAULT_LABEL_WIDTH:200,DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:20,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800,COLUMN_GAP:16},F={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},L={INDENT_PER_LEVEL:12,TEXT_PADDING:10,WHISKER_HALF_HEIGHT:4,DEFAULT_TICK_COUNT:5},nt={GROUP_HEADER_HEIGHT_MULTIPLIER:1.5,OVERALL_ROW_HEIGHT_MULTIPLIER:1.5};function gt(t,e){var P,O,V,z;const n=t.theme,o=n.spacing.rowHeight,i=n.spacing.padding,r=Array.isArray(t.columns)?t.columns:[],c=j(r,"left"),f=j(r,"right"),u=K(c)||K(f)?n.spacing.headerHeight*nt.GROUP_HEADER_HEIGHT_MULTIPLIER:n.spacing.headerHeight,l=!!((P=t.labels)!=null&&P.title),a=!!((O=t.labels)!=null&&O.subtitle),g=!!((V=t.labels)!=null&&V.caption),T=!!((z=t.labels)!=null&&z.footnote),h=l?F.TITLE_HEIGHT:0,N=a?F.SUBTITLE_HEIGHT:0,E=h+N+(l||a?i:0),A=g?F.CAPTION_HEIGHT:0,b=T?F.FOOTNOTE_HEIGHT:0,_=A+b+(g||T?i:0),d=et(t).length,$=!!t.data.overall,p=d*o+($?o*nt.OVERALL_ROW_HEIGHT_MULTIPLIER:0),y=Y(r,"left"),x=Y(r,"right"),I=w.DEFAULT_LABEL_WIDTH+y.reduce((k,v)=>k+(typeof v.width=="number"?v.width:w.DEFAULT_COLUMN_WIDTH),0),m=x.reduce((k,v)=>k+(typeof v.width=="number"?v.width:w.DEFAULT_COLUMN_WIDTH),0),D=e.width??w.DEFAULT_WIDTH,G=t.data.includeForest,X=I+m;let W;if(!G)W=0;else if(typeof t.layout.plotWidth=="number")W=t.layout.plotWidth;else{const k=D-X-w.COLUMN_GAP*2-i*2;W=Math.max(k,w.MIN_FOREST_WIDTH)}const S=i*2+X+W+w.COLUMN_GAP*2,C=Math.max(e.width??D,S),R=E+i+u+p+w.AXIS_HEIGHT+w.AXIS_LABEL_HEIGHT+_+w.BOTTOM_MARGIN;return{totalWidth:C,totalHeight:e.height??R,tableWidth:I+m,forestWidth:W,headerHeight:u,rowHeight:o,plotHeight:p,axisHeight:w.AXIS_HEIGHT,nullValue:t.data.nullValue,summaryYPosition:p-o,showOverallSummary:$,headerTextHeight:E,footerTextHeight:_,titleY:i+F.TITLE_HEIGHT-8,subtitleY:i+h+F.SUBTITLE_HEIGHT-4,mainY:E+i,footerY:E+i+u+p+w.AXIS_HEIGHT+w.AXIS_LABEL_HEIGHT+i}}function et(t){var l;const e=t.data.rows,n=Array.isArray(t.data.groups)?t.data.groups:[];if(n.length===0)return e.map(a=>({type:"data",row:a,depth:0}));const o=new Map;for(const a of n)o.set(a.id,a);const i=new Map;for(const a of e){const g=a.groupId??null;i.has(g)||i.set(g,[]),i.get(g).push(a)}const r=new Set;for(const a of i.keys()){if(!a)continue;let g=a;for(;g;)r.add(g),g=(l=o.get(g))==null?void 0:l.parentId}function c(a){return n.filter(g=>(g.parentId??null)===a&&r.has(g.id))}function f(a){if(!a)return 0;const g=o.get(a);return g?g.depth+1:0}const s=[];function u(a){var T;if(a){const h=o.get(a);if(!h)return;const N=((T=i.get(a))==null?void 0:T.length)??0;s.push({type:"group_header",groupId:h.id,label:h.label,depth:h.depth,rowCount:N})}for(const h of c(a))u(h.id);const g=i.get(a)??[];for(const h of g)s.push({type:"data",row:h,depth:f(h.groupId)})}return u(null),s}function rt(t){const e=[];for(const n of t)n.isGroup?e.push(...rt(n.columns)):e.push(n);return e}function Y(t,e){const n=[];for(const o of t)o.position===e&&(o.isGroup?n.push(...rt(o.columns)):n.push(o));return n}function j(t,e){return t.filter(n=>n.position===e)}function K(t){return t.some(e=>e.isGroup)}function it(t,e){return t.isGroup?t.columns.reduce((n,o)=>n+it(o,e),0):typeof t.width=="number"?t.width:e}function U(t){return t.endsWith("rem")?parseFloat(t)*F.REM_BASE:t.endsWith("px")?parseFloat(t):F.DEFAULT_FONT_SIZE}function J(t,e,n){return n==="right"?{textX:t+e-L.TEXT_PADDING,anchor:"end"}:n==="center"?{textX:t+e/2,anchor:"middle"}:{textX:t+L.TEXT_PADDING,anchor:"start"}}function M(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function q(t,e,n,o=0){const i=n*.55,r=e-o*2,c=Math.floor(r/i);return t.length<=c?t:t.slice(0,c-1)+"â€¦"}function Z(t,e){var o;if(t==null||Number.isNaN(t))return(e==null?void 0:e.naText)??"";if(e!=null&&e.percent){const{decimals:i=1,multiply:r=!1,symbol:c=!0}=e.percent,s=(r?t*100:t).toFixed(i);return c?`${s}%`:s}const n=(o=e==null?void 0:e.numeric)==null?void 0:o.decimals;return n!==void 0?t.toFixed(n):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?Math.round(t).toString():t.toFixed(2)}function $t(t,e){const{eventsField:n,nField:o,separator:i="/",showPct:r=!1}=e.events,c=t.metadata[n],f=t.metadata[o];if(c==null||f===void 0||f===null)return e.naText??"";const s=Number(c),u=Number(f);let l=`${s}${i}${u}`;if(r&&u>0){const a=(s/u*100).toFixed(1);l+=` (${a}%)`}return l}function yt(t,e,n){return t==null||Number.isNaN(t)?"":e==null||n===void 0||n===null||Number.isNaN(e)||Number.isNaN(n)?Z(t):`${t.toFixed(2)} (${e.toFixed(2)}, ${n.toFixed(2)})`}function mt(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function Tt(t,e){const[n,o]=t,[i,r]=e,c=(r-i)/(o-n),f=s=>i+(s-n)*c;return f.domain=()=>t,f.range=()=>e,f.ticks=s=>{const u=(o-n)/(s-1),l=[];for(let a=0;a<s;a++)l.push(n+u*a);return l},f}function xt(t,e){const[n,o]=t.map(l=>Math.max(l,.001)),[i,r]=e,c=Math.log10(n),f=Math.log10(o),s=(r-i)/(f-c),u=l=>{const a=Math.log10(Math.max(l,.001));return i+(a-c)*s};return u.domain=()=>[n,o],u.range=()=>e,u.ticks=l=>{const a=[],g=Math.floor(Math.log10(n)),T=Math.ceil(Math.log10(o));for(let h=g;h<=T;h++){const N=Math.pow(10,h);for(const E of[1,2,5]){const A=N*E;A>=n&&A<=o&&a.push(A)}}return a.length>0?a:[n,o]},u}function Et(t,e){const n=t.data.rows,o=t.theme.axis,i=t.data.scale==="log",r=typeof(o==null?void 0:o.rangeMin)=="number",c=typeof(o==null?void 0:o.rangeMax)=="number";let f;if(r&&c)f=[o.rangeMin,o.rangeMax];else{const u=n.flatMap(l=>[l.lower,l.upper]).filter(l=>l!=null&&!Number.isNaN(l)&&Number.isFinite(l));if(u.length===0)f=i?[.1,10]:[0,1];else{const[l,a]=[Math.min(...u),Math.max(...u)],g=a-l||1;f=[r?o.rangeMin:l-g*tt,c?o.rangeMax:a+g*tt]}}const s=ft(f,i);return i?xt([Math.max(s[0],.01),Math.max(s[1],.02)],[0,e]):Tt(s,[0,e])}function _t(t,e,n){var r,c;const o=[],i=n.spacing.padding;if((r=t.labels)!=null&&r.title){const f=U(n.typography.fontSizeLg);o.push(`<text x="${i}" y="${e.titleY}"
      font-family="${n.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${n.typography.fontWeightBold}"
      fill="${n.colors.foreground}">${M(t.labels.title)}</text>`)}if((c=t.labels)!=null&&c.subtitle){const f=U(n.typography.fontSizeBase);o.push(`<text x="${i}" y="${e.subtitleY}"
      font-family="${n.typography.fontFamily}"
      font-size="${f}px"
      fill="${n.colors.secondary}">${M(t.labels.subtitle)}</text>`)}return o.join(`
`)}function bt(t,e,n){var c,f;const o=[],i=n.spacing.padding;let r=e.footerY;if((c=t.labels)!=null&&c.caption){const s=U(n.typography.fontSizeSm);o.push(`<text x="${i}" y="${r}"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      fill="${n.colors.secondary}">${M(t.labels.caption)}</text>`),r+=F.CAPTION_HEIGHT}if((f=t.labels)!=null&&f.footnote){const s=U(n.typography.fontSizeSm);o.push(`<text x="${i}" y="${r}"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      font-style="italic"
      fill="${n.colors.muted}">${M(t.labels.footnote)}</text>`)}return o.join(`
`)}function at(t,e,n,o,i,r,c,f){const s=[],u=U(r.typography.fontSizeSm),l=r.typography.fontWeightMedium,a=r.typography.fontWeightBold,g=K(t),T=w.DEFAULT_COLUMN_WIDTH,h=f??w.DEFAULT_LABEL_WIDTH,N=(E,A)=>E+A/2+u*F.TEXT_BASELINE_ADJUSTMENT;if(g){const E=i/2,A=i/2;let b=n;c&&(s.push(`<text x="${b+L.TEXT_PADDING}" y="${N(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${l}"
        fill="${r.colors.foreground}">${M(c)}</text>`),s.push(`<line x1="${b+h}" x2="${b+h}"
        y1="${o}" y2="${o+i}"
        stroke="${r.colors.border}" stroke-width="1" opacity="0.3"/>`),b+=h);for(const _ of t)if(_.isGroup){const H=it(_,T),d=b+H/2;s.push(`<text x="${d}" y="${N(o,E)}"
          font-family="${r.typography.fontFamily}"
          font-size="${u}px"
          font-weight="${a}"
          text-anchor="middle"
          fill="${r.colors.foreground}">${M(_.header)}</text>`),s.push(`<line x1="${b}" x2="${b+H}"
          y1="${o+E}" y2="${o+E}"
          stroke="${r.colors.border}" stroke-width="1" opacity="0.5"/>`),b+=H}else{const H=typeof _.width=="number"?_.width:T,d=_.headerAlign??_.align,{textX:$,anchor:p}=J(b,H,d),y=q(_.header,H,u,L.TEXT_PADDING);s.push(`<text x="${$}" y="${N(o,i)}"
          font-family="${r.typography.fontFamily}"
          font-size="${u}px"
          font-weight="${l}"
          text-anchor="${p}"
          fill="${r.colors.foreground}">${M(y)}</text>`),b+=H}b=n+(c?h:0);for(const _ of t)if(_.isGroup){for(const H of _.columns)if(!H.isGroup){const d=typeof H.width=="number"?H.width:T,$=H.headerAlign??H.align,{textX:p,anchor:y}=J(b,d,$);s.push(`<text x="${p}" y="${N(o+E,A)}"
              font-family="${r.typography.fontFamily}"
              font-size="${u}px"
              font-weight="${l}"
              text-anchor="${y}"
              fill="${r.colors.foreground}">${M(H.header)}</text>`),b+=d}}else{const H=typeof _.width=="number"?_.width:T;b+=H}}else{let E=n;c&&(s.push(`<text x="${E+L.TEXT_PADDING}" y="${N(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${l}"
        fill="${r.colors.foreground}">${M(c)}</text>`),E+=h);for(const A of e){const b=typeof A.width=="number"?A.width:T,_=A.headerAlign??A.align,{textX:H,anchor:d}=J(E,b,_),$=q(A.header,b,u,L.TEXT_PADDING);s.push(`<text x="${H}" y="${N(o,i)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${l}"
        text-anchor="${d}"
        fill="${r.colors.foreground}">${M($)}</text>`),E+=b}}return s.join(`
`)}function Ht(t,e,n,o,i,r,c){const f=[],s=U(c.typography.fontSizeBase),u=o+i/2+s*F.TEXT_BASELINE_ADJUSTMENT,l=e*L.INDENT_PER_LEVEL;return f.push(`<rect x="${n}" y="${o}"
    width="${r}" height="${i}"
    fill="${c.colors.primary}" opacity="${dt}"/>`),f.push(`<text x="${n+L.TEXT_PADDING+l}" y="${u}"
    font-family="${c.typography.fontFamily}"
    font-size="${s}px"
    font-weight="${c.typography.fontWeightBold}"
    fill="${c.colors.foreground}">${M(t)}</text>`),f.join(`
`)}function st(t,e){const n=new Map;for(const o of e)if(o.type==="bar"){let i=0;for(const r of t){const c=r.metadata[o.field];typeof c=="number"&&c>i&&(i=c)}n.set(o.field,i>0?i:1)}return n}function lt(t,e,n,o,i,r,c,f=w.DEFAULT_LABEL_WIDTH,s=0,u){var h,N,E,A,b,_,H,d,$,p,y,x,I;const l=[],a=U(r.typography.fontSizeBase),g=o+i/2+a*F.TEXT_BASELINE_ADJUSTMENT;let T=n;if(c){const m=s*L.INDENT_PER_LEVEL+(((h=t.style)==null?void 0:h.indent)??0)*L.INDENT_PER_LEVEL,D=(N=t.style)!=null&&N.bold?r.typography.fontWeightBold:r.typography.fontWeightNormal,G=(E=t.style)!=null&&E.italic?"italic":"normal",X=f-m-L.TEXT_PADDING*2,W=q(t.label,X,a,0);if(l.push(`<text x="${T+L.TEXT_PADDING+m}" y="${g}"
      font-family="${r.typography.fontFamily}"
      font-size="${a}px"
      font-weight="${D}"
      font-style="${G}"
      fill="${((A=t.style)==null?void 0:A.color)??r.colors.foreground}">${M(W)}</text>`),(b=t.style)!=null&&b.badge){const S=String(t.style.badge),C=a*.8,R=4,P=C+R*2,O=t.label.length*a*.55,V=T+L.TEXT_PADDING+m+O+6,k=S.length*C*.6+R*2,v=o+(i-P)/2;l.push(`<rect x="${V}" y="${v}" width="${k}" height="${P}"
        rx="3" fill="${r.colors.primary}" opacity="0.15"/>`),l.push(`<text x="${V+k/2}" y="${v+P/2+C*.35}"
        text-anchor="middle"
        font-family="${r.typography.fontFamily}"
        font-size="${C}px"
        font-weight="500"
        fill="${r.colors.primary}">${M(S)}</text>`)}T+=f}for(const m of e){const D=typeof m.width=="number"?m.width:w.DEFAULT_COLUMN_WIDTH,G=It(t,m),{textX:X,anchor:W}=J(T,D,m.align);if(m.type==="bar"&&typeof t.metadata[m.field]=="number"){const S=t.metadata[m.field],C=u==null?void 0:u.get(m.field),R=((H=(_=m.options)==null?void 0:_.bar)==null?void 0:H.maxValue)??C??100,P=(($=(d=m.options)==null?void 0:d.bar)==null?void 0:$.color)??r.colors.primary,O=r.shapes.pointSize*2,z=D-L.TEXT_PADDING*2-50,k=Math.min(S/R*z,z);l.push(`<rect x="${T+L.TEXT_PADDING}" y="${o+i/2-O/2}"
        width="${Math.max(0,k)}" height="${O}"
        fill="${P}" opacity="0.7" rx="2"/>`);const v=T+D-L.TEXT_PADDING;l.push(`<text x="${v}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${a}px"
        text-anchor="end"
        fill="${r.colors.foreground}">${Z(S)}</text>`)}else if(m.type==="sparkline"&&Array.isArray(t.metadata[m.field])){let S=t.metadata[m.field];Array.isArray(S[0])&&(S=S[0]);const C=((y=(p=m.options)==null?void 0:p.sparkline)==null?void 0:y.height)??16,R=((I=(x=m.options)==null?void 0:x.sparkline)==null?void 0:I.color)??r.colors.primary,P=L.TEXT_PADDING*2,O=At(S,T+L.TEXT_PADDING,o+i/2-C/2,D-P,C);l.push(`<path d="${O}" fill="none" stroke="${R}" stroke-width="1.5"/>`)}else l.push(`<text x="${X}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${a}px"
        text-anchor="${W}"
        fill="${r.colors.foreground}">${M(G)}</text>`);T+=D}return l.join(`
`)}function It(t,e){var o,i,r,c,f,s,u,l;if(e.type==="interval")return yt(t.point,t.lower,t.upper);if(e.type==="numeric"){const a=t.metadata[e.field];return typeof a=="number"?Z(a,e.options):((o=e.options)==null?void 0:o.naText)??""}if(e.type==="custom"&&((i=e.options)!=null&&i.events))return $t(t,e.options);if(e.type==="pvalue"){const a=t.metadata[e.field];if(typeof a!="number")return((r=e.options)==null?void 0:r.naText)??"";const g=(f=(c=e.options)==null?void 0:c.pvalue)==null?void 0:f.stars,T=((u=(s=e.options)==null?void 0:s.pvalue)==null?void 0:u.thresholds)??[.05,.01,.001];let h="";return g&&(a<T[2]?h="***":a<T[1]?h="**":a<T[0]&&(h="*")),a<.001?`<0.001${h}`:`${a.toFixed(3)}${h}`}const n=t.metadata[e.field];return n!=null?String(n):((l=e.options)==null?void 0:l.naText)??""}function At(t,e,n,o,i){if(t.length===0)return"";const r=Math.min(...t),f=Math.max(...t)-r||1;return`M${t.map((u,l)=>{const a=e+l/(t.length-1)*o,g=n+i-(u-r)/f*i;return`${a.toFixed(1)},${g.toFixed(1)}`}).join("L")}`}const ct=6;function Q(t,e,n){const o=t.metadata[e];return o!=null&&typeof o=="number"&&!Number.isNaN(o)?o:n}function Nt(t,e){return e<=1?0:-((e-1)*ct)/2+t*ct}function wt(t,e,n,o,i,r=[],c){var H;let f;r.length===0?f=[{point:t.point,lower:t.lower,upper:t.upper,color:null,shape:null,opacity:null}]:f=r.map(d=>({point:Q(t,d.pointCol,t.point),lower:Q(t,d.lowerCol,t.lower),upper:Q(t,d.upperCol,t.upper),color:d.color??null,shape:d.shape??null,opacity:d.opacity??null}));const s=f.filter(d=>d.point!=null&&!Number.isNaN(d.point)&&d.lower!=null&&!Number.isNaN(d.lower)&&d.upper!=null&&!Number.isNaN(d.upper));if(s.length===0)return"";const u=o.shapes.pointSize,l=o.shapes.lineWidth,a=o.colors.intervalLine,g=L.WHISKER_HALF_HEIGHT,T=((H=t.style)==null?void 0:H.type)==="summary",N=o.shapes.summaryHeight/2;function E(d){var p;if(d&&((p=t.markerStyle)==null?void 0:p.size)!=null)return u*t.markerStyle.size;const $=c?t.metadata[c]:void 0;if($){const y=.5+Math.sqrt($/100)*1.5;return Math.min(Math.max(u*y,3),u*2.5)}return u}function A(d,$){const p=$===0,y=t.markerStyle;let x;p&&(y!=null&&y.color)?x=y.color:d.color?x=d.color:x=o.colors.interval??o.colors.primary??"#2563eb";let I;p&&(y!=null&&y.shape)?I=y.shape:d.shape?I=d.shape:I="square";let m;return p&&(y==null?void 0:y.opacity)!=null?m=y.opacity:d.opacity!=null?m=d.opacity:m=1,{color:x,shape:I,opacity:m}}function b(d,$,p,y){const{color:x,shape:I,opacity:m}=y,D=m<1?` fill-opacity="${m}"`:"";switch(I){case"circle":return`<circle cx="${d}" cy="${$}" r="${p}" fill="${x}"${D}/>`;case"diamond":return`<polygon points="${[`${d},${$-p}`,`${d+p},${$}`,`${d},${$+p}`,`${d-p},${$}`].join(" ")}" fill="${x}"${D}/>`;case"triangle":return`<polygon points="${[`${d},${$-p}`,`${d+p},${$+p}`,`${d-p},${$+p}`].join(" ")}" fill="${x}"${D}/>`;default:return`<rect x="${d-p}" y="${$-p}" width="${p*2}" height="${p*2}" fill="${x}"${D}/>`}}const _=[];return s.forEach((d,$)=>{const p=e+Nt($,s.length),y=n(d.lower),x=n(d.upper),I=n(d.point),m=A(d,$),D=E($===0),G=a;if(T){const X=m.opacity<1?` fill-opacity="${m.opacity}"`:"",W=[`${y},${p}`,`${I},${p-N}`,`${x},${p}`,`${I},${p+N}`].join(" ");_.push(`
        <g class="interval effect-${$} summary">
          <polygon points="${W}"
            fill="${m.color}"${X} stroke="${o.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else _.push(`
        <g class="interval effect-${$}">
          <line x1="${y}" x2="${x}" y1="${p}" y2="${p}"
            stroke="${G}" stroke-width="${l}"/>
          <line x1="${y}" x2="${y}" y1="${p-g}" y2="${p+g}"
            stroke="${G}" stroke-width="${l}"/>
          <line x1="${x}" x2="${x}" y1="${p-g}" y2="${p+g}"
            stroke="${G}" stroke-width="${l}"/>
          ${b(I,p,D,m)}
        </g>`)}),_.join("")}function Dt(t,e,n,o,i,r,c,f){const u=f.shapes.summaryHeight/2,l=i(e),a=i(t),g=i(n),T=r+Math.max(0,Math.min(c,l)),h=r+Math.max(0,Math.min(c,a)),N=r+Math.max(0,Math.min(c,g));return`<polygon points="${[`${T},${o}`,`${h},${o-u}`,`${N},${o}`,`${h},${o+u}`].join(" ")}"
    fill="${f.colors.summaryFill}"
    stroke="${f.colors.summaryBorder}"
    stroke-width="1"/>`}function Lt(t,e,n,o,i){const r=[],c=typeof n.axis.tickCount=="number"?n.axis.tickCount:L.DEFAULT_TICK_COUNT,f=Array.isArray(n.axis.tickValues)?n.axis.tickValues:t.ticks(c),s=U(n.typography.fontSizeSm);r.push(`<line x1="${i}" x2="${i+e.forestWidth}"
    y1="0" y2="0" stroke="${n.colors.border}" stroke-width="1"/>`);for(const u of f){const l=i+t(u);r.push(`<line x1="${l}" x2="${l}" y1="0" y2="4"
      stroke="${n.colors.border}" stroke-width="1"/>`),r.push(`<text x="${l}" y="16" text-anchor="middle"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      fill="${n.colors.secondary}">${mt(u)}</text>`)}return o&&r.push(`<text x="${i+e.forestWidth/2}" y="28"
      text-anchor="middle"
      font-family="${n.typography.fontFamily}"
      font-size="${s}px"
      font-weight="500"
      fill="${n.colors.secondary}">${M(o)}</text>`),`<g transform="translate(0, ${e.mainY+e.headerHeight+e.plotHeight})">${r.join(`
`)}</g>`}function ut(t,e,n,o,i,r){let f=`<line x1="${t}" x2="${t}" y1="${e}" y2="${n}"
    stroke="${i}" stroke-width="1" stroke-dasharray="${o==="dashed"?"6,4":o==="dotted"?"2,2":"none"}"/>`;return r&&(f+=`<text x="${t}" y="${e-4}" text-anchor="middle"
      font-size="10px" fill="${i}">${M(r)}</text>`),f}class B extends Error{constructor(e){super(`SVG Generator: ${e}`),this.name="SVGGeneratorError"}}function Mt(t){if(!t||typeof t!="object")throw new B("Invalid spec: expected an object");const e=t;if(!e.data||typeof e.data!="object")throw new B("Invalid spec: missing or invalid 'data' property");const n=e.data;if(!Array.isArray(n.rows))throw new B("Invalid spec: 'data.rows' must be an array");if(!e.theme||typeof e.theme!="object")throw new B("Invalid spec: missing or invalid 'theme' property");const o=e.theme;if(!o.colors||typeof o.colors!="object")throw new B("Invalid spec: missing or invalid 'theme.colors'");if(!o.typography||typeof o.typography!="object")throw new B("Invalid spec: missing or invalid 'theme.typography'");if(!o.spacing||typeof o.spacing!="object")throw new B("Invalid spec: missing or invalid 'theme.spacing'")}function Gt(t,e={}){Mt(t);const n=t.theme,o=gt(t,e),i=n.spacing.padding,r=Array.isArray(t.columns)?t.columns:[],c=j(r,"left"),f=j(r,"right"),s=Y(r,"left"),u=Y(r,"right"),l=w.DEFAULT_LABEL_WIDTH+s.reduce(($,p)=>$+(typeof p.width=="number"?p.width:w.DEFAULT_COLUMN_WIDTH),0),a=i+l,g=Et(t,o.forestWidth),T=a+o.forestWidth,h=[];h.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${o.totalWidth}" height="${o.totalHeight}"
  viewBox="0 0 ${o.totalWidth} ${o.totalHeight}">`);const N=e.backgroundColor??n.colors.background;h.push(`<rect width="100%" height="100%" fill="${N}"/>`),h.push(_t(t,o,n));const E=o.mainY;h.push(at(c,s,i,E,o.headerHeight,n,t.data.labelHeader??"Study",w.DEFAULT_LABEL_WIDTH)),u.length>0&&h.push(at(f,u,T,E,o.headerHeight,n)),h.push(`<line x1="${i}" x2="${o.totalWidth-i}"
    y1="${E+o.headerHeight}" y2="${E+o.headerHeight}"
    stroke="${n.colors.border}" stroke-width="1"/>`);const A=et(t);if(t.data.includeForest&&o.forestWidth>0){const $=o.mainY+o.headerHeight,p=a+g(t.data.nullValue);h.push(ut(p,$,$+o.plotHeight,"dashed",n.colors.muted));const y=Array.isArray(t.annotations)?t.annotations:[];for(const x of y)if(x.type==="reference_line"){const I=a+g(x.x);h.push(ut(I,$,$+o.plotHeight,x.style,x.color??n.colors.accent,x.label))}if(A.forEach((x,I)=>{if(x.type==="data"){const m=$+I*o.rowHeight+o.rowHeight/2;h.push(wt(x.row,m,D=>a+g(D),n,t.data.nullValue,t.data.effects,t.data.weightCol))}}),t.data.overall&&o.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const x=$+o.summaryYPosition;h.push(Dt(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,x,g,a,o.forestWidth,n))}h.push(Lt(g,o,n,t.data.axisLabel,a))}const b=o.mainY+o.headerHeight,_=t.data.rows,H=st(_,s),d=st(_,u);return A.forEach(($,p)=>{const y=b+p*o.rowHeight;if($.type==="group_header")h.push(Ht($.label,$.depth,i,y,o.rowHeight,o.totalWidth-i*2,n));else{const x=$.row,I=$.depth,m=pt(I),D=p%2===1?ht:0,G=Math.max(m,D);G>0&&h.push(`<rect x="${i}" y="${y}"
          width="${o.totalWidth-i*2}" height="${o.rowHeight}"
          fill="${n.colors.muted}" opacity="${G}"/>`),h.push(lt(x,s,i,y,o.rowHeight,n,!0,w.DEFAULT_LABEL_WIDTH,I,H)),u.length>0&&h.push(lt(x,u,T,y,o.rowHeight,n,!1,0,I,d))}h.push(`<line x1="${i}" x2="${o.totalWidth-i}"
      y1="${y+o.rowHeight}" y2="${y+o.rowHeight}"
      stroke="${n.colors.border}" stroke-width="1" opacity="0.5"/>`)}),h.push(bt(t,o,n)),h.push("</svg>"),h.join(`
`)}function Ft(t,e){const n=JSON.parse(t);return Gt(n,e)}globalThis.generateSVG=Ft})();
