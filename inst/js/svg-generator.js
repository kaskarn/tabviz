(function(){"use strict";const Kt=[1,5,2,2.5,4,3],ft=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function Ct(t,n){return n?gn(t):mn(t)}function gn(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=ft[0];for(const e of ft)if(e<=t[0])n=e;else break;t[0]<ft[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let o=ft[ft.length-1];for(let e=ft.length-1;e>=0&&ft[e]>=t[1];e--)o=ft[e];return t[1]>ft[ft.length-1]&&(o=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,o]}function mn(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const o=Math.pow(10,Math.floor(Math.log10(n)));let e=o,s=1/0;for(const h of Kt)for(const f of[.1,1,10]){const i=h*o*f;if(i<=0)continue;const a=Math.floor(t[0]/i)*i,d=(Math.ceil(t[1]/i)*i-a)/n-1;d>=0&&d<s&&(s=d,e=i)}const r=Math.floor(t[0]/e)*e,l=Math.ceil(t[1]/e)*e;return[Math.round(r*1e10)/1e10,Math.round(l*1e10)/1e10]}function dt(t,n,o,e,s=!1){if(t&&o in t){const r=t[o];if(typeof r=="number"&&Number.isFinite(r)&&(!s||r>0))return r}return o===e&&n!=null&&Number.isFinite(n)&&(!s||n>0)?n:null}const yt=12;function yn(t){const{rows:n,config:o,scale:e,nullValue:s,forestWidth:r,pointSize:l,effects:h=[],pointCol:f,lowerCol:i,upperCol:a}=t,c=$n(n,o,e,s,h,f,i,a),u=xn(c,o,e,r,l),d=Zt(c,o,e,s);return{axisLimits:c,plotRegion:u,ticks:d}}function $n(t,n,o,e,s=[],r,l,h){const f=n.rangeMin!=null,i=n.rangeMax!=null;if(f&&i)return[n.rangeMin,n.rangeMax];const a=[],c=o==="log",u=r||"point";for(const w of t){const k=dt(w.metadata,void 0,u,"point",c);k!=null&&a.push(k);for(const M of s){const L=dt(w.metadata,void 0,M.pointCol,"point",c);L!=null&&a.push(L)}}if(a.length===0)return o==="log"?[.1,10]:[-1,1];let d=Math.min(...a),g=Math.max(...a);(n.includeNull??!0)&&(d=Math.min(d,e),g=Math.max(g,e));const I=d,A=g;let x;if(c){const w=Math.max(d,.001),k=Math.max(g,.001);x=Math.log(k)-Math.log(w)}else x=g-d;if(x===0||!Number.isFinite(x)){const w=a[0];if(c)return Ct([w/2,w*2],!0);{const k=Math.max(1,Math.abs(w)*.1);return Ct([w-k,w+k],!1)}}const[_,b]=Ct([d,g],c),C=n.ciClipFactor??2;let p=_,y=b;const m=[],T=[],E=l||"lower",D=h||"upper";for(const w of t){const k=dt(w.metadata,void 0,E,"lower",c);k!=null&&m.push(k);const M=dt(w.metadata,void 0,D,"upper",c);M!=null&&T.push(M);for(const L of s){const B=dt(w.metadata,void 0,L.lowerCol,"lower",c);B!=null&&m.push(B);const G=dt(w.metadata,void 0,L.upperCol,"upper",c);G!=null&&T.push(G)}}let W,H;if(c)W=p/C,H=y*C;else{const w=y-p;W=p-w*C,H=y+w*C}let z=!1,X=!1;for(const w of m)w>=W?p=Math.min(p,w):z=!0;for(const w of T)w<=H?y=Math.max(y,w):X=!0;if(z&&(p=Math.min(p,W)),X&&(y=Math.max(y,H)),n.symmetric===!0&&!f&&!i)if(o==="log"){const w=Math.log(e),k=Math.max(Math.abs(Math.log(Math.max(I,.001))-w),Math.abs(Math.log(A)-w));p=Math.exp(w-k),y=Math.exp(w+k)}else{const w=Math.max(Math.abs(I-e),Math.abs(A-e));p=e-w,y=e+w}let $=f?n.rangeMin:p,v=i?n.rangeMax:y;return Ct([$,v],o==="log")}function xn(t,n,o,e,s){if(!(n.markerMargin??!0)||e<=0)return t;const l=e-2*yt;if(l<=0)return t;if(o==="log"){const i=Math.log(Math.max(t[0],.001)),a=Math.log(Math.max(t[1],.001)),c=a-i,u=s/2*(c/l),d=Math.min(u,.5);return[Math.exp(i-d),Math.exp(a+d)]}const h=t[1]-t[0],f=s/2*(h/l);return[t[0]-f,t[1]+f]}function Zt(t,n,o,e){const[s,r]=t,l=e>=s&&e<=r,h=(n.nullTick??!0)&&l;if(n.tickValues&&n.tickValues.length>0){let a=n.tickValues.filter(c=>c>=s&&c<=r);return h&&!a.includes(e)&&(a=[...a,e].sort((c,u)=>c-u)),a}const f=n.tickCount??5;let i=o==="log"?Mn(t,f):bn(t,f);return h&&!i.includes(e)&&(i=[...i,e].sort((a,c)=>a-c)),i}function bn(t,n){const[o,e]=t,s=e-o;if(s===0)return[o];const r=s/Math.max(n-1,1),l=Math.pow(10,Math.floor(Math.log10(r)));let h=l,f=1/0;for(const c of Kt){const u=c*l,d=Math.floor(s/u)+1,g=Math.abs(d-n);g<f&&(f=g,h=u);const N=c*l/10;if(N>0){const I=Math.floor(s/N)+1,A=Math.abs(I-n);A<f&&(f=A,h=N)}}const i=Math.ceil(o/h)*h,a=[];for(let c=i;c<=e+h*.001;c+=h){const u=Math.round(c*1e10)/1e10;u>=o&&u<=e&&a.push(u)}return a.length<2&&(a.includes(o)||a.unshift(o),a.includes(e)||a.push(e)),a}function Mn(t,n){const[o,e]=t,r=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(f=>f>=o&&f<=e);if(r.length<=n)return r;const l=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],h=[];for(const f of l)r.includes(f)&&h.length<n&&h.push(f);if(h.length<n){const f=r.filter(a=>!h.includes(a)),i=Math.max(1,Math.floor(f.length/(n-h.length)));for(let a=0;a<f.length&&h.length<n;a+=i)h.push(f[a])}return h.sort((f,i)=>f-i)}function Nn(t){var e,s;const n=((e=t==null?void 0:t.shapes)==null?void 0:e.lineWidth)??1.5,o=((s=t==null?void 0:t.colors)==null?void 0:s.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:o,opacity:1}}function Jt(t,n,o,e){const{width:s,height:r}=e,l=r/2;return t==="left"?`M ${n} ${o} L ${n+s} ${o-l} L ${n+s} ${o+l} Z`:`M ${n} ${o} L ${n-s} ${o-l} L ${n-s} ${o+l} Z`}const Lt={RENDERING_BUFFER:4},Mt={FONT_SCALE:.8,PADDING:4,GAP:6},$t={DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:32,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800},rt={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},Y={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5},Tn={OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},Tt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74,forest:200,viz_bar:150,viz_boxplot:150,viz_violin:150}},Dt={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},Qt={SPACING:6},Pt={EDGE_THRESHOLD:35,MIN_TICK_SPACING:50},En={success:"#16a34a",warning:"#d97706",error:"#dc2626",info:"#2563eb"};function wn(t,n){return n<=1?0:-((n-1)*Qt.SPACING)/2+t*Qt.SPACING}function Wt(t,n){const o=t.split(".");return o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),o.join(".")}function Rt(t){const n=Math.abs(t),o=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const e=n/1e9;return o+Bt(e)+"B"}if(n>=1e6){const e=n/1e6;return o+Bt(e)+"M"}if(n>=1e3){const e=n/1e3;return o+Bt(e)+"K"}return o+Math.round(n).toString()}function Bt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const An={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function In(t){return t.split("").map(n=>An[n]??n).join("")}function Et(t,n){var h,f,i,a,c;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:u,digits:d,multiply:g=!0,symbol:N=!0}=n.percent,I=g?t*100:t,A=d!=null?I.toPrecision(d):I.toFixed(u??1);return N?`${A}%`:A}if(((h=n==null?void 0:n.numeric)==null?void 0:h.abbreviate)&&Math.abs(t)>=1e3)return Rt(t);const e=(f=n==null?void 0:n.numeric)==null?void 0:f.digits;if(e!=null){const u=t.toPrecision(e),d=(i=n==null?void 0:n.numeric)==null?void 0:i.thousandsSep;return d&&typeof d=="string"?Wt(u,d):u}const s=(a=n==null?void 0:n.numeric)==null?void 0:a.decimals,r=(c=n==null?void 0:n.numeric)==null?void 0:c.thousandsSep;let l;return s!==void 0?l=t.toFixed(s):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?l=Math.round(t).toString():l=t.toFixed(2),r&&typeof r=="string"&&(l=Wt(l,r)),l}function tn(t,n){const{eventsField:o,nField:e,separator:s="/",showPct:r=!1,thousandsSep:l,abbreviate:h}=n.events,f=t.metadata[o],i=t.metadata[e];if(f==null||i===void 0||i===null)return n.naText??"";const a=Number(f),c=Number(i);let u,d;h&&(a>=1e3||c>=1e3)?(u=a>=1e3?Rt(a):String(a),d=c>=1e3?Rt(c):String(c)):(u=String(a),d=String(c),l&&typeof l=="string"&&(u=Wt(u,l),d=Wt(d,l)));let g=`${u}${s}${d}`;if(r&&c>0){const N=(a/c*100).toFixed(1);g+=` (${N}%)`}return g}function nn(t,n,o,e){var h,f,i;if(t==null||Number.isNaN(t))return"";const s=((h=e==null?void 0:e.interval)==null?void 0:h.decimals)??2,r=((f=e==null?void 0:e.interval)==null?void 0:f.sep)??" ",l=(i=e==null?void 0:e.interval)==null?void 0:i.impreciseThreshold;return n==null||o===void 0||o===null||Number.isNaN(n)||Number.isNaN(o)?t.toFixed(s):l!=null&&n>0&&o/n>l?"—":`${t.toFixed(s)}${r}(${n.toFixed(s)}, ${o.toFixed(s)})`}function on(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const o=n==null?void 0:n.pvalue,e=(o==null?void 0:o.digits)??2,s=(o==null?void 0:o.expThreshold)??.001,r=(o==null?void 0:o.abbrevThreshold)??null,l=(o==null?void 0:o.format)??"auto",h=(o==null?void 0:o.stars)??!1,f=(o==null?void 0:o.thresholds)??[.05,.01,.001];let i="";if(h&&(t<f[2]?i="***":t<f[1]?i="**":t<f[0]&&(i="*")),r!==null&&t<r)return`<${r}${i}`;if(l==="scientific"||l==="auto"&&t<s){const c=Math.floor(Math.log10(t));return`${(t/Math.pow(10,c)).toPrecision(e)}×10${In(c.toString())}${i}`}let a;return t>=.1?a=t.toFixed(e):t>=.01?a=t.toFixed(e+1):a=t.toFixed(e+2),`${a}${i}`}function _n(t,n){var r,l,h,f;const{type:o,field:e,options:s}=n;switch(o){case"interval":{const i=(r=s==null?void 0:s.interval)!=null&&r.point?t.metadata[s.interval.point]:t.point,a=(l=s==null?void 0:s.interval)!=null&&l.lower?t.metadata[s.interval.lower]:t.lower,c=(h=s==null?void 0:s.interval)!=null&&h.upper?t.metadata[s.interval.upper]:t.upper;return nn(i,a,c,s)}case"custom":return s!=null&&s.events?tn(t,s):String(t.metadata[e]??"");case"pvalue":return on(t.metadata[e],s);case"numeric":return Et(t.metadata[e],s);case"percent":return Et(t.metadata[e],s);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const i=t.metadata[e];return i==null?"":`  ${String(i)}  `}case"bar":{if(((f=s==null?void 0:s.bar)==null?void 0:f.showLabel)===!1)return"";const i=t.metadata[e];return i==null?"":i>=100?i.toFixed(0):i>=10?i.toFixed(1):i.toFixed(2)}case"text":default:return String(t.metadata[e]??"")}}function at(t,n){const o="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻";let e=0;for(const s of t)o.includes(s)?e+=n*.3:"il1.,;:|!()[]{}' ".includes(s)?e+=n*.35:"×−".includes(s)?e+=n*.5:"mwMW@%".includes(s)?e+=n*.85:s>="0"&&s<="9"?e+=n*.6:e+=n*.55;return e}function Cn(t){if(!t||t.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const n=t.filter(s=>s!=null&&!Number.isNaN(s)).sort((s,r)=>s-r);if(n.length===0)return{min:NaN,q1:NaN,median:NaN,q3:NaN,max:NaN};const o=n.length,e=s=>{if(o===1)return n[0];const r=(o-1)*s,l=Math.floor(r),h=Math.ceil(r);return l===h?n[l]:n[l]+(r-l)*(n[h]-n[l])};return{min:n[0],q1:e(.25),median:e(.5),q3:e(.75),max:n[o-1]}}function Dn(t,n,o){if(!t||t.length===0||Number.isNaN(n)||Number.isNaN(o))return[];const e=o-n,s=n-1.5*e,r=o+1.5*e;return t.filter(l=>l!=null&&!Number.isNaN(l)&&(l<s||l>r))}function en(t){const n=Cn(t),o=Dn(t,n.q1,n.q3);return{...n,outliers:o}}function Wn(t){if(!t||t.length<2)return 1;const n=t.filter(d=>d!=null&&!Number.isNaN(d)).sort((d,g)=>d-g);if(n.length<2)return 1;const o=n.length,e=n.reduce((d,g)=>d+g,0)/o,s=n.reduce((d,g)=>d+(g-e)**2,0)/(o-1),r=Math.sqrt(s),l=Math.floor((o-1)*.25),h=Math.floor((o-1)*.75),f=n[l],a=n[h]-f,u=.9*Math.min(r,a/1.34)*Math.pow(o,-.2);return Math.max(u,.001)}function kn(t){return Math.exp(-.5*t*t)/Math.sqrt(2*Math.PI)}function Hn(t,n,o=128){if(!t||t.length===0)return{x:[],y:[]};const e=t.filter(d=>d!=null&&!Number.isNaN(d));if(e.length===0)return{x:[],y:[]};const s=n??Wn(e),r=Math.min(...e),l=Math.max(...e),h=3*s,f=r-h,a=(l+h-f)/(o-1),c=[],u=[];for(let d=0;d<o;d++){const g=f+d*a;c.push(g);let N=0;for(const I of e)N+=kn((g-I)/s);N/=e.length*s,u.push(N)}return{x:c,y:u}}function Fn(t,n){if(t.y.length===0)return t;const o=Math.max(...t.y);if(o===0)return t;const e=t.y.map(s=>s/o*n);return{x:t.x,y:e}}function Sn(t,n){var i,a;const o=new Map,e=nt(t.theme.typography.fontSizeBase),s=t.theme.typography.headerFontScale??1.05,r=Math.round(e*s*100)/100,l=t.data.rows,h=(t.theme.spacing.cellPaddingX??10)*2,f=(t.theme.spacing.groupPadding??8)*2;for(const c of n){if(c.width!=="auto"&&c.width!==null&&c.width!==void 0)continue;let u=0;c.header&&(u=Math.max(u,at(c.header,r)));for(const N of l){if(((i=N.style)==null?void 0:i.type)==="header"||((a=N.style)==null?void 0:a.type)==="spacer")continue;const I=_n(N,c);I&&(u=Math.max(u,at(I,e)))}const d=Tt.VISUAL_MIN[c.type]??Tt.MIN,g=Math.ceil(u+h+Lt.RENDERING_BUFFER);o.set(c.id,Math.min(Tt.MAX,Math.max(d,g)))}return vn(t.columns,o,r,f,Lt.RENDERING_BUFFER),o}function vn(t,n,o,e,s){function r(f){return f.isGroup?f.columns.flatMap(r):[f]}function l(f){const i=n.get(f.id);return i!==void 0?i:typeof f.width=="number"?f.width:Tt.MIN}function h(f){if(f.isGroup){for(const i of f.columns)h(i);if(f.header){const i=at(f.header,o)+e+s,a=r(f),c=a.reduce((u,d)=>u+l(d),0);if(i>c&&a.length>0){const u=Math.ceil((i-c)/a.length);for(const d of a)n.set(d.id,l(d)+u)}}}}for(const f of t)h(f)}function rn(t,n,o){let e=o.filter(r=>r.groupId===t).length;const s=n.filter(r=>r.parentId===t);for(const r of s)e+=rn(r.id,n,o);return e}function an(t){var f,i;const n=nt(t.theme.typography.fontSizeBase),o=(t.theme.spacing.cellPaddingX??10)*2;let e=0;const s=new Map,r=Array.isArray(t.data.groups)?t.data.groups:[];for(const a of r)s.set(a.id,a.depth);const l=a=>a?(s.get(a)??0)+1:0;t.data.labelHeader&&(e=Math.max(e,at(t.data.labelHeader,n)));for(const a of t.data.rows)if(a.label){const c=l(a.groupId),u=((f=a.style)==null?void 0:f.indent)??0,g=(c+u)*Y.INDENT_PER_LEVEL;let N=at(a.label,n)+g;if((i=a.style)!=null&&i.badge){const I=String(a.style.badge),A=n*Mt.FONT_SCALE,_=at(I,A)+Mt.PADDING*2;N+=Mt.GAP+_}e=Math.max(e,N)}for(const a of r)if(a.label){const c=a.depth*Y.INDENT_PER_LEVEL,u=at(a.label,n),g=`(${rn(a.id,r,t.data.rows)})`,N=n*.75,I=at(g,N),A=c+Dt.CHEVRON_WIDTH+Dt.GAP+u+Dt.GAP+I+Dt.SAFETY_MARGIN;e=Math.max(e,A)}const h=Math.ceil(e+o+Lt.RENDERING_BUFFER);return Math.min(Tt.LABEL_MAX,Math.max(Tt.MIN,h))}function zt(t,n){const o=n.get(t.id);return o!==void 0?o:typeof t.width=="number"?t.width:$t.DEFAULT_COLUMN_WIDTH}function Gn(t,n,o=0){var st,F,K,tt,ht;const e=t.theme,s=e.spacing.rowHeight,r=e.spacing.padding,l=e.spacing.columnGap??8,h=Array.isArray(t.columns)?t.columns:[],f=ln(h,"left"),i=ln(h,"right"),a=kt(f)||kt(i)||kt(h),c=a?2:1,u=e.spacing.cellPaddingY??4,N=(e.spacing.headerHeight/c+(a?u*2:0))*c,I=!!((st=t.labels)!=null&&st.title),A=!!((F=t.labels)!=null&&F.subtitle),x=!!((K=t.labels)!=null&&K.caption),_=!!((tt=t.labels)!=null&&tt.footnote),b=I?rt.TITLE_HEIGHT:0,C=A?rt.SUBTITLE_HEIGHT:0,p=b+C+(I||A?r:0),y=x?rt.CAPTION_HEIGHT:0,m=_?rt.FOOTNOTE_HEIGHT:0,T=y+m+(x||_?r:0),E=sn(t),D=!!t.data.overall;let W=0;for(const S of E){const j=S.type==="data"&&((ht=S.row.style)==null?void 0:ht.type)==="spacer";W+=j?s/2:s}D&&(W+=s*Tn.OVERALL_ROW_HEIGHT_MULTIPLIER);const H=Ut(h,"left"),z=Ut(h,"right"),X=Xt(h).filter(S=>S.position===void 0),O=[...H,...z,...X];let $,v;if(n.columnWidths){$=new Map;for(const[S,j]of Object.entries(n.columnWidths))S!=="__label__"&&$.set(S,j);v=n.columnWidths.__label__??an(t)}else $=Sn(t,O),v=an(t);const w=v+H.reduce((S,j)=>S+zt(j,$),0),k=z.reduce((S,j)=>S+zt(j,$),0),M=X.filter(S=>S.type!=="forest").reduce((S,j)=>S+zt(j,$),0),L=n.width??$t.DEFAULT_WIDTH,G=O.some(S=>S.type==="forest")||t.data.includeForest,U=w+k+M;let V;if(!G)V=0;else if(typeof n.forestWidth=="number")V=n.forestWidth;else if(typeof t.layout.plotWidth=="number")V=t.layout.plotWidth;else{const S=L-U-l*2-r*2;V=Math.max(S,$t.MIN_FOREST_WIDTH)}const q=r*2+U+V+l*2,Q=Math.max(n.width??L,q);G&&Q>q&&typeof n.forestWidth!="number"&&typeof t.layout.plotWidth!="number"&&(V=Q-U-r*2-l*2);const ct=(e.spacing.axisGap??12)+$t.AXIS_HEIGHT+$t.AXIS_LABEL_HEIGHT,it=p+r+N+W+ct+T+$t.BOTTOM_MARGIN;return{totalWidth:Q,totalHeight:n.height??it,tableWidth:w+k,forestWidth:V,headerHeight:N,rowHeight:s,plotHeight:W,axisHeight:$t.AXIS_HEIGHT,nullValue:o,summaryYPosition:W-s,showOverallSummary:D,headerTextHeight:p,footerTextHeight:T,titleY:r+rt.TITLE_HEIGHT-8,subtitleY:r+b+rt.SUBTITLE_HEIGHT-4,mainY:p+r,footerY:p+r+N+W+ct+8,autoWidths:$,labelWidth:v}}function sn(t){var c;const n=t.data.rows,o=Array.isArray(t.data.groups)?t.data.groups:[];if(o.length===0)return n.map(u=>({type:"data",row:u,depth:0}));const e=new Map;for(const u of o)e.set(u.id,u);const s=new Map;for(const u of n){const d=u.groupId??null;s.has(d)||s.set(d,[]),s.get(d).push(u)}const r=new Set;for(const u of s.keys()){if(!u)continue;let d=u;for(;d;)r.add(d),d=(c=e.get(d))==null?void 0:c.parentId}function l(u){return o.filter(d=>(d.parentId??null)===u&&r.has(d.id))}function h(u){if(!u)return 0;const d=e.get(u);return d?d.depth+1:0}function f(u){var g;let d=((g=s.get(u))==null?void 0:g.length)??0;for(const N of l(u))d+=f(N.id);return d}const i=[];function a(u){if(u){const g=e.get(u);if(!g)return;const N=f(u);i.push({type:"group_header",groupId:g.id,label:g.label,depth:g.depth,rowCount:N})}for(const g of l(u))a(g.id);const d=s.get(u)??[];for(const g of d)i.push({type:"data",row:g,depth:h(g.groupId)})}return a(null),i}function Vt(t){const n=[];for(const o of t)o.isGroup?n.push(...Vt(o.columns)):n.push(o);return n}function Xt(t){const n=[];for(const o of t)o.isGroup?n.push(...Vt(o.columns)):n.push(o);return n}function Ut(t,n){if(n===void 0)return Xt(t);const o=[];for(const e of t)e.position===n&&(e.isGroup?o.push(...Vt(e.columns)):o.push(e));return o}function ln(t,n){return t.filter(o=>o.position===n)}function kt(t){return t.some(n=>n.isGroup)}function nt(t){let n;return t.endsWith("rem")?n=parseFloat(t)*rt.REM_BASE:t.endsWith("px")?n=parseFloat(t):n=rt.DEFAULT_FONT_SIZE,Math.round(n*100)/100}function Ht(t,n,o){return o==="right"?{textX:t+n-Y.TEXT_PADDING,anchor:"end"}:o==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+Y.TEXT_PADDING,anchor:"start"}}function J(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function cn(t,n,o,e=0){const s=n-e*2;if(at(t,o)<=s)return t;const l="…",h=o*.55;let f=0,i=t.length;for(;f<i;){const a=Math.ceil((f+i)/2),c=t.slice(0,a);at(c,o)+h<=s?f=a:i=a-1}return f===0?l:t.slice(0,f)+l}function Ln(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function wt(t,n){const[o,e]=t,[s,r]=n,l=(r-s)/(e-o),h=f=>s+(f-o)*l;return h.domain=()=>t,h.range=()=>n,h.ticks=f=>{const i=(e-o)/(f-1),a=[];for(let c=0;c<f;c++)a.push(o+i*c);return a},h}function At(t,n){const[o,e]=t.map(a=>Math.max(a,.001)),[s,r]=n,l=Math.log10(o),h=Math.log10(e),f=(r-s)/(h-l),i=a=>{const c=Math.log10(Math.max(a,.001));return s+(c-l)*f};return i.domain=()=>[o,e],i.range=()=>n,i.ticks=a=>{const c=[],u=Math.floor(Math.log10(o)),d=Math.ceil(Math.log10(e));for(let g=u;g<=d;g++){const N=Math.pow(10,g);for(const I of[1,2,5]){const A=N*I;A>=o&&A<=e&&c.push(A)}}return c.length>0?c:[o,e]},i}function Pn(t,n,o,e){const s=o.scale==="log",r=yt,l=Math.max(n-yt,r+50);if(e!=null&&e.xDomain){const c=e.xDomain,u=e.clipBounds??c,d=Zt(u,t.theme.axis,o.scale,o.nullValue);return s?{scale:At([Math.max(c[0],.01),Math.max(c[1],.02)],[r,l]),clipBounds:u,ticks:d}:{scale:wt(c,[r,l]),clipBounds:u,ticks:d}}const h=yn({rows:t.data.rows,config:t.theme.axis,scale:o.scale,nullValue:o.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:o.effects,pointCol:o.pointCol,lowerCol:o.lowerCol,upperCol:o.upperCol}),{plotRegion:f,axisLimits:i,ticks:a}=h;return s?{scale:At([Math.max(f[0],.01),Math.max(f[1],.02)],[r,l]),clipBounds:i,ticks:a}:{scale:wt(f,[r,l]),clipBounds:i,ticks:a}}function Rn(t,n,o){var r,l;const e=[],s=o.spacing.padding;if((r=t.labels)!=null&&r.title){const h=nt(o.typography.fontSizeLg);e.push(`<text x="${s}" y="${n.titleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${o.typography.fontWeightBold}"
      fill="${o.colors.foreground}">${J(t.labels.title)}</text>`)}if((l=t.labels)!=null&&l.subtitle){const h=nt(o.typography.fontSizeBase);e.push(`<text x="${s}" y="${n.subtitleY}"
      font-family="${o.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${J(t.labels.subtitle)}</text>`)}return e.join(`
`)}function Bn(t,n,o){var h,f,i,a;const e=[],s=o.spacing.padding;let r=n.footerY;if(!!((h=t.labels)!=null&&h.caption)||!!((f=t.labels)!=null&&f.footnote)){const c=n.footerY-8;e.push(`<line x1="${s}" x2="${n.totalWidth-s}"
      y1="${c}" y2="${c}"
      stroke="${o.colors.border}" stroke-width="1"/>`)}if((i=t.labels)!=null&&i.caption){const c=nt(o.typography.fontSizeSm);e.push(`<text x="${s}" y="${r}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${J(t.labels.caption)}</text>`),r+=rt.CAPTION_HEIGHT}if((a=t.labels)!=null&&a.footnote){const c=nt(o.typography.fontSizeSm);e.push(`<text x="${s}" y="${r}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightNormal}"
      font-style="italic"
      fill="${o.colors.muted}">${J(t.labels.footnote)}</text>`)}return e.join(`
`)}function zn(t,n,o,e,s,r,l,h){const f=[],i=n+1,a=h.groupHeaders;let c,u,d,g,N;if(i===1?(c=nt((a==null?void 0:a.level1FontSize)??h.typography.fontSizeBase),u=(a==null?void 0:a.level1FontWeight)??h.typography.fontWeightBold,d=(a==null?void 0:a.level1Italic)??!1,g=(a==null?void 0:a.level1Background)??null,N=(a==null?void 0:a.level1BorderBottom)??!1):i===2?(c=nt((a==null?void 0:a.level2FontSize)??h.typography.fontSizeBase),u=(a==null?void 0:a.level2FontWeight)??h.typography.fontWeightMedium,d=(a==null?void 0:a.level2Italic)??!0,g=(a==null?void 0:a.level2Background)??null,N=(a==null?void 0:a.level2BorderBottom)??!1):(c=nt((a==null?void 0:a.level3FontSize)??h.typography.fontSizeBase),u=(a==null?void 0:a.level3FontWeight)??h.typography.fontWeightNormal,d=(a==null?void 0:a.level3Italic)??!1,g=(a==null?void 0:a.level3Background)??null,N=(a==null?void 0:a.level3BorderBottom)??!1),!g){const b=h.colors.primary,C=i===1?.15:i===2?.1:.06,p=b.replace("#",""),y=parseInt(p.substring(0,2),16),m=parseInt(p.substring(2,4),16),T=parseInt(p.substring(4,6),16);g=`rgba(${y}, ${m}, ${T}, ${C})`}const I=s+r/2+c*rt.TEXT_BASELINE_ADJUSTMENT,A=n*((a==null?void 0:a.indentPerLevel)??Y.INDENT_PER_LEVEL);f.push(`<rect x="${e}" y="${s}"
    width="${l}" height="${r}"
    fill="${g}"/>`),N&&f.push(`<line x1="${e}" x2="${e+l}" y1="${s+r}" y2="${s+r}"
      stroke="${h.colors.border}" stroke-width="1" opacity="0.5"/>`);const x=d?' font-style="italic"':"",_=e+Y.TEXT_PADDING+A;if(f.push(`<text x="${_}" y="${I}"
    font-family="${h.typography.fontFamily}"
    font-size="${c}px"
    font-weight="${u}"${x}
    fill="${h.colors.foreground}">${J(t)}</text>`),o>0){const b=c*rt.AVG_CHAR_WIDTH_RATIO,C=t.length*b,p=_+C+6,y=nt(h.typography.fontSizeSm??"0.75rem");f.push(`<text x="${p}" y="${I}"
      font-family="${h.typography.fontFamily}"
      font-size="${y}px"
      font-weight="${h.typography.fontWeightNormal}"
      fill="${h.colors.muted}">(${o})</text>`)}return f.join(`
`)}function Vn(t,n){const o=new Map;for(const e of n)if(e.type==="bar"){let s=0;for(const r of t){const l=r.metadata[e.field];typeof l=="number"&&l>s&&(s=l)}o.set(e.field,s>0?s:1)}return o}function Xn(t,n){var e,s,r,l,h,f,i,a,c,u,d,g,N,I,A,x,_,b,C;if(n.type==="interval"){const p=(s=(e=n.options)==null?void 0:e.interval)!=null&&s.point?t.metadata[n.options.interval.point]:t.point,y=(l=(r=n.options)==null?void 0:r.interval)!=null&&l.lower?t.metadata[n.options.interval.lower]:t.lower,m=(f=(h=n.options)==null?void 0:h.interval)!=null&&f.upper?t.metadata[n.options.interval.upper]:t.upper;return nn(p,y,m,n.options)}if(n.type==="numeric"){const p=t.metadata[n.field];return typeof p=="number"?Et(p,n.options):((i=n.options)==null?void 0:i.naText)??""}if(n.type==="custom"&&((a=n.options)!=null&&a.events))return tn(t,n.options);if(n.type==="pvalue"){const p=t.metadata[n.field];return typeof p!="number"?((c=n.options)==null?void 0:c.naText)??"":on(p,n.options)}if(n.type==="icon"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=(d=(u=n.options)==null?void 0:u.icon)==null?void 0:d.mapping;return m&&y in m?m[y]:y}if(n.type==="badge"){const p=t.metadata[n.field];return p!=null?String(p):""}if(n.type==="stars"){const p=t.metadata[n.field];if(typeof p!="number")return"";const y=((N=(g=n.options)==null?void 0:g.stars)==null?void 0:N.maxStars)??5,m=Math.max(0,Math.min(y,p)),T=Math.floor(m),E=y-T;return"★".repeat(T)+"☆".repeat(E)}if(n.type==="img")return((A=(I=n.options)==null?void 0:I.img)==null?void 0:A.fallback)??"[IMG]";if(n.type==="reference"){const p=t.metadata[n.field];if(p==null)return"";const y=String(p),m=((_=(x=n.options)==null?void 0:x.reference)==null?void 0:_.maxChars)??30;return y.length<=m?y:y.substring(0,m)+"..."}if(n.type==="range"){const p=(b=n.options)==null?void 0:b.range;if(!p)return"";const y=t.metadata[p.minField],m=t.metadata[p.maxField],T=p.separator??" – ",E=p.decimals,D=W=>typeof W!="number"?"":E==null?Number.isInteger(W)?String(W):W.toFixed(1):W.toFixed(E);return y===null&&m===null?"":y===null?D(m):m===null?D(y):`${D(y)}${T}${D(m)}`}const o=t.metadata[n.field];return o!=null?String(o):((C=n.options)==null?void 0:C.naText)??""}function Un(t,n,o,e,s){const r=t.filter(a=>Number.isFinite(a));if(r.length===0)return"";if(r.length===1){const a=n+e/2,c=o+s/2;return`M${a.toFixed(1)},${c.toFixed(1)}`}const l=Math.min(...r),f=Math.max(...r)-l||1;return`M${r.map((a,c)=>{const u=n+c/(r.length-1)*e,d=o+s-(a-l)/f*s;return`${u.toFixed(1)},${d.toFixed(1)}`}).join("L")}`}function qn(t,n,o,e,s,r=[],l,h=0,f=1/0,i,a=!1){var y;let c;if(r.length===0){const m=!a||t.point!=null&&t.point>0?t.point:null,T=!a||t.lower!=null&&t.lower>0?t.lower:null,E=!a||t.upper!=null&&t.upper>0?t.upper:null;c=[{point:m,lower:T,upper:E,color:null,shape:null,opacity:null}]}else c=r.map(m=>({point:dt(t.metadata,t.point,m.pointCol,"point",a),lower:dt(t.metadata,t.lower,m.lowerCol,"lower",a),upper:dt(t.metadata,t.upper,m.upperCol,"upper",a),color:m.color??null,shape:m.shape??null,opacity:m.opacity??null}));const u=c.filter(m=>m.point!=null&&!Number.isNaN(m.point)&&m.lower!=null&&!Number.isNaN(m.lower)&&m.upper!=null&&!Number.isNaN(m.upper));if(u.length===0)return"";const d=e.shapes.pointSize,g=e.shapes.lineWidth,N=e.colors.intervalLine,I=((y=t.style)==null?void 0:y.type)==="summary",x=e.shapes.summaryHeight/2;function _(m){var E;if(m&&((E=t.markerStyle)==null?void 0:E.size)!=null)return d*t.markerStyle.size;const T=l?t.metadata[l]:void 0;if(T){const D=.5+Math.sqrt(T/100)*1.5;return Math.min(Math.max(d*D,3),d*2.5)}return d}function b(m,T){const E=T===0,D=t.markerStyle,W=e.shapes.effectColors,H=e.shapes.markerShapes,z=["square","circle","diamond","triangle"];let X;E&&(D!=null&&D.color)?X=D.color:m.color?X=m.color:W&&W.length>0?X=W[T%W.length]:X=e.colors.interval??e.colors.primary??"#2563eb";let O;E&&(D!=null&&D.shape)?O=D.shape:m.shape?O=m.shape:H&&H.length>0?O=H[T%H.length]:O=z[T%z.length];let $;return E&&(D==null?void 0:D.opacity)!=null?$=D.opacity:m.opacity!=null?$=m.opacity:$=1,{color:X,shape:O,opacity:$}}function C(m,T,E,D){const{color:W,shape:H,opacity:z}=D,X=z<1?` fill-opacity="${z}"`:"";switch(H){case"circle":return`<circle cx="${m}" cy="${T}" r="${E}" fill="${W}"${X}/>`;case"diamond":return`<polygon points="${[`${m},${T-E}`,`${m+E},${T}`,`${m},${T+E}`,`${m-E},${T}`].join(" ")}" fill="${W}"${X}/>`;case"triangle":return`<polygon points="${[`${m},${T-E}`,`${m+E},${T+E}`,`${m-E},${T+E}`].join(" ")}" fill="${W}"${X}/>`;default:return`<rect x="${m-E}" y="${T-E}" width="${E*2}" height="${E*2}" fill="${W}"${X}/>`}}const p=[];return u.forEach((m,T)=>{const E=n+wn(T,u.length),D=o(m.lower),W=o(m.upper),H=o(m.point),z=b(m,T),X=_(T===0),O=N;if(I){const $=z.opacity<1?` fill-opacity="${z.opacity}"`:"",v=[`${D},${E}`,`${H},${E-x}`,`${W},${E}`,`${H},${E+x}`].join(" ");p.push(`
        <g class="interval effect-${T} summary">
          <polygon points="${v}"
            fill="${z.color}"${$} stroke="${e.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const $=h+yt,v=h+f-yt,w=i?m.lower<i[0]:D<$,k=i?m.upper>i[1]:W>v;let M,L;if(i){const ct=Math.max(i[0],Math.min(i[1],m.lower)),it=Math.max(i[0],Math.min(i[1],m.upper));M=o(ct),L=o(it)}else M=Math.max($,Math.min(v,D)),L=Math.max($,Math.min(v,W));const B=Nn(e),G=B.height/2,U=i?o(i[0]):$,V=i?o(i[1]):v;let q="";w?q=`<path d="${Jt("left",U,E,B)}" fill="${B.color}"/>`:q=`<line x1="${M}" x2="${M}" y1="${E-G}" y2="${E+G}" stroke="${O}" stroke-width="${g}"/>`;let Q="";k?Q=`<path d="${Jt("right",V,E,B)}" fill="${B.color}"/>`:Q=`<line x1="${L}" x2="${L}" y1="${E-G}" y2="${E+G}" stroke="${O}" stroke-width="${g}"/>`;const xt=i?o(Math.max(i[0],Math.min(i[1],m.point))):Math.max($,Math.min(v,H));p.push(`
        <g class="interval effect-${T}">
          <line x1="${M}" x2="${L}" y1="${E}" y2="${E}"
            stroke="${O}" stroke-width="${g}"/>
          ${q}
          ${Q}
          ${C(xt,E,X,z)}
        </g>`)}}),p.join("")}function Yn(t,n,o,e,s,r,l,h){const i=h.shapes.summaryHeight/2,[a,c]=s.domain().map(C=>s(C)),u=Math.min(a,c),d=Math.max(a,c),g=s(n),N=s(t),I=s(o),A=r+Math.max(u,Math.min(d,g)),x=r+Math.max(u,Math.min(d,N)),_=r+Math.max(u,Math.min(d,I));return`<polygon points="${[`${A},${e}`,`${x},${e-i}`,`${_},${e}`,`${x},${e+i}`].join(" ")}"
    fill="${h.colors.summaryFill}"
    stroke="${h.colors.summaryBorder}"
    stroke-width="1"/>`}function On(t,n,o,e,s,r,l,h){const f=[],i=r.effects,a=i.length;if(!i.some(A=>{const x=t.metadata[A.value];return x!=null&&!Number.isNaN(x)}))return"";const u=o*.7,d=a>1?2:0,g=(u-d*(a-1))/a,N=Math.max(4,g),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"];return i.forEach((A,x)=>{const _=t.metadata[A.value];if(_==null||Number.isNaN(_))return;const b=n-u/2+x*(N+d),C=e+l(Math.min(0,_)),p=Math.abs(l(_)-l(0)),y=A.color??I[x%I.length],m=A.opacity??.85;f.push(`<rect
      x="${C}" y="${b}"
      width="${Math.max(1,p)}" height="${N}"
      fill="${y}" fill-opacity="${m}" rx="2"
      class="viz-bar-segment"/>`)}),f.join(`
`)}function jn(t,n,o,e,s,r,l,h){const f=[],i=r.effects,a=i.length,c=i.map(x=>{if(x.data){const _=t.metadata[x.data];return!_||!Array.isArray(_)||_.length===0?null:en(_)}if(x.min&&x.q1&&x.median&&x.q3&&x.max){const _=t.metadata[x.min],b=t.metadata[x.q1],C=t.metadata[x.median],p=t.metadata[x.q3],y=t.metadata[x.max];if([_,b,C,p,y].some(T=>T==null||Number.isNaN(T)))return null;let m=[];if(x.outliers){const T=t.metadata[x.outliers];T&&Array.isArray(T)&&(m=T)}return{min:_,q1:b,median:C,q3:p,max:y,outliers:m}}return null});if(!c.some(x=>x!==null))return"";const d=o*.7,g=a>1?2:0,N=Math.max(8,(d-(a-1)*g)/a),I=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],A=h.colors.foreground??"#1a1a1a";return i.forEach((x,_)=>{const b=c[_];if(!b)return;const C=n-d/2+_*(N+g),p=C+N/2,y=x.color??I[_%I.length],m=x.fillOpacity??.7;f.push(`<line
      x1="${e+l(b.min)}" x2="${e+l(b.q1)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),f.push(`<line
      x1="${e+l(b.min)}" x2="${e+l(b.min)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`),f.push(`<line
      x1="${e+l(b.q3)}" x2="${e+l(b.max)}"
      y1="${p}" y2="${p}"
      stroke="${A}" stroke-width="1"/>`),f.push(`<line
      x1="${e+l(b.max)}" x2="${e+l(b.max)}"
      y1="${p-N/4}" y2="${p+N/4}"
      stroke="${A}" stroke-width="1"/>`);const T=Math.max(2,l(b.q3)-l(b.q1));if(f.push(`<rect
      x="${e+l(b.q1)}" y="${C}"
      width="${T}" height="${N}"
      fill="${y}" fill-opacity="${m}"
      stroke="${A}" stroke-width="1"/>`),f.push(`<line
      x1="${e+l(b.median)}" x2="${e+l(b.median)}"
      y1="${C}" y2="${C+N}"
      stroke="${A}" stroke-width="2"/>`),r.showOutliers!==!1&&b.outliers.length>0)for(const E of b.outliers)f.push(`<circle
          cx="${e+l(E)}" cy="${p}"
          r="2.5"
          fill="none" stroke="${y}" stroke-width="1.5"/>`)}),f.join(`
`)}function Kn(t,n,o,e,s,r,l,h){const f=[],i=r.effects,a=i.length,c=i.map(b=>{const C=t.metadata[b.data];return!C||!Array.isArray(C)||C.length<2?null:Hn(C,r.bandwidth)}),u=i.map(b=>{const C=t.metadata[b.data];if(!C||!Array.isArray(C)||C.length<2)return null;const p=C.filter(T=>T!=null&&!Number.isNaN(T)).sort((T,E)=>T-E);if(p.length===0)return null;const y=p.length,m=T=>{if(y===1)return p[0];const E=(y-1)*T,D=Math.floor(E),W=Math.ceil(E);return D===W?p[D]:p[D]+(E-D)*(p[W]-p[D])};return{q1:m(.25),median:m(.5),q3:m(.75)}});if(!c.some(b=>b!==null))return"";const g=o*.8,N=a>1?2:0,I=Math.max(10,(g-(a-1)*N)/a),A=I/2,x=h.shapes.effectColors??["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"],_=h.colors.foreground??"#1a1a1a";return i.forEach((b,C)=>{const p=c[C],y=u[C];if(!p||p.x.length<2)return;const m=n-g/2+I/2+C*(I+N),T=b.color??x[C%x.length],E=b.fillOpacity??.5,D=Fn(p,A),W=[];for(let H=0;H<D.x.length;H++){const z=e+l(D.x[H]),X=m-D.y[H];W.push(H===0?`M ${z} ${X}`:`L ${z} ${X}`)}for(let H=D.x.length-1;H>=0;H--){const z=e+l(D.x[H]),X=m+D.y[H];W.push(`L ${z} ${X}`)}if(W.push("Z"),f.push(`<path
      d="${W.join(" ")}"
      fill="${T}" fill-opacity="${E}"
      stroke="${_}" stroke-width="0.5"/>`),r.showMedian!==!1&&y){const H=e+l(y.median);f.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-A*.6}" y2="${m+A*.6}"
        stroke="${_}" stroke-width="2"/>`)}if(r.showQuartiles&&y){const H=e+l(y.q1),z=e+l(y.q3);f.push(`<line
        x1="${H}" x2="${H}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`),f.push(`<line
        x1="${z}" x2="${z}"
        y1="${m-A*.4}" y2="${m+A*.4}"
        stroke="${_}" stroke-width="1" stroke-dasharray="2,2"/>`)}}),f.join(`
`)}function Zn(t,n,o){var h,f;const e=n.scale==="log",s=yt;let r=(h=n.axisRange)==null?void 0:h[0],l=(f=n.axisRange)==null?void 0:f[1];if(r==null||l==null){const i=[];for(const a of t)for(const c of n.effects){const u=a.metadata[c.value];u!=null&&!Number.isNaN(u)&&i.push(u)}i.length>0?(r=r??Math.min(0,...i),l=l??Math.max(...i)*1.1):(r=r??0,l=l??100)}return e?At([Math.max(.01,r),l],[s,o-s]):wt([r,l],[s,o-s])}function Jn(t,n,o){var h,f;const e=n.scale==="log",s=yt;let r=(h=n.axisRange)==null?void 0:h[0],l=(f=n.axisRange)==null?void 0:f[1];if(r==null||l==null){const i=[];for(const a of t)for(const c of n.effects)if(c.data){const u=a.metadata[c.data];if(u&&Array.isArray(u)){const d=en(u);i.push(d.min,d.max),n.showOutliers!==!1&&i.push(...d.outliers)}}else if(c.min&&c.max){const u=a.metadata[c.min],d=a.metadata[c.max];u!=null&&!Number.isNaN(u)&&i.push(u),d!=null&&!Number.isNaN(d)&&i.push(d)}if(i.length>0){const a=Math.min(...i),c=Math.max(...i),u=c-a;r=r??a-u*.05,l=l??c+u*.05}else r=r??0,l=l??100}return e?At([Math.max(.01,r),l],[s,o-s]):wt([r,l],[s,o-s])}function Qn(t,n,o){var h,f;const e=n.scale==="log",s=yt;let r=(h=n.axisRange)==null?void 0:h[0],l=(f=n.axisRange)==null?void 0:f[1];if(r==null||l==null){const i=[];for(const a of t)for(const c of n.effects){const u=a.metadata[c.data];u&&Array.isArray(u)&&i.push(...u.filter(d=>d!=null&&!Number.isNaN(d)))}if(i.length>0){r=r??Math.min(...i),l=l??Math.max(...i);const a=(l??0)-(r??0);r=(r??0)-a*.1,l=(l??0)+a*.1}else r=r??0,l=l??100}return e?At([Math.max(.01,r),l],[s,o-s]):wt([r,l],[s,o-s])}function qt(t,n,o,e,s,r,l){const h=[],f=nt(o.typography.fontSizeSm),i=Pt.EDGE_THRESHOLD,a=I=>I<i?"start":I>r-i?"end":"middle",c=I=>I<i?2:I>r-i?-2:0;h.push(`<line x1="${s}" x2="${s+r}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);const u=t.domain(),d=5,g=[],N=u[1]-u[0];for(let I=0;I<=d;I++)g.push(u[0]+N*I/d);for(const I of g){const A=t(I),x=s+A,_=a(A),b=c(A),C=Et(I);h.push(`<line x1="${x}" x2="${x}" y1="0" y2="4" stroke="${o.colors.border}" stroke-width="1"/>`),h.push(`<text x="${x+b}" y="14"
      text-anchor="${_}"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.foreground}">${C}</text>`)}return e&&h.push(`<text x="${s+r/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${f}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.foreground}">${J(e)}</text>`),h.join(`
`)}function to(t,n,o,e,s,r,l=1,h){const f=[],i=typeof o.axis.tickCount=="number"?o.axis.tickCount:Y.DEFAULT_TICK_COUNT,a=eo(t,i,o,l,r,h),c=nt(o.typography.fontSizeSm),u=Pt.EDGE_THRESHOLD,d=N=>N<u?"start":N>r-u?"end":"middle",g=N=>N<u?2:N>r-u?-2:0;f.push(`<line x1="${s}" x2="${s+r}"
    y1="0" y2="0" stroke="${o.colors.border}" stroke-width="1"/>`);for(const N of a){const I=t(N),A=s+I,x=d(I),_=g(I);f.push(`<line x1="${A}" x2="${A}" y1="0" y2="4"
      stroke="${o.colors.border}" stroke-width="1"/>`),f.push(`<text x="${A+_}" y="16" text-anchor="${x}"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightNormal}"
      fill="${o.colors.secondary}">${Ln(N)}</text>`)}return e&&f.push(`<text x="${s+r/2}" y="28"
      text-anchor="middle"
      font-family="${o.typography.fontFamily}"
      font-size="${c}px"
      font-weight="${o.typography.fontWeightMedium}"
      fill="${o.colors.secondary}">${J(e)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${f.join(`
`)}</g>`}function no(t,n,o,e,s,r,l,h,f,i){const a=[],c=nt(r.typography.fontSizeBase),u=r.typography.headerFontScale??1.05,d=Math.round(c*u*100)/100,g=r.typography.fontWeightBold,N=r.typography.fontWeightBold,I=kt(t),A=(x,_)=>x+_/2+d*rt.TEXT_BASELINE_ADJUSTMENT;if(I){const x=s/2,_=s/2;let b=o;a.push(`<text x="${b+Y.TEXT_PADDING}" y="${A(e,s)}"
      font-family="${r.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${r.colors.foreground}">${J(l)}</text>`),b+=h;const C=[];for(const p of t)if(p.isGroup){const y=p.columns.reduce((T,E)=>E.isGroup?T+E.columns.reduce((D,W)=>D+i(W),0):T+i(E),0),m=b+y/2;a.push(`<text x="${m}" y="${A(e,x)}"
          font-family="${r.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${N}"
          text-anchor="middle"
          fill="${r.colors.foreground}">${J(p.header)}</text>`),C.push({x1:b,x2:b+y}),b+=y}else{const y=i(p),m=p.headerAlign??p.align,{textX:T,anchor:E}=Ht(b,y,m),D=cn(p.header,y,d,Y.TEXT_PADDING);a.push(`<text x="${T}" y="${A(e,s)}"
          font-family="${r.typography.fontFamily}"
          font-size="${d}px"
          font-weight="${g}"
          text-anchor="${E}"
          fill="${r.colors.foreground}">${J(D)}</text>`),b+=y}for(const p of C)a.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${e+x}" y2="${e+x}"
        stroke="${r.colors.border}" stroke-width="1"/>`);b=o+h;for(const p of t)if(p.isGroup){for(const y of p.columns)if(!y.isGroup){const m=i(y),T=y.headerAlign??y.align,{textX:E,anchor:D}=Ht(b,m,T);a.push(`<text x="${E}" y="${A(e+x,_)}"
              font-family="${r.typography.fontFamily}"
              font-size="${d}px"
              font-weight="${g}"
              text-anchor="${D}"
              fill="${r.colors.foreground}">${J(y.header)}</text>`),b+=m}}else b+=i(p)}else{let x=o;a.push(`<text x="${x+Y.TEXT_PADDING}" y="${A(e,s)}"
      font-family="${r.typography.fontFamily}"
      font-size="${d}px"
      font-weight="${g}"
      fill="${r.colors.foreground}">${J(l)}</text>`),x+=h;for(const _ of n){const b=i(_),C=_.headerAlign??_.align,{textX:p,anchor:y}=Ht(x,b,C),m=cn(_.header,b,d,Y.TEXT_PADDING);a.push(`<text x="${p}" y="${A(e,s)}"
        font-family="${r.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${g}"
        text-anchor="${y}"
        fill="${r.colors.foreground}">${J(m)}</text>`),x+=b}}return a.join(`
`)}function oo(t,n,o,e,s,r,l,h,f,i,a,c){var _,b,C,p,y,m,T,E,D,W,H,z,X,O,$,v,w,k,M,L,B,G,U,V,q,Q,xt,ct,it;const u=[],d=nt(r.typography.fontSizeBase),g=e+s/2+d*rt.TEXT_BASELINE_ADJUSTMENT,N=h*Y.INDENT_PER_LEVEL+(((_=t.style)==null?void 0:_.indent)??0)*Y.INDENT_PER_LEVEL,I=(b=t.style)!=null&&b.bold||(C=t.style)!=null&&C.emphasis?r.typography.fontWeightBold:r.typography.fontWeightNormal,A=(p=t.style)!=null&&p.italic?"italic":"normal";let x=r.colors.foreground;if((y=t.style)!=null&&y.color?x=t.style.color:(m=t.style)!=null&&m.muted?x=r.colors.muted:(T=t.style)!=null&&T.accent&&(x=r.colors.accent),u.push(`<text x="${o+Y.TEXT_PADDING+N}" y="${g}"
    font-family="${r.typography.fontFamily}"
    font-size="${d}px"
    font-weight="${I}"
    font-style="${A}"
    fill="${x}">${J(t.label)}</text>`),(E=t.style)!=null&&E.badge){const st=String(t.style.badge),F=d*Mt.FONT_SCALE,K=F+Mt.PADDING*2,tt=at(t.label,d),ht=o+Y.TEXT_PADDING+N+tt+Mt.GAP,j=at(st,F)+Mt.PADDING*2,P=e+(s-K)/2;u.push(`<rect x="${ht}" y="${P}" width="${j}" height="${K}"
      rx="3" fill="${r.colors.primary}" opacity="0.15"/>`),u.push(`<text x="${ht+j/2}" y="${P+K/2+F*.35}"
      text-anchor="middle"
      font-family="${r.typography.fontFamily}"
      font-size="${F}px"
      font-weight="${r.typography.fontWeightBold}"
      fill="${r.colors.primary}">${J(st)}</text>`)}for(let st=0;st<n.length;st++){const F=n[st],K=c[st],tt=a(F);if(F.type==="forest"||F.type==="viz_bar"||F.type==="viz_boxplot"||F.type==="viz_violin")continue;const ht=Xn(t,F),{textX:S,anchor:j}=Ht(K,tt,F.align);if(F.type==="bar"&&typeof t.metadata[F.field]=="number"){const P=t.metadata[F.field],R=f.get(F.field),ot=((W=(D=F.options)==null?void 0:D.bar)==null?void 0:W.maxValue)??R??100,et=((z=(H=F.options)==null?void 0:H.bar)==null?void 0:z.color)??r.colors.primary,Z=r.shapes.pointSize*2,gt=tt-Y.TEXT_PADDING*2-50,lt=Math.min(P/ot*gt,gt),ut=t.style,mt=ut!=null&&ut.bold||ut!=null&&ut.emphasis?r.typography.fontWeightBold:r.typography.fontWeightNormal;u.push(`<rect x="${K+Y.TEXT_PADDING}" y="${e+s/2-Z/2}"
        width="${Math.max(0,lt)}" height="${Z}"
        fill="${et}" opacity="0.7" rx="2"/>`),u.push(`<text x="${K+tt-Y.TEXT_PADDING}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${mt}"
        text-anchor="end"
        fill="${r.colors.foreground}">${Et(P)}</text>`)}else if(F.type==="sparkline"&&Array.isArray(t.metadata[F.field])){let P=t.metadata[F.field];Array.isArray(P[0])&&(P=P[0]);const R=((O=(X=F.options)==null?void 0:X.sparkline)==null?void 0:O.height)??16,ot=((v=($=F.options)==null?void 0:$.sparkline)==null?void 0:v.color)??r.colors.primary,et=Y.TEXT_PADDING*2,Z=Un(P,K+Y.TEXT_PADDING,e+s/2-R/2,tt-et,R);u.push(`<path d="${Z}" fill="none" stroke="${ot}" stroke-width="1.5"/>`)}else if(F.type==="badge"){const P=t.metadata[F.field];if(P!=null){const R=String(P),ot=d*.85,et=ot+8,Z=(k=(w=F.options)==null?void 0:w.badge)==null?void 0:k.variants,pt=(L=(M=F.options)==null?void 0:M.badge)==null?void 0:L.colors;let gt=r.colors.primary,lt=r.colors.primary;if(pt&&R in pt)gt=pt[R],lt=pt[R];else if(Z&&R in Z){const Ot=Z[R];gt={default:r.colors.primary,...En,muted:r.colors.muted}[Ot]??r.colors.primary,lt=gt}const mt=at(R,ot)+12,It=F.align==="right"?K+tt-Y.TEXT_PADDING-mt:F.align==="center"?K+(tt-mt)/2:K+Y.TEXT_PADDING,Ft=e+(s-et)/2;u.push(`<rect x="${It}" y="${Ft}" width="${mt}" height="${et}"
          rx="${et/2}" fill="${gt}" opacity="0.15"/>`),u.push(`<text x="${It+mt/2}" y="${Ft+et/2+ot*.35}"
          text-anchor="middle"
          font-family="${r.typography.fontFamily}"
          font-size="${ot}px"
          font-weight="${r.typography.fontWeightBold}"
          fill="${lt}">${J(R)}</text>`)}}else if(F.type==="stars"){const P=t.metadata[F.field];if(typeof P=="number"){const R=((G=(B=F.options)==null?void 0:B.stars)==null?void 0:G.maxStars)??5,ot=((V=(U=F.options)==null?void 0:U.stars)==null?void 0:V.color)??"#f59e0b",et=((Q=(q=F.options)==null?void 0:q.stars)==null?void 0:Q.emptyColor)??"#d1d5db",Z=Math.max(0,Math.min(R,P)),pt=Math.floor(Z),gt=((ct=(xt=F.options)==null?void 0:xt.stars)==null?void 0:ct.halfStars)&&Z-pt>=.5,lt=12,ut=2,mt=R*lt+(R-1)*ut;let It=F.align==="right"?K+tt-Y.TEXT_PADDING-mt:F.align==="center"?K+(tt-mt)/2:K+Y.TEXT_PADDING;const Ft=e+(s-lt)/2,Ot=(bt,St,jt)=>{const vt=jt/2,Gt=vt*.4;let fn="";for(let _t=0;_t<5;_t++){const un=(_t*72-90)*Math.PI/180,dn=(_t*72+36-90)*Math.PI/180,hn=bt+vt*Math.cos(un),pn=St+vt*Math.sin(un),lo=bt+Gt*Math.cos(dn),co=St+Gt*Math.sin(dn);fn+=(_t===0?`M${hn},${pn}`:`L${hn},${pn}`)+`L${lo},${co}`}return fn+"Z"};for(let bt=0;bt<R;bt++){const St=It+lt/2,jt=Ft+lt/2,Gt=bt<pt||bt===pt&&gt?ot:et;u.push(`<path d="${Ot(St,jt,lt)}" fill="${Gt}"/>`),It+=lt+ut}}}else{const P=(it=t.cellStyles)==null?void 0:it[F.field],R=t.style;let ot=r.typography.fontWeightNormal;(P!=null&&P.bold||P!=null&&P.emphasis||R!=null&&R.bold||R!=null&&R.emphasis)&&(ot=r.typography.fontWeightBold);let et="normal";(P!=null&&P.italic||R!=null&&R.italic)&&(et="italic");let Z=r.colors.foreground;P!=null&&P.color?Z=P.color:P!=null&&P.muted?Z=r.colors.muted:P!=null&&P.accent?Z=r.colors.accent:R!=null&&R.color?Z=R.color:R!=null&&R.muted?Z=r.colors.muted:R!=null&&R.accent&&(Z=r.colors.accent),u.push(`<text x="${S}" y="${g}"
        font-family="${r.typography.fontFamily}"
        font-size="${d}px"
        font-weight="${ot}"
        font-style="${et}"
        text-anchor="${j}"
        fill="${Z}">${J(ht)}</text>`)}}return u.join(`
`)}function eo(t,n,o,e,s,r){if(Array.isArray(o.axis.tickValues)&&o.axis.tickValues.length>0){const[y,m]=t.domain();let T=o.axis.tickValues.filter(W=>W>=y&&W<=m);const E=o.axis.nullTick!==!1,D=e>=y&&e<=m;return E&&D&&!T.includes(e)&&(T=[...T,e].sort((W,H)=>W-H)),T}const[l,h]=t.domain(),f=o.axis.nullTick!==!1,i=e>=l&&e<=h,a=Pt.MIN_TICK_SPACING,c=Math.max(2,Math.floor(s/a)),u=Math.min(n,Math.min(7,c)),d=r&&r.length>0?r.filter(y=>y>=l&&y<=h):t.ticks(u);if(d.length===0)return f&&i?[e]:[];const g=t(e),N=d.filter(y=>y<e).reverse(),I=d.filter(y=>y>e),A=d.some(y=>y===e),x=[];let _=g;for(const y of N){const m=t(y);_-m>=a&&(x.unshift(y),_=m)}const b=[];let C=g;for(const y of I){const m=t(y);m-C>=a&&(b.push(y),C=m)}const p=[...x];if((A||f&&i)&&p.push(e),p.push(...b),p.length<2){const y=new Set(p);y.has(l)||p.unshift(l),p.length<2&&!y.has(h)&&p.push(h)}return p}function Yt(t,n,o,e,s,r,l,h=1,f=.6){let a=`<line x1="${t}" x2="${t}" y1="${n}" y2="${o}"
    stroke="${s}" stroke-width="${h}" stroke-opacity="${f}" stroke-dasharray="${e==="dashed"?"6,4":e==="dotted"?"2,2":"none"}"/>`;if(l){const c=r.colors.secondary;a+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-family="${r.typography.fontFamily}"
      font-size="${r.typography.fontSizeSm}"
      font-weight="${r.typography.fontWeightMedium}"
      fill="${c}">${J(l)}</text>`}return a}class Nt extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function ro(t){if(!t||typeof t!="object")throw new Nt("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new Nt("Invalid spec: missing or invalid 'data' property");const o=n.data;if(!Array.isArray(o.rows))throw new Nt("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new Nt("Invalid spec: missing or invalid 'theme' property");const e=n.theme;if(!e.colors||typeof e.colors!="object")throw new Nt("Invalid spec: missing or invalid 'theme.colors'");if(!e.typography||typeof e.typography!="object")throw new Nt("Invalid spec: missing or invalid 'theme.typography'");if(!e.spacing||typeof e.spacing!="object")throw new Nt("Invalid spec: missing or invalid 'theme.spacing'")}function ao(t){var r;const o=Ut(t.columns,void 0).find(l=>l.type==="forest");if(!o||!((r=o.options)!=null&&r.forest))return{scale:"linear",nullValue:0,effects:[],axisLabel:"Effect",pointCol:null,lowerCol:null,upperCol:null};const e=o.options.forest,s=e.scale??"linear";return{scale:s,nullValue:e.nullValue??(s==="log"?1:0),effects:e.effects??[],axisLabel:e.axisLabel??"Effect",pointCol:e.point??null,lowerCol:e.lower??null,upperCol:e.upper??null}}function io(t,n={}){var E,D,W,H,z,X,O;ro(t);const o=t.theme,e=o.spacing.padding,s=Array.isArray(t.columns)?t.columns:[],r=Xt(s),l=[];for(let $=0;$<r.length;$++)r[$].type==="forest"&&l.push($);l.length>0;const h=[];for(let $=0;$<r.length;$++){const v=r[$];(v.type==="viz_bar"||v.type==="viz_boxplot"||v.type==="viz_violin")&&h.push({index:$,type:v.type,column:v})}const f=ao(t),i=Gn(t,n,f.nullValue),a=i.autoWidths,c=$=>{var w,k,M,L,B,G,U,V;if($.type==="forest"){const q=a.get($.id);return q!==void 0?q:typeof $.width=="number"?$.width:((k=(w=$.options)==null?void 0:w.forest)==null?void 0:k.width)??i.forestWidth}if($.type==="viz_bar"){const q=a.get($.id);return q!==void 0?q:typeof $.width=="number"?$.width:((L=(M=$.options)==null?void 0:M.vizBar)==null?void 0:L.width)??i.forestWidth}if($.type==="viz_boxplot"){const q=a.get($.id);return q!==void 0?q:typeof $.width=="number"?$.width:((G=(B=$.options)==null?void 0:B.vizBoxplot)==null?void 0:G.width)??i.forestWidth}if($.type==="viz_violin"){const q=a.get($.id);return q!==void 0?q:typeof $.width=="number"?$.width:((V=(U=$.options)==null?void 0:U.vizViolin)==null?void 0:V.width)??i.forestWidth}const v=a.get($.id);return v!==void 0?v:typeof $.width=="number"?$.width:$t.DEFAULT_COLUMN_WIDTH},u=[];let d=e+i.labelWidth;for(const $ of r)u.push(d),d+=c($);const g=[];g.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${i.totalWidth}" height="${i.totalHeight}"
  viewBox="0 0 ${i.totalWidth} ${i.totalHeight}">
<style>
  text { font-variant-numeric: tabular-nums; }
</style>`);const N=n.backgroundColor??o.colors.background;if(g.push(`<rect width="100%" height="100%" fill="${N}"/>`),o.layout.containerBorder!==!1){const $=o.layout.containerBorderRadius??8;g.push(`<rect x="0.5" y="0.5"
      width="${i.totalWidth-1}" height="${i.totalHeight-1}"
      fill="none" stroke="${o.colors.border}" stroke-width="1"
      rx="${$}" ry="${$}"/>`)}g.push(Rn(t,i,o)),(!!((E=t.labels)!=null&&E.title)||!!((D=t.labels)!=null&&D.subtitle))&&g.push(`<line x1="${e}" x2="${i.totalWidth-e}"
      y1="${i.mainY}" y2="${i.mainY}"
      stroke="${o.colors.border}" stroke-width="2"/>`);const A=i.mainY;g.push(no(s,r,e,A,i.headerHeight,o,t.data.labelHeader??"Study",i.labelWidth,a,c)),g.push(`<line x1="${e}" x2="${i.totalWidth-e}"
    y1="${A+i.headerHeight}" y2="${A+i.headerHeight}"
    stroke="${o.colors.border}" stroke-width="2"/>`);const x=sn(t),_=[],b=[];let C=0;for(const $ of x){const w=$.type==="data"&&((W=$.row.style)==null?void 0:W.type)==="spacer"?i.rowHeight/2:i.rowHeight;_.push(C),b.push(w),C+=w}const p=i.mainY+i.headerHeight;x.forEach(($,v)=>{var w,k,M,L;if($.type==="data"){const B=$.row,G=p+_[v],U=b[v];if((w=B.style)!=null&&w.bg)g.push(`<rect x="${e}" y="${G}"
          width="${i.totalWidth-e*2}" height="${U}"
          fill="${B.style.bg}"/>`);else if(((k=B.style)==null?void 0:k.type)==="header")g.push(`<rect x="${e}" y="${G}"
          width="${i.totalWidth-e*2}" height="${U}"
          fill="${o.colors.muted}" fill-opacity="0.1"/>`);else if(o.layout.banding&&!(((M=B.style)==null?void 0:M.type)==="summary"||((L=B.style)==null?void 0:L.type)==="spacer")){const Q=v%2===1?o.colors.altBg:o.colors.rowBg;Q!==o.colors.background&&g.push(`<rect x="${e}" y="${G}"
              width="${i.totalWidth-e*2}" height="${U}"
              fill="${Q}"/>`)}}});for(const $ of l){const v=r[$],w=u[$],k=c(v),M=(H=v.options)==null?void 0:H.forest,L=(M==null?void 0:M.scale)??"linear",B=(M==null?void 0:M.nullValue)??(L==="log"?1:0),G=(M==null?void 0:M.axisLabel)??"Effect",U=L==="log";let V=(M==null?void 0:M.effects)??[];const q=(M==null?void 0:M.point)??null,Q=(M==null?void 0:M.lower)??null,xt=(M==null?void 0:M.upper)??null;V.length===0&&(q||Q||xt)&&(V=[{pointCol:q,lowerCol:Q,upperCol:xt}]);const ct={scale:L,nullValue:B,effects:V,pointCol:(M==null?void 0:M.point)??null,lowerCol:(M==null?void 0:M.lower)??null,upperCol:(M==null?void 0:M.upper)??null},{scale:it,clipBounds:st,ticks:F}=Pn(t,k,ct,n),K=w+it(B);g.push(Yt(K,p,p+i.plotHeight,"dashed",o.colors.muted,o));const tt=(M==null?void 0:M.annotations)??[];for(const S of tt)if(S.type==="reference_line"){const j=w+it(S.x);g.push(Yt(j,p,p+i.plotHeight,S.style,S.color??o.colors.accent,o,S.label,S.width??1,S.opacity??.6))}const ht=Array.isArray(t.annotations)?t.annotations:[];for(const S of ht)if(S.type==="reference_line"){const j=w+it(S.x);g.push(Yt(j,p,p+i.plotHeight,S.style,S.color??o.colors.accent,o,S.label,S.width??1,S.opacity??.6))}if(x.forEach((S,j)=>{if(S.type==="data"){const P=p+_[j]+b[j]/2;g.push(qn(S.row,P,R=>w+it(R),o,B,V,t.data.weightCol,w,k,st,U))}}),t.data.overall&&i.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const S=p+i.summaryYPosition;g.push(Yn(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,S,it,w,k,o))}g.push(to(it,i,o,G,w,k,B,F))}const y=t.data.rows;for(const $ of h){const v=$.column,w=u[$.index],k=c(v);if($.type==="viz_bar"){const M=(z=v.options)==null?void 0:z.vizBar;if(!M)continue;const L=Zn(y,M,k);x.forEach((B,G)=>{if(B.type==="data"){const U=p+_[G]+b[G]/2,V=b[G];g.push(On(B.row,U,V,w,k,M,L,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+i.plotHeight})">`),g.push(qt(L,i,o,M.axisLabel,w,k,M.nullValue)),g.push("</g>"))}else if($.type==="viz_boxplot"){const M=(X=v.options)==null?void 0:X.vizBoxplot;if(!M)continue;const L=Jn(y,M,k);x.forEach((B,G)=>{if(B.type==="data"){const U=p+_[G]+b[G]/2,V=b[G];g.push(jn(B.row,U,V,w,k,M,L,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+i.plotHeight})">`),g.push(qt(L,i,o,M.axisLabel,w,k,M.nullValue)),g.push("</g>"))}else if($.type==="viz_violin"){const M=(O=v.options)==null?void 0:O.vizViolin;if(!M)continue;const L=Qn(y,M,k);x.forEach((B,G)=>{if(B.type==="data"){const U=p+_[G]+b[G]/2,V=b[G];g.push(Kn(B.row,U,V,w,k,M,L,o))}}),M.showAxis!==!1&&(g.push(`<g transform="translate(0, ${p+i.plotHeight})">`),g.push(qt(L,i,o,M.axisLabel,w,k,M.nullValue)),g.push("</g>"))}}const m=i.mainY+i.headerHeight,T=Vn(y,r);return x.forEach(($,v)=>{var M,L,B;const w=m+_[v],k=b[v];if($.type==="group_header")g.push(zn($.label,$.depth,$.rowCount,e,w,k,i.totalWidth-e*2,o));else{const G=$.row,U=$.depth;((M=G.style)==null?void 0:M.type)==="spacer"||g.push(oo(G,r,e,w,k,o,i.labelWidth,U,T,a,c,u))}if($.type==="data"){const G=$.row,U=((L=G.style)==null?void 0:L.type)==="summary",V=((B=G.style)==null?void 0:B.type)==="spacer";U&&g.push(`<line x1="${e}" x2="${i.totalWidth-e}"
          y1="${w}" y2="${w}"
          stroke="${o.colors.border}" stroke-width="2"/>`),V||g.push(`<line x1="${e}" x2="${i.totalWidth-e}"
          y1="${w+k}" y2="${w+k}"
          stroke="${o.colors.border}" stroke-width="1"/>`)}else g.push(`<line x1="${e}" x2="${i.totalWidth-e}"
        y1="${w+k}" y2="${w+k}"
        stroke="${o.colors.border}" stroke-width="1"/>`)}),g.push(Bn(t,i,o)),g.push("</svg>"),g.join(`
`)}function so(t,n){const o=JSON.parse(t);return io(o,n)}globalThis.generateSVG=so})();
