(function(){"use strict";const mt=[1,5,2,2.5,4,3],Z=[.001,.002,.005,.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,300,500,750,1e3];function rt(t,n){return n?Ft(t):Ht(t)}function Ft(t){if(t[0]<=0||t[1]<=0)return[.1,10];if(t[0]>=t[1])return t;let n=Z[0];for(const o of Z)if(o<=t[0])n=o;else break;t[0]<Z[0]&&(n=Math.pow(10,Math.floor(Math.log10(t[0]))));let e=Z[Z.length-1];for(let o=Z.length-1;o>=0&&Z[o]>=t[1];o--)e=Z[o];return t[1]>Z[Z.length-1]&&(e=Math.pow(10,Math.ceil(Math.log10(t[1])))),[n,e]}function Ht(t){const n=t[1]-t[0];if(n===0)return t;if(n<0)return[t[1],t[0]];const e=Math.pow(10,Math.floor(Math.log10(n)));let o=e,a=1/0;for(const h of mt)for(const f of[.1,1,10]){const i=h*e*f;if(i<=0)continue;const l=Math.floor(t[0]/i)*i,d=(Math.ceil(t[1]/i)*i-l)/n-1;d>=0&&d<a&&(a=d,o=i)}const r=Math.floor(t[0]/o)*o,s=Math.ceil(t[1]/o)*o;return[Math.round(r*1e10)/1e10,Math.round(s*1e10)/1e10]}function K(t,n,e,o,a=!1){if(t&&e in t){const r=t[e];if(typeof r=="number"&&Number.isFinite(r)&&(!a||r>0))return r}return e===o&&n!=null&&Number.isFinite(n)&&(!a||n>0)?n:null}const Ct=20;function Gt(t){const{rows:n,config:e,scale:o,nullValue:a,forestWidth:r,pointSize:s,effects:h=[],pointCol:f,lowerCol:i,upperCol:l}=t,c=kt(n,e,o,a,h,f,i,l),u=vt(c,e,o,r,s),d=yt(c,e,o,a);return{axisLimits:c,plotRegion:u,ticks:d}}function kt(t,n,e,o,a=[],r,s,h){const f=n.rangeMin!=null,i=n.rangeMax!=null;if(f&&i)return[n.rangeMin,n.rangeMax];const l=[],c=e==="log",u=r||"point";for(const M of t){const G=K(M.metadata,void 0,u,"point",c);G!=null&&l.push(G);for(const R of a){const k=K(M.metadata,void 0,R.pointCol,"point",c);k!=null&&l.push(k)}}if(l.length===0)return e==="log"?[.1,10]:[-1,1];let d=Math.min(...l),g=Math.max(...l);(n.includeNull??!0)&&(d=Math.min(d,o),g=Math.max(g,o));const S=d,A=g;let b;if(c){const M=Math.max(d,.001),G=Math.max(g,.001);b=Math.log(G)-Math.log(M)}else b=g-d;if(b===0||!Number.isFinite(b)){const M=l[0];if(c)return rt([M/2,M*2],!0);{const G=Math.max(1,Math.abs(M)*.1);return rt([M-G,M+G],!1)}}const[F,N]=rt([d,g],c),L=n.ciClipFactor??2;let m=F,y=N;const p=[],$=[],x=s||"lower",E=h||"upper";for(const M of t){const G=K(M.metadata,void 0,x,"lower",c);G!=null&&p.push(G);const R=K(M.metadata,void 0,E,"upper",c);R!=null&&$.push(R);for(const k of a){const C=K(M.metadata,void 0,k.lowerCol,"lower",c);C!=null&&p.push(C);const v=K(M.metadata,void 0,k.upperCol,"upper",c);v!=null&&$.push(v)}}let _,H;if(c)_=m/L,H=y*L;else{const M=y-m;_=m-M*L,H=y+M*L}let B=!1,D=!1;for(const M of p)M>=_?m=Math.min(m,M):B=!0;for(const M of $)M<=H?y=Math.max(y,M):D=!0;if(B&&(m=Math.min(m,_)),D&&(y=Math.max(y,H)),n.symmetric===!0&&!f&&!i)if(e==="log"){const M=Math.log(o),G=Math.max(Math.abs(Math.log(Math.max(S,.001))-M),Math.abs(Math.log(A)-M));m=Math.exp(M-G),y=Math.exp(M+G)}else{const M=Math.max(Math.abs(S-o),Math.abs(A-o));m=o-M,y=o+M}let W=f?n.rangeMin:m,w=i?n.rangeMax:y;return rt([W,w],e==="log")}function vt(t,n,e,o,a){if(!(n.markerMargin??!0)||o<=0)return t;const s=o-2*Ct;if(s<=0)return t;if(e==="log"){const i=Math.log(Math.max(t[0],.001)),l=Math.log(Math.max(t[1],.001)),c=l-i,u=a/2*(c/s),d=Math.min(u,.5);return[Math.exp(i-d),Math.exp(l+d)]}const h=t[1]-t[0],f=a/2*(h/s);return[t[0]-f,t[1]+f]}function yt(t,n,e,o){const[a,r]=t,s=o>=a&&o<=r,h=(n.nullTick??!0)&&s;if(n.tickValues&&n.tickValues.length>0){let l=n.tickValues.filter(c=>c>=a&&c<=r);return h&&!l.includes(o)&&(l=[...l,o].sort((c,u)=>c-u)),l}const f=n.tickCount??5;let i=e==="log"?Rt(t,f):Pt(t,f);return h&&!i.includes(o)&&(i=[...i,o].sort((l,c)=>l-c)),i}function Pt(t,n){const[e,o]=t,a=o-e;if(a===0)return[e];const r=a/Math.max(n-1,1),s=Math.pow(10,Math.floor(Math.log10(r)));let h=s,f=1/0;for(const c of mt){const u=c*s,d=Math.floor(a/u)+1,g=Math.abs(d-n);g<f&&(f=g,h=u);const T=c*s/10;if(T>0){const S=Math.floor(a/T)+1,A=Math.abs(S-n);A<f&&(f=A,h=T)}}const i=Math.ceil(e/h)*h,l=[];for(let c=i;c<=o+h*.001;c+=h){const u=Math.round(c*1e10)/1e10;u>=e&&u<=o&&l.push(u)}return l.length<2&&(l.includes(e)||l.unshift(e),l.includes(o)||l.push(o)),l}function Rt(t,n){const[e,o]=t,r=[.01,.02,.05,.1,.15,.2,.25,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.75,2,2.5,3,4,5,6,7,8,10,12,15,20,25,30,40,50,75,100,150,200,500,1e3].filter(f=>f>=e&&f<=o);if(r.length<=n)return r;const s=[1,.1,10,100,.5,2,5,.2,.25,1.5,3,4,20,50],h=[];for(const f of s)r.includes(f)&&h.length<n&&h.push(f);if(h.length<n){const f=r.filter(l=>!h.includes(l)),i=Math.max(1,Math.floor(f.length/(n-h.length)));for(let l=0;l<f.length&&h.length<n;l+=i)h.push(f[l])}return h.sort((f,i)=>f-i)}function Bt(t){var o,a;const n=((o=t==null?void 0:t.shapes)==null?void 0:o.lineWidth)??1.5,e=((a=t==null?void 0:t.colors)==null?void 0:a.intervalLine)??"#475569";return{width:Math.max(4,Math.round(n*3)),height:Math.max(6,Math.round(n*4)),color:e,opacity:1}}function $t(t,n,e,o){const{width:a,height:r}=o,s=r/2;return t==="left"?`M ${n} ${e} L ${n+a} ${e-s} L ${n+a} ${e+s} Z`:`M ${n} ${e} L ${n-a} ${e-s} L ${n-a} ${e+s} Z`}const ut={RENDERING_BUFFER:4},Q={FONT_SCALE:.8,PADDING:4,GAP:6},O={DEFAULT_LABEL_WIDTH:200,DEFAULT_COLUMN_WIDTH:100,AXIS_HEIGHT:32,AXIS_LABEL_HEIGHT:20,BOTTOM_MARGIN:16,MIN_FOREST_WIDTH:200,DEFAULT_WIDTH:800,COLUMN_GAP:16},j={TITLE_HEIGHT:28,SUBTITLE_HEIGHT:20,CAPTION_HEIGHT:16,FOOTNOTE_HEIGHT:14,DEFAULT_FONT_SIZE:14,REM_BASE:16,TEXT_BASELINE_ADJUSTMENT:1/3},P={INDENT_PER_LEVEL:12,TEXT_PADDING:10,DEFAULT_TICK_COUNT:5,AXIS_LABEL_PADDING:30},xt={GROUP_HEADER_HEIGHT_MULTIPLIER:1.3,OVERALL_ROW_HEIGHT_MULTIPLIER:1.5},nt={MIN:60,MAX:600,LABEL_MAX:400,VISUAL_MIN:{sparkline:92,bar:100,stars:84,range:84,badge:74}},it={CHEVRON_WIDTH:12,GAP:6,SAFETY_MARGIN:8},Mt={SPACING:6};function Ut(t,n){return n<=1?0:-((n-1)*Mt.SPACING)/2+t*Mt.SPACING}function at(t,n){const e=t.split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,n),e.join(".")}function ft(t){const n=Math.abs(t),e=t<0?"-":"";if(n>=1e12)throw new Error(`Cannot abbreviate value >= 1 trillion: ${t}`);if(n>=1e9){const o=n/1e9;return e+dt(o)+"B"}if(n>=1e6){const o=n/1e6;return e+dt(o)+"M"}if(n>=1e3){const o=n/1e3;return e+dt(o)+"K"}return e+Math.round(n).toString()}function dt(t){const n=Math.round(t*10)/10;return n===Math.floor(n)?n.toFixed(0):n.toFixed(1)}const Xt={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","-":"⁻","+":"⁺"};function Ot(t){return t.split("").map(n=>Xt[n]??n).join("")}function st(t,n){var h,f,i,l,c;if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";if(n!=null&&n.percent){const{decimals:u,digits:d,multiply:g=!0,symbol:T=!0}=n.percent,S=g?t*100:t,A=d!=null?S.toPrecision(d):S.toFixed(u??1);return T?`${A}%`:A}if(((h=n==null?void 0:n.numeric)==null?void 0:h.abbreviate)&&Math.abs(t)>=1e3)return ft(t);const o=(f=n==null?void 0:n.numeric)==null?void 0:f.digits;if(o!=null){const u=t.toPrecision(o),d=(i=n==null?void 0:n.numeric)==null?void 0:i.thousandsSep;return d&&typeof d=="string"?at(u,d):u}const a=(l=n==null?void 0:n.numeric)==null?void 0:l.decimals,r=(c=n==null?void 0:n.numeric)==null?void 0:c.thousandsSep;let s;return a!==void 0?s=t.toFixed(a):Number.isInteger(t)||Math.abs(t-Math.round(t))<1e-4?s=Math.round(t).toString():s=t.toFixed(2),r&&typeof r=="string"&&(s=at(s,r)),s}function bt(t,n){const{eventsField:e,nField:o,separator:a="/",showPct:r=!1,thousandsSep:s,abbreviate:h}=n.events,f=t.metadata[e],i=t.metadata[o];if(f==null||i===void 0||i===null)return n.naText??"";const l=Number(f),c=Number(i);let u,d;h&&(l>=1e3||c>=1e3)?(u=l>=1e3?ft(l):String(l),d=c>=1e3?ft(c):String(c)):(u=String(l),d=String(c),s&&typeof s=="string"&&(u=at(u,s),d=at(d,s)));let g=`${u}${a}${d}`;if(r&&c>0){const T=(l/c*100).toFixed(1);g+=` (${T}%)`}return g}function Tt(t,n,e,o){var h,f,i;if(t==null||Number.isNaN(t))return"";const a=((h=o==null?void 0:o.interval)==null?void 0:h.decimals)??2,r=((f=o==null?void 0:o.interval)==null?void 0:f.sep)??" ",s=(i=o==null?void 0:o.interval)==null?void 0:i.impreciseThreshold;return n==null||e===void 0||e===null||Number.isNaN(n)||Number.isNaN(e)?t.toFixed(a):s!=null&&n>0&&e/n>s?"—":`${t.toFixed(a)}${r}(${n.toFixed(a)}, ${e.toFixed(a)})`}function Et(t,n){if(t==null||Number.isNaN(t))return(n==null?void 0:n.naText)??"";const e=n==null?void 0:n.pvalue,o=(e==null?void 0:e.digits)??2,a=(e==null?void 0:e.expThreshold)??.001,r=(e==null?void 0:e.abbrevThreshold)??null,s=(e==null?void 0:e.format)??"auto",h=(e==null?void 0:e.stars)??!1,f=(e==null?void 0:e.thresholds)??[.05,.01,.001];let i="";if(h&&(t<f[2]?i="***":t<f[1]?i="**":t<f[0]&&(i="*")),r!==null&&t<r)return`<${r}${i}`;if(s==="scientific"||s==="auto"&&t<a){const c=Math.floor(Math.log10(t));return`${(t/Math.pow(10,c)).toPrecision(o)}×10${Ot(c.toString())}${i}`}let l;return t>=.1?l=t.toFixed(o):t>=.01?l=t.toFixed(o+1):l=t.toFixed(o+2),`${l}${i}`}function zt(t,n){var r,s,h,f;const{type:e,field:o,options:a}=n;switch(e){case"interval":{const i=(r=a==null?void 0:a.interval)!=null&&r.point?t.metadata[a.interval.point]:t.point,l=(s=a==null?void 0:a.interval)!=null&&s.lower?t.metadata[a.interval.lower]:t.lower,c=(h=a==null?void 0:a.interval)!=null&&h.upper?t.metadata[a.interval.upper]:t.upper;return Tt(i,l,c,a)}case"custom":return a!=null&&a.events?bt(t,a):String(t.metadata[o]??"");case"pvalue":return Et(t.metadata[o],a);case"numeric":return st(t.metadata[o],a);case"percent":return st(t.metadata[o],a);case"sparkline":case"icon":case"stars":case"img":case"range":return"";case"badge":{const i=t.metadata[o];return i==null?"":`  ${String(i)}  `}case"bar":{if(((f=a==null?void 0:a.bar)==null?void 0:f.showLabel)===!1)return"";const i=t.metadata[o];return i==null?"":i>=100?i.toFixed(0):i>=10?i.toFixed(1):i.toFixed(2)}case"text":default:return String(t.metadata[o]??"")}}function Y(t,n){const e="⁰¹²³⁴⁵⁶⁷⁸⁹⁺⁻";let o=0;for(const a of t)e.includes(a)?o+=n*.3:"il1.,;:|!()[]{}' ".includes(a)?o+=n*.35:"×−".includes(a)?o+=n*.5:"mwMW@%".includes(a)?o+=n*.85:a>="0"&&a<="9"?o+=n*.6:o+=n*.55;return o}function Vt(t,n){var i,l;const e=new Map,o=J(t.theme.typography.fontSizeBase),a=t.theme.typography.headerFontScale??1.05,r=o*a,s=t.data.rows,h=(t.theme.spacing.cellPaddingX??10)*2,f=(t.theme.spacing.groupPadding??8)*2;for(const c of n){if(c.width!=="auto"&&c.width!==null&&c.width!==void 0)continue;let u=0;c.header&&(u=Math.max(u,Y(c.header,r)));for(const T of s){if(((i=T.style)==null?void 0:i.type)==="header"||((l=T.style)==null?void 0:l.type)==="spacer")continue;const S=zt(T,c);S&&(u=Math.max(u,Y(S,o)))}const d=nt.VISUAL_MIN[c.type]??nt.MIN,g=Math.ceil(u+h+ut.RENDERING_BUFFER);e.set(c.id,Math.min(nt.MAX,Math.max(d,g)))}return jt(t.columns,e,r,f,ut.RENDERING_BUFFER),e}function jt(t,n,e,o,a){function r(f){return f.isGroup?f.columns.flatMap(r):[f]}function s(f){const i=n.get(f.id);return i!==void 0?i:typeof f.width=="number"?f.width:nt.MIN}function h(f){if(f.isGroup){for(const i of f.columns)h(i);if(f.header){const i=Y(f.header,e)+o+a,l=r(f),c=l.reduce((u,d)=>u+s(d),0);if(i>c&&l.length>0){const u=Math.ceil((i-c)/l.length);for(const d of l)n.set(d.id,s(d)+u)}}}}for(const f of t)h(f)}function It(t){var f,i;const n=J(t.theme.typography.fontSizeBase),e=(t.theme.spacing.cellPaddingX??10)*2;let o=0;const a=new Map,r=Array.isArray(t.data.groups)?t.data.groups:[];for(const l of r)a.set(l.id,l.depth);const s=l=>l?(a.get(l)??0)+1:0;t.data.labelHeader&&(o=Math.max(o,Y(t.data.labelHeader,n)));for(const l of t.data.rows)if(l.label){const c=s(l.groupId),u=((f=l.style)==null?void 0:f.indent)??0,g=(c+u)*P.INDENT_PER_LEVEL;let T=Y(l.label,n)+g;if((i=l.style)!=null&&i.badge){const S=String(l.style.badge),A=n*Q.FONT_SCALE,F=Y(S,A)+Q.PADDING*2;T+=Q.GAP+F}o=Math.max(o,T)}for(const l of r)if(l.label){const c=l.depth*P.INDENT_PER_LEVEL,u=Y(l.label,n),g=`(${countAllDescendantRows(l.id)})`,T=n*.75,S=Y(g,T),A=c+it.CHEVRON_WIDTH+it.GAP+u+it.GAP+S+it.SAFETY_MARGIN;o=Math.max(o,A)}const h=Math.ceil(o+e+ut.RENDERING_BUFFER);return Math.min(nt.LABEL_MAX,Math.max(nt.MIN,h))}function ht(t,n){const e=n.get(t.id);return e!==void 0?e:typeof t.width=="number"?t.width:O.DEFAULT_COLUMN_WIDTH}function Yt(t,n,e=0){var k,C,v,X,q;const o=t.theme,a=o.spacing.rowHeight,r=o.spacing.padding,s=Array.isArray(t.columns)?t.columns:[],h=lt(s,"left"),f=lt(s,"right"),l=pt(h)||pt(f)?o.spacing.headerHeight*xt.GROUP_HEADER_HEIGHT_MULTIPLIER:o.spacing.headerHeight,c=!!((k=t.labels)!=null&&k.title),u=!!((C=t.labels)!=null&&C.subtitle),d=!!((v=t.labels)!=null&&v.caption),g=!!((X=t.labels)!=null&&X.footnote),T=c?j.TITLE_HEIGHT:0,S=u?j.SUBTITLE_HEIGHT:0,A=T+S+(c||u?r:0),b=d?j.CAPTION_HEIGHT:0,F=g?j.FOOTNOTE_HEIGHT:0,N=b+F+(d||g?r:0),L=At(t),m=!!t.data.overall;let y=0;for(const U of L){const z=U.type==="data"&&((q=U.row.style)==null?void 0:q.type)==="spacer";y+=z?a/2:a}m&&(y+=a*xt.OVERALL_ROW_HEIGHT_MULTIPLIER);const p=ot(s,"left"),$=ot(s,"right"),x=[...p,...$];let E,_;if(n.columnWidths){E=new Map;for(const[U,z]of Object.entries(n.columnWidths))U!=="__label__"&&E.set(U,z);_=n.columnWidths.__label__??It(t)}else E=Vt(t,x),_=It(t);const H=_+p.reduce((U,z)=>U+ht(z,E),0),B=$.reduce((U,z)=>U+ht(z,E),0),D=n.width??O.DEFAULT_WIDTH,I=t.data.includeForest,W=H+B;let w;if(!I)w=0;else if(typeof n.forestWidth=="number")w=n.forestWidth;else if(typeof t.layout.plotWidth=="number")w=t.layout.plotWidth;else{const U=D-W-O.COLUMN_GAP*2-r*2;w=Math.max(U,O.MIN_FOREST_WIDTH)}const M=r*2+W+w+O.COLUMN_GAP*2,G=Math.max(n.width??D,M),R=A+r+l+y+O.AXIS_HEIGHT+O.AXIS_LABEL_HEIGHT+N+O.BOTTOM_MARGIN;return{totalWidth:G,totalHeight:n.height??R,tableWidth:H+B,forestWidth:w,headerHeight:l,rowHeight:a,plotHeight:y,axisHeight:O.AXIS_HEIGHT,nullValue:e,summaryYPosition:y-a,showOverallSummary:m,headerTextHeight:A,footerTextHeight:N,titleY:r+j.TITLE_HEIGHT-8,subtitleY:r+T+j.SUBTITLE_HEIGHT-4,mainY:A+r,footerY:A+r+l+y+O.AXIS_HEIGHT+O.AXIS_LABEL_HEIGHT+r,autoWidths:E,labelWidth:_}}function At(t){var c;const n=t.data.rows,e=Array.isArray(t.data.groups)?t.data.groups:[];if(e.length===0)return n.map(u=>({type:"data",row:u,depth:0}));const o=new Map;for(const u of e)o.set(u.id,u);const a=new Map;for(const u of n){const d=u.groupId??null;a.has(d)||a.set(d,[]),a.get(d).push(u)}const r=new Set;for(const u of a.keys()){if(!u)continue;let d=u;for(;d;)r.add(d),d=(c=o.get(d))==null?void 0:c.parentId}function s(u){return e.filter(d=>(d.parentId??null)===u&&r.has(d.id))}function h(u){if(!u)return 0;const d=o.get(u);return d?d.depth+1:0}function f(u){var g;let d=((g=a.get(u))==null?void 0:g.length)??0;for(const T of s(u))d+=f(T.id);return d}const i=[];function l(u){if(u){const g=o.get(u);if(!g)return;const T=f(u);i.push({type:"group_header",groupId:g.id,label:g.label,depth:g.depth,rowCount:T})}for(const g of s(u))l(g.id);const d=a.get(u)??[];for(const g of d)i.push({type:"data",row:g,depth:h(g.groupId)})}return l(null),i}function Nt(t){const n=[];for(const e of t)e.isGroup?n.push(...Nt(e.columns)):n.push(e);return n}function ot(t,n){const e=[];for(const o of t)o.position===n&&(o.isGroup?e.push(...Nt(o.columns)):e.push(o));return e}function lt(t,n){return t.filter(e=>e.position===n)}function pt(t){return t.some(n=>n.isGroup)}function J(t){return t.endsWith("rem")?parseFloat(t)*j.REM_BASE:t.endsWith("px")?parseFloat(t):j.DEFAULT_FONT_SIZE}function ct(t,n,e){return e==="right"?{textX:t+n-P.TEXT_PADDING,anchor:"end"}:e==="center"?{textX:t+n/2,anchor:"middle"}:{textX:t+P.TEXT_PADDING,anchor:"start"}}function V(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function gt(t,n,e,o=0){const a=n-o*2;if(Y(t,e)<=a)return t;const s="…",h=e*.55;let f=0,i=t.length;for(;f<i;){const l=Math.ceil((f+i)/2),c=t.slice(0,l);Y(c,e)+h<=a?f=l:i=l-1}return f===0?s:t.slice(0,f)+s}function Jt(t){return Math.abs(t)<.01?"0":Math.abs(t)>=100?t.toFixed(0):Math.abs(t)>=10?t.toFixed(1):t.toFixed(2)}function _t(t,n){const[e,o]=t,[a,r]=n,s=(r-a)/(o-e),h=f=>a+(f-e)*s;return h.domain=()=>t,h.range=()=>n,h.ticks=f=>{const i=(o-e)/(f-1),l=[];for(let c=0;c<f;c++)l.push(e+i*c);return l},h}function St(t,n){const[e,o]=t.map(l=>Math.max(l,.001)),[a,r]=n,s=Math.log10(e),h=Math.log10(o),f=(r-a)/(h-s),i=l=>{const c=Math.log10(Math.max(l,.001));return a+(c-s)*f};return i.domain=()=>[e,o],i.range=()=>n,i.ticks=l=>{const c=[],u=Math.floor(Math.log10(e)),d=Math.ceil(Math.log10(o));for(let g=u;g<=d;g++){const T=Math.pow(10,g);for(const S of[1,2,5]){const A=T*S;A>=e&&A<=o&&c.push(A)}}return c.length>0?c:[e,o]},i}function qt(t,n,e,o){const a=e.scale==="log",r=P.AXIS_LABEL_PADDING,s=r,h=Math.max(n-r,s+50);if(o!=null&&o.xDomain){const u=o.xDomain,d=o.clipBounds??u,g=yt(d,t.theme.axis,e.scale,e.nullValue);return a?{scale:St([Math.max(u[0],.01),Math.max(u[1],.02)],[s,h]),clipBounds:d,ticks:g}:{scale:_t(u,[s,h]),clipBounds:d,ticks:g}}const f=Gt({rows:t.data.rows,config:t.theme.axis,scale:e.scale,nullValue:e.nullValue,forestWidth:n,pointSize:t.theme.shapes.pointSize,effects:e.effects,pointCol:e.pointCol,lowerCol:e.lowerCol,upperCol:e.upperCol}),{plotRegion:i,axisLimits:l,ticks:c}=f;return a?{scale:St([Math.max(i[0],.01),Math.max(i[1],.02)],[s,h]),clipBounds:l,ticks:c}:{scale:_t(i,[s,h]),clipBounds:l,ticks:c}}function Zt(t,n,e){var r,s;const o=[],a=e.spacing.padding;if((r=t.labels)!=null&&r.title){const h=J(e.typography.fontSizeLg);o.push(`<text x="${a}" y="${n.titleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${h}px"
      font-weight="${e.typography.fontWeightBold}"
      fill="${e.colors.foreground}">${V(t.labels.title)}</text>`)}if((s=t.labels)!=null&&s.subtitle){const h=J(e.typography.fontSizeBase);o.push(`<text x="${a}" y="${n.subtitleY}"
      font-family="${e.typography.fontFamily}"
      font-size="${h}px"
      fill="${e.colors.secondary}">${V(t.labels.subtitle)}</text>`)}return o.join(`
`)}function Kt(t,n,e){var s,h;const o=[],a=e.spacing.padding;let r=n.footerY;if((s=t.labels)!=null&&s.caption){const f=J(e.typography.fontSizeSm);o.push(`<text x="${a}" y="${r}"
      font-family="${e.typography.fontFamily}"
      font-size="${f}px"
      fill="${e.colors.secondary}">${V(t.labels.caption)}</text>`),r+=j.CAPTION_HEIGHT}if((h=t.labels)!=null&&h.footnote){const f=J(e.typography.fontSizeSm);o.push(`<text x="${a}" y="${r}"
      font-family="${e.typography.fontFamily}"
      font-size="${f}px"
      font-style="italic"
      fill="${e.colors.muted}">${V(t.labels.footnote)}</text>`)}return o.join(`
`)}function wt(t,n,e,o,a,r,s,h,f){const i=[],l=J(r.typography.fontSizeBase),c=r.typography.headerFontScale??1.05,u=l*c,d=r.typography.fontWeightMedium,g=r.typography.fontWeightBold,T=pt(t),S=h??O.DEFAULT_LABEL_WIDTH,A=N=>{if(f){const L=f.get(N.id);if(L!==void 0)return L}return typeof N.width=="number"?N.width:O.DEFAULT_COLUMN_WIDTH},b=N=>N.isGroup?N.columns.reduce((L,m)=>L+b(m),0):A(N),F=(N,L)=>N+L/2+u*j.TEXT_BASELINE_ADJUSTMENT;if(T){const N=a/2,L=a/2;let m=e;s&&(i.push(`<text x="${m+P.TEXT_PADDING}" y="${F(o,a)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${d}"
        fill="${r.colors.foreground}">${V(s)}</text>`),m+=S);const y=[];for(const p of t)if(p.isGroup){const $=b(p),x=m+$/2;i.push(`<text x="${x}" y="${F(o,N)}"
          font-family="${r.typography.fontFamily}"
          font-size="${u}px"
          font-weight="${g}"
          text-anchor="middle"
          fill="${r.colors.foreground}">${V(p.header)}</text>`),y.push({x1:m,x2:m+$}),m+=$}else{const $=A(p),x=p.headerAlign??p.align,{textX:E,anchor:_}=ct(m,$,x),H=gt(p.header,$,u,P.TEXT_PADDING);i.push(`<text x="${E}" y="${F(o,a)}"
          font-family="${r.typography.fontFamily}"
          font-size="${u}px"
          font-weight="${d}"
          text-anchor="${_}"
          fill="${r.colors.foreground}">${V(H)}</text>`),m+=$}for(const p of y)i.push(`<line x1="${p.x1}" x2="${p.x2}"
        y1="${o+N}" y2="${o+N}"
        stroke="${r.colors.border}" stroke-width="1" opacity="0.5"/>`);m=e+(s?S:0);for(const p of t)if(p.isGroup){for(const $ of p.columns)if(!$.isGroup){const x=A($),E=$.headerAlign??$.align,{textX:_,anchor:H}=ct(m,x,E);i.push(`<text x="${_}" y="${F(o+N,L)}"
              font-family="${r.typography.fontFamily}"
              font-size="${u}px"
              font-weight="${d}"
              text-anchor="${H}"
              fill="${r.colors.foreground}">${V($.header)}</text>`),m+=x}}else{const $=A(p);m+=$}}else{let N=e;s&&(i.push(`<text x="${N+P.TEXT_PADDING}" y="${F(o,a)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${d}"
        fill="${r.colors.foreground}">${V(s)}</text>`),N+=S);for(const L of n){const m=A(L),y=L.headerAlign??L.align,{textX:p,anchor:$}=ct(N,m,y),x=gt(L.header,m,u,P.TEXT_PADDING);i.push(`<text x="${p}" y="${F(o,a)}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        font-weight="${d}"
        text-anchor="${$}"
        fill="${r.colors.foreground}">${V(x)}</text>`),N+=m}}return i.join(`
`)}function Qt(t,n,e,o,a,r,s){const h=[],f=n+1,i=s.groupHeaders;let l,c,u,d,g;if(f===1?(l=J((i==null?void 0:i.level1FontSize)??s.typography.fontSizeBase),c=(i==null?void 0:i.level1FontWeight)??s.typography.fontWeightBold,u=(i==null?void 0:i.level1Italic)??!1,d=(i==null?void 0:i.level1Background)??null,g=(i==null?void 0:i.level1BorderBottom)??!1):f===2?(l=J((i==null?void 0:i.level2FontSize)??s.typography.fontSizeBase),c=(i==null?void 0:i.level2FontWeight)??s.typography.fontWeightMedium,u=(i==null?void 0:i.level2Italic)??!0,d=(i==null?void 0:i.level2Background)??null,g=(i==null?void 0:i.level2BorderBottom)??!1):(l=J((i==null?void 0:i.level3FontSize)??s.typography.fontSizeBase),c=(i==null?void 0:i.level3FontWeight)??s.typography.fontWeightNormal,u=(i==null?void 0:i.level3Italic)??!1,d=(i==null?void 0:i.level3Background)??null,g=(i==null?void 0:i.level3BorderBottom)??!1),!d){const b=s.colors.primary,F=f===1?.15:f===2?.1:.06,N=b.replace("#",""),L=parseInt(N.substring(0,2),16),m=parseInt(N.substring(2,4),16),y=parseInt(N.substring(4,6),16);d=`rgba(${L}, ${m}, ${y}, ${F})`}const T=o+a/2+l*j.TEXT_BASELINE_ADJUSTMENT,S=n*((i==null?void 0:i.indentPerLevel)??P.INDENT_PER_LEVEL);h.push(`<rect x="${e}" y="${o}"
    width="${r}" height="${a}"
    fill="${d}"/>`),g&&h.push(`<line x1="${e}" x2="${e+r}" y1="${o+a}" y2="${o+a}"
      stroke="${s.colors.border}" stroke-width="1" opacity="0.5"/>`);const A=u?' font-style="italic"':"";return h.push(`<text x="${e+P.TEXT_PADDING+S}" y="${T}"
    font-family="${s.typography.fontFamily}"
    font-size="${l}px"
    font-weight="${c}"${A}
    fill="${s.colors.foreground}">${V(t)}</text>`),h.join(`
`)}function Dt(t,n){const e=new Map;for(const o of n)if(o.type==="bar"){let a=0;for(const r of t){const s=r.metadata[o.field];typeof s=="number"&&s>a&&(a=s)}e.set(o.field,a>0?a:1)}return e}function Wt(t,n,e,o,a,r,s,h=O.DEFAULT_LABEL_WIDTH,f=0,i,l){var S,A,b,F,N,L,m,y,p,$,x,E,_,H,B,D;const c=[],u=J(r.typography.fontSizeBase),d=o+a/2+u*j.TEXT_BASELINE_ADJUSTMENT;let g=e;const T=I=>{if(l){const W=l.get(I.id);if(W!==void 0)return W}return typeof I.width=="number"?I.width:O.DEFAULT_COLUMN_WIDTH};if(s){const I=f*P.INDENT_PER_LEVEL+(((S=t.style)==null?void 0:S.indent)??0)*P.INDENT_PER_LEVEL,W=(A=t.style)!=null&&A.bold||(b=t.style)!=null&&b.emphasis?r.typography.fontWeightBold:r.typography.fontWeightNormal,w=(F=t.style)!=null&&F.italic?"italic":"normal";let M=r.colors.foreground;(N=t.style)!=null&&N.color?M=t.style.color:(L=t.style)!=null&&L.muted?M=r.colors.muted:(m=t.style)!=null&&m.accent&&(M=r.colors.accent);const G=h-I-P.TEXT_PADDING*2,R=gt(t.label,G,u,0);if(c.push(`<text x="${g+P.TEXT_PADDING+I}" y="${d}"
      font-family="${r.typography.fontFamily}"
      font-size="${u}px"
      font-weight="${W}"
      font-style="${w}"
      fill="${M}">${V(R)}</text>`),(y=t.style)!=null&&y.badge){const k=String(t.style.badge),C=u*Q.FONT_SCALE,v=C+Q.PADDING*2,X=Y(t.label,u),q=g+P.TEXT_PADDING+I+X+Q.GAP,z=Y(k,C)+Q.PADDING*2,et=o+(a-v)/2;c.push(`<rect x="${q}" y="${et}" width="${z}" height="${v}"
        rx="3" fill="${r.colors.primary}" opacity="0.15"/>`),c.push(`<text x="${q+z/2}" y="${et+v/2+C*.35}"
        text-anchor="middle"
        font-family="${r.typography.fontFamily}"
        font-size="${C}px"
        font-weight="500"
        fill="${r.colors.primary}">${V(k)}</text>`)}g+=h}for(const I of n){const W=T(I),w=tn(t,I),{textX:M,anchor:G}=ct(g,W,I.align);if(I.type==="bar"&&typeof t.metadata[I.field]=="number"){const R=t.metadata[I.field],k=i==null?void 0:i.get(I.field),C=(($=(p=I.options)==null?void 0:p.bar)==null?void 0:$.maxValue)??k??100,v=((E=(x=I.options)==null?void 0:x.bar)==null?void 0:E.color)??r.colors.primary,X=r.shapes.pointSize*2,U=W-P.TEXT_PADDING*2-50,z=Math.min(R/C*U,U);c.push(`<rect x="${g+P.TEXT_PADDING}" y="${o+a/2-X/2}"
        width="${Math.max(0,z)}" height="${X}"
        fill="${v}" opacity="0.7" rx="2"/>`);const et=g+W-P.TEXT_PADDING;c.push(`<text x="${et}" y="${d}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        text-anchor="end"
        fill="${r.colors.foreground}">${st(R)}</text>`)}else if(I.type==="sparkline"&&Array.isArray(t.metadata[I.field])){let R=t.metadata[I.field];Array.isArray(R[0])&&(R=R[0]);const k=((H=(_=I.options)==null?void 0:_.sparkline)==null?void 0:H.height)??16,C=((D=(B=I.options)==null?void 0:B.sparkline)==null?void 0:D.color)??r.colors.primary,v=P.TEXT_PADDING*2,X=nn(R,g+P.TEXT_PADDING,o+a/2-k/2,W-v,k);c.push(`<path d="${X}" fill="none" stroke="${C}" stroke-width="1.5"/>`)}else c.push(`<text x="${M}" y="${d}"
        font-family="${r.typography.fontFamily}"
        font-size="${u}px"
        text-anchor="${G}"
        fill="${r.colors.foreground}">${V(w)}</text>`);g+=W}return c.join(`
`)}function tn(t,n){var o,a,r,s,h,f,i,l,c,u,d,g,T,S,A,b,F,N,L;if(n.type==="interval"){const m=(a=(o=n.options)==null?void 0:o.interval)!=null&&a.point?t.metadata[n.options.interval.point]:t.point,y=(s=(r=n.options)==null?void 0:r.interval)!=null&&s.lower?t.metadata[n.options.interval.lower]:t.lower,p=(f=(h=n.options)==null?void 0:h.interval)!=null&&f.upper?t.metadata[n.options.interval.upper]:t.upper;return Tt(m,y,p,n.options)}if(n.type==="numeric"){const m=t.metadata[n.field];return typeof m=="number"?st(m,n.options):((i=n.options)==null?void 0:i.naText)??""}if(n.type==="custom"&&((l=n.options)!=null&&l.events))return bt(t,n.options);if(n.type==="pvalue"){const m=t.metadata[n.field];return typeof m!="number"?((c=n.options)==null?void 0:c.naText)??"":Et(m,n.options)}if(n.type==="icon"){const m=t.metadata[n.field];if(m==null)return"";const y=String(m),p=(d=(u=n.options)==null?void 0:u.icon)==null?void 0:d.mapping;return p&&y in p?p[y]:y}if(n.type==="badge"){const m=t.metadata[n.field];return m!=null?String(m):""}if(n.type==="stars"){const m=t.metadata[n.field];if(typeof m!="number")return"";const y=((T=(g=n.options)==null?void 0:g.stars)==null?void 0:T.maxStars)??5,p=Math.max(0,Math.min(y,m)),$=Math.floor(p),x=y-$;return"★".repeat($)+"☆".repeat(x)}if(n.type==="img")return((A=(S=n.options)==null?void 0:S.img)==null?void 0:A.fallback)??"[IMG]";if(n.type==="reference"){const m=t.metadata[n.field];if(m==null)return"";const y=String(m),p=((F=(b=n.options)==null?void 0:b.reference)==null?void 0:F.maxChars)??30;return y.length<=p?y:y.substring(0,p)+"..."}if(n.type==="range"){const m=(N=n.options)==null?void 0:N.range;if(!m)return"";const y=t.metadata[m.minField],p=t.metadata[m.maxField],$=m.separator??" – ",x=m.decimals,E=_=>typeof _!="number"?"":x==null?Number.isInteger(_)?String(_):_.toFixed(1):_.toFixed(x);return y===null&&p===null?"":y===null?E(p):p===null?E(y):`${E(y)}${$}${E(p)}`}const e=t.metadata[n.field];return e!=null?String(e):((L=n.options)==null?void 0:L.naText)??""}function nn(t,n,e,o,a){const r=t.filter(l=>Number.isFinite(l));if(r.length===0)return"";if(r.length===1){const l=n+o/2,c=e+a/2;return`M${l.toFixed(1)},${c.toFixed(1)}`}const s=Math.min(...r),f=Math.max(...r)-s||1;return`M${r.map((l,c)=>{const u=n+c/(r.length-1)*o,d=e+a-(l-s)/f*a;return`${u.toFixed(1)},${d.toFixed(1)}`}).join("L")}`}function en(t,n,e,o,a,r=[],s,h=0,f=1/0,i,l=!1){var y;let c;if(r.length===0){const p=!l||t.point!=null&&t.point>0?t.point:null,$=!l||t.lower!=null&&t.lower>0?t.lower:null,x=!l||t.upper!=null&&t.upper>0?t.upper:null;c=[{point:p,lower:$,upper:x,color:null,shape:null,opacity:null}]}else c=r.map(p=>({point:K(t.metadata,t.point,p.pointCol,"point",l),lower:K(t.metadata,t.lower,p.lowerCol,"lower",l),upper:K(t.metadata,t.upper,p.upperCol,"upper",l),color:p.color??null,shape:p.shape??null,opacity:p.opacity??null}));const u=c.filter(p=>p.point!=null&&!Number.isNaN(p.point)&&p.lower!=null&&!Number.isNaN(p.lower)&&p.upper!=null&&!Number.isNaN(p.upper));if(u.length===0)return"";const d=o.shapes.pointSize,g=o.shapes.lineWidth,T=o.colors.intervalLine,S=((y=t.style)==null?void 0:y.type)==="summary",b=o.shapes.summaryHeight/2;function F(p){var x;if(p&&((x=t.markerStyle)==null?void 0:x.size)!=null)return d*t.markerStyle.size;const $=s?t.metadata[s]:void 0;if($){const E=.5+Math.sqrt($/100)*1.5;return Math.min(Math.max(d*E,3),d*2.5)}return d}function N(p,$){const x=$===0,E=t.markerStyle,_=o.shapes.markerColors,H=o.shapes.markerShapes,B=["square","circle","diamond","triangle"];let D;x&&(E!=null&&E.color)?D=E.color:p.color?D=p.color:_&&_.length>0?D=_[$%_.length]:D=o.colors.interval??o.colors.primary??"#2563eb";let I;x&&(E!=null&&E.shape)?I=E.shape:p.shape?I=p.shape:H&&H.length>0?I=H[$%H.length]:I=B[$%B.length];let W;return x&&(E==null?void 0:E.opacity)!=null?W=E.opacity:p.opacity!=null?W=p.opacity:W=1,{color:D,shape:I,opacity:W}}function L(p,$,x,E){const{color:_,shape:H,opacity:B}=E,D=B<1?` fill-opacity="${B}"`:"";switch(H){case"circle":return`<circle cx="${p}" cy="${$}" r="${x}" fill="${_}"${D}/>`;case"diamond":return`<polygon points="${[`${p},${$-x}`,`${p+x},${$}`,`${p},${$+x}`,`${p-x},${$}`].join(" ")}" fill="${_}"${D}/>`;case"triangle":return`<polygon points="${[`${p},${$-x}`,`${p+x},${$+x}`,`${p-x},${$+x}`].join(" ")}" fill="${_}"${D}/>`;default:return`<rect x="${p-x}" y="${$-x}" width="${x*2}" height="${x*2}" fill="${_}"${D}/>`}}const m=[];return u.forEach((p,$)=>{const x=n+Ut($,u.length),E=e(p.lower),_=e(p.upper),H=e(p.point),B=N(p,$),D=F($===0),I=T;if(S){const W=B.opacity<1?` fill-opacity="${B.opacity}"`:"",w=[`${E},${x}`,`${H},${x-b}`,`${_},${x}`,`${H},${x+b}`].join(" ");m.push(`
        <g class="interval effect-${$} summary">
          <polygon points="${w}"
            fill="${B.color}"${W} stroke="${o.colors.summaryBorder}" stroke-width="1"/>
        </g>`)}else{const W=P.AXIS_LABEL_PADDING,w=h+W,M=h+f-W,G=i?p.lower<i[0]:E<w,R=i?p.upper>i[1]:_>M;let k,C;if(i){const et=Math.max(i[0],Math.min(i[1],p.lower)),fn=Math.max(i[0],Math.min(i[1],p.upper));k=e(et),C=e(fn)}else k=Math.max(w,Math.min(M,E)),C=Math.max(w,Math.min(M,_));const v=Bt(o),X=v.height/2;let q="";G?q=`<path d="${$t("left",w,x,v)}" fill="${v.color}"/>`:q=`<line x1="${k}" x2="${k}" y1="${x-X}" y2="${x+X}" stroke="${I}" stroke-width="${g}"/>`;let U="";R?U=`<path d="${$t("right",M,x,v)}" fill="${v.color}"/>`:U=`<line x1="${C}" x2="${C}" y1="${x-X}" y2="${x+X}" stroke="${I}" stroke-width="${g}"/>`;const z=i?e(Math.max(i[0],Math.min(i[1],p.point))):Math.max(w,Math.min(M,H));m.push(`
        <g class="interval effect-${$}">
          <line x1="${k}" x2="${C}" y1="${x}" y2="${x}"
            stroke="${I}" stroke-width="${g}"/>
          ${q}
          ${U}
          ${L(z,x,D,B)}
        </g>`)}}),m.join("")}function on(t,n,e,o,a,r,s,h){const i=h.shapes.summaryHeight/2,[l,c]=a.domain().map(L=>a(L)),u=Math.min(l,c),d=Math.max(l,c),g=a(n),T=a(t),S=a(e),A=r+Math.max(u,Math.min(d,g)),b=r+Math.max(u,Math.min(d,T)),F=r+Math.max(u,Math.min(d,S));return`<polygon points="${[`${A},${o}`,`${b},${o-i}`,`${F},${o}`,`${b},${o+i}`].join(" ")}"
    fill="${h.colors.summaryFill}"
    stroke="${h.colors.summaryBorder}"
    stroke-width="1"/>`}function rn(t,n,e,o,a,r=1,s){const h=[],f=typeof e.axis.tickCount=="number"?e.axis.tickCount:P.DEFAULT_TICK_COUNT,i=an(t,f,e,r,n.forestWidth,s),l=J(e.typography.fontSizeSm),c=35,u=g=>g<c?"start":g>n.forestWidth-c?"end":"middle",d=g=>g<c?2:g>n.forestWidth-c?-2:0;h.push(`<line x1="${a}" x2="${a+n.forestWidth}"
    y1="0" y2="0" stroke="${e.colors.border}" stroke-width="1"/>`);for(const g of i){const T=t(g),S=a+T,A=u(T),b=d(T);h.push(`<line x1="${S}" x2="${S}" y1="0" y2="4"
      stroke="${e.colors.border}" stroke-width="1"/>`),h.push(`<text x="${S+b}" y="16" text-anchor="${A}"
      font-family="${e.typography.fontFamily}"
      font-size="${l}px"
      fill="${e.colors.secondary}">${Jt(g)}</text>`)}return o&&h.push(`<text x="${a+n.forestWidth/2}" y="28"
      text-anchor="middle"
      font-family="${e.typography.fontFamily}"
      font-size="${l}px"
      font-weight="500"
      fill="${e.colors.secondary}">${V(o)}</text>`),`<g transform="translate(0, ${n.mainY+n.headerHeight+n.plotHeight})">${h.join(`
`)}</g>`}function an(t,n,e,o,a,r){if(Array.isArray(e.axis.tickValues)&&e.axis.tickValues.length>0){const[y,p]=t.domain();let $=e.axis.tickValues.filter(_=>_>=y&&_<=p);const x=e.axis.nullTick!==!1,E=o>=y&&o<=p;return x&&E&&!$.includes(o)&&($=[...$,o].sort((_,H)=>_-H)),$}const[s,h]=t.domain(),f=e.axis.nullTick!==!1,i=o>=s&&o<=h,l=50,c=Math.max(2,Math.floor(a/l)),u=Math.min(n,Math.min(7,c)),d=r&&r.length>0?r.filter(y=>y>=s&&y<=h):t.ticks(u);if(d.length===0)return f&&i?[o]:[];const g=t(o),T=d.filter(y=>y<o).reverse(),S=d.filter(y=>y>o),A=d.some(y=>y===o),b=[];let F=g;for(const y of T){const p=t(y);F-p>=l&&(b.unshift(y),F=p)}const N=[];let L=g;for(const y of S){const p=t(y);p-L>=l&&(N.push(y),L=p)}const m=[...b];if((A||f&&i)&&m.push(o),m.push(...N),m.length<2){const y=new Set(m);y.has(s)||m.unshift(s),m.length<2&&!y.has(h)&&m.push(h)}return m}function Lt(t,n,e,o,a,r,s=1,h=.6){let i=`<line x1="${t}" x2="${t}" y1="${n}" y2="${e}"
    stroke="${a}" stroke-width="${s}" stroke-opacity="${h}" stroke-dasharray="${o==="dashed"?"6,4":o==="dotted"?"2,2":"none"}"/>`;return r&&(i+=`<text x="${t}" y="${n-4}" text-anchor="middle"
      font-size="10px" fill="${a}">${V(r)}</text>`),i}class tt extends Error{constructor(n){super(`SVG Generator: ${n}`),this.name="SVGGeneratorError"}}function sn(t){if(!t||typeof t!="object")throw new tt("Invalid spec: expected an object");const n=t;if(!n.data||typeof n.data!="object")throw new tt("Invalid spec: missing or invalid 'data' property");const e=n.data;if(!Array.isArray(e.rows))throw new tt("Invalid spec: 'data.rows' must be an array");if(!n.theme||typeof n.theme!="object")throw new tt("Invalid spec: missing or invalid 'theme' property");const o=n.theme;if(!o.colors||typeof o.colors!="object")throw new tt("Invalid spec: missing or invalid 'theme.colors'");if(!o.typography||typeof o.typography!="object")throw new tt("Invalid spec: missing or invalid 'theme.typography'");if(!o.spacing||typeof o.spacing!="object")throw new tt("Invalid spec: missing or invalid 'theme.spacing'")}function ln(t){var r;const e=ot(t.columns,void 0).find(s=>s.type==="forest");if(!e||!((r=e.options)!=null&&r.forest))return{scale:"linear",nullValue:0,effects:[],axisLabel:"Effect",pointCol:null,lowerCol:null,upperCol:null};const o=e.options.forest,a=o.scale??"linear";return{scale:a,nullValue:o.nullValue??(a==="log"?1:0),effects:o.effects??[],axisLabel:o.axisLabel??"Effect",pointCol:o.point??null,lowerCol:o.lower??null,upperCol:o.upper??null}}function cn(t,n={}){var B;sn(t);const e=t.theme,o=ln(t),a=o.scale==="log",r=Yt(t,n,o.nullValue),s=e.spacing.padding,h=Array.isArray(t.columns)?t.columns:[],f=lt(h,"left"),i=lt(h,"right"),l=ot(h,"left"),c=ot(h,"right"),u=r.labelWidth+l.reduce((D,I)=>D+ht(I,r.autoWidths),0),d=s+u+O.COLUMN_GAP,{scale:g,clipBounds:T,ticks:S}=qt(t,r.forestWidth,o,n),A=d+r.forestWidth+O.COLUMN_GAP,b=[];b.push(`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
  width="${r.totalWidth}" height="${r.totalHeight}"
  viewBox="0 0 ${r.totalWidth} ${r.totalHeight}">`);const F=n.backgroundColor??e.colors.background;b.push(`<rect width="100%" height="100%" fill="${F}"/>`),b.push(Zt(t,r,e)),b.push(`<line x1="${s}" x2="${r.totalWidth-s}"
    y1="${r.mainY}" y2="${r.mainY}"
    stroke="${e.colors.border}" stroke-width="2"/>`);const N=r.mainY;b.push(wt(f,l,s,N,r.headerHeight,e,t.data.labelHeader??"Study",r.labelWidth,r.autoWidths)),c.length>0&&b.push(wt(i,c,A,N,r.headerHeight,e,void 0,void 0,r.autoWidths)),b.push(`<line x1="${s}" x2="${r.totalWidth-s}"
    y1="${N+r.headerHeight}" y2="${N+r.headerHeight}"
    stroke="${e.colors.border}" stroke-width="2"/>`);const L=At(t);(Array.isArray(t.data.groups)?t.data.groups:[]).length>0;const y=[],p=[];let $=0;for(const D of L){const W=D.type==="data"&&((B=D.row.style)==null?void 0:B.type)==="spacer"?r.rowHeight/2:r.rowHeight;y.push($),p.push(W),$+=W}if(t.data.includeForest&&r.forestWidth>0){const D=r.mainY+r.headerHeight,I=d+g(o.nullValue);b.push(Lt(I,D,D+r.plotHeight,"dashed",e.colors.muted));const W=Array.isArray(t.annotations)?t.annotations:[];for(const w of W)if(w.type==="reference_line"){const M=d+g(w.x);b.push(Lt(M,D,D+r.plotHeight,w.style,w.color??e.colors.accent,w.label,w.width??1,w.opacity??.6))}if(L.forEach((w,M)=>{if(w.type==="data"){const G=D+y[M]+p[M]/2;b.push(en(w.row,G,R=>d+g(R),e,o.nullValue,o.effects,t.data.weightCol,d,r.forestWidth,T,a))}}),t.data.overall&&r.showOverallSummary&&typeof t.data.overall.point=="number"&&!Number.isNaN(t.data.overall.point)&&typeof t.data.overall.lower=="number"&&!Number.isNaN(t.data.overall.lower)&&typeof t.data.overall.upper=="number"&&!Number.isNaN(t.data.overall.upper)){const w=D+r.summaryYPosition;b.push(on(t.data.overall.point,t.data.overall.lower,t.data.overall.upper,w,g,d,r.forestWidth,e))}b.push(rn(g,r,e,o.axisLabel,d,o.nullValue,S))}const x=r.mainY+r.headerHeight,E=t.data.rows,_=Dt(E,l),H=Dt(E,c);return L.forEach((D,I)=>{var M,G,R,k;const W=x+y[I],w=p[I];if(D.type==="group_header")b.push(Qt(D.label,D.depth,s,W,w,r.totalWidth-s*2,e));else{const C=D.row,v=D.depth,X=((M=C.style)==null?void 0:M.type)==="spacer",q=(G=C.style)==null?void 0:G.bg;if(!X&&!q&&e.layout.banding){const z=I%2===1?e.colors.altBg:e.colors.rowBg;z!==e.colors.background&&b.push(`<rect x="${s}" y="${W}"
            width="${r.totalWidth-s*2}" height="${w}"
            fill="${z}"/>`)}b.push(Wt(C,l,s,W,w,e,!0,r.labelWidth,v,_,r.autoWidths)),c.length>0&&b.push(Wt(C,c,A,W,w,e,!1,0,v,H,r.autoWidths))}if(D.type==="data"){const C=D.row,v=((R=C.style)==null?void 0:R.type)==="summary",X=((k=C.style)==null?void 0:k.type)==="spacer";v&&b.push(`<line x1="${s}" x2="${r.totalWidth-s}"
          y1="${W}" y2="${W}"
          stroke="${e.colors.border}" stroke-width="2"/>`),X||b.push(`<line x1="${s}" x2="${r.totalWidth-s}"
          y1="${W+w}" y2="${W+w}"
          stroke="${e.colors.border}" stroke-width="1"/>`)}else b.push(`<line x1="${s}" x2="${r.totalWidth-s}"
        y1="${W+w}" y2="${W+w}"
        stroke="${e.colors.border}" stroke-width="1"/>`)}),b.push(Kt(t,r,e)),b.push("</svg>"),b.join(`
`)}function un(t,n){const e=JSON.parse(t);return cn(e,n)}globalThis.generateSVG=un})();
